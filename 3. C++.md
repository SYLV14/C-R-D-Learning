# C++å…¥é—¨

## C++å…³é”®å­—

<img src="F:/cs/note/images/image-20240522195341552.png" alt="image-20240522195341552" style="zoom:50%;" />

## å‘½åç©ºé—´

åœ¨C/C++ä¸­ï¼Œå˜é‡ã€å‡½æ•°å’Œåé¢è¦å­¦åˆ°çš„ç±»éƒ½æ˜¯å¤§é‡å­˜åœ¨çš„ï¼Œè¿™äº›å˜é‡ã€å‡½æ•°å’Œç±»çš„åç§°å°†éƒ½å­˜åœ¨äºå…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šå†²çªã€‚ä½¿ç”¨å‘½åç©ºé—´çš„ç›®çš„æ˜¯**å¯¹æ ‡è¯†ç¬¦çš„åç§°è¿›è¡Œæœ¬åœ°åŒ–ï¼Œ ä»¥é¿å…å‘½åå†²çªæˆ–åå­—æ±¡æŸ“**ï¼Œnamespaceå…³é”®å­—çš„å‡ºç°å°±æ˜¯é’ˆå¯¹è¿™ç§é—®é¢˜çš„ã€‚

```c
#include <stdio.h>
#include <stdlib.h>
int rand = 10;
//stdlib.hä¸­å­˜åœ¨rand()å‡½æ•°
// Cè¯­è¨€æ²¡åŠæ³•è§£å†³ç±»ä¼¼è¿™æ ·çš„å‘½åå†²çªé—®é¢˜ï¼Œæ‰€ä»¥C++æå‡ºäº†namespaceæ¥è§£å†³
int main()
{
	printf("%d\n", rand);
	return 0;
}
// ç¼–è¯‘ååæŠ¥é”™ï¼šerror C2365: â€œrandâ€: é‡å®šä¹‰ï¼›ä»¥å‰çš„å®šä¹‰æ˜¯â€œå‡½æ•°â€
```

### å‘½åç©ºé—´å®šä¹‰

```c
//1.æ­£å¸¸çš„å‘½åç©ºé—´å®šä¹‰
namespace bit	//bitä¸ºå‘½åç©ºé—´çš„åå­—
{
	// å‘½åç©ºé—´ä¸­å¯ä»¥å®šä¹‰å˜é‡/å‡½æ•°/ç±»å‹
	int rand = 10;
	int Add(int left, int right)
	{
		return left + right;
	}
	struct Node
	{
		struct Node* next;
		int val;
	};
}

//2.å‘½åç©ºé—´å¯ä»¥åµŒå¥—
// test.cpp
namespace N1
{
	int a;
	int b;
	int Add(int left, int right)
	{
		return left + right;
	}
	namespace N2
	{
		int c;
		int d;
		int Sub(int left, int right)
		{
			return left - right;
		}
	}
}

//3.åŒä¸€ä¸ªå·¥ç¨‹ä¸­å…è®¸å­˜åœ¨å¤šä¸ªç›¸åŒåç§°çš„å‘½åç©ºé—´ï¼Œç¼–è¯‘å™¨æœ€åä¼šåˆæˆåŒä¸€ä¸ªå‘½åç©ºé—´ä¸­ã€‚
// psï¼šä¸€ä¸ªå·¥ç¨‹ä¸­çš„test.hå’Œä¸Šé¢test.cppä¸­ä¸¤ä¸ªN1ä¼šè¢«åˆå¹¶æˆä¸€ä¸ª
// test.h
namespace N1
{
	int Mul(int left, int right)
	{
		return left * right;
	}
}
```

> æ³¨æ„ï¼š**ä¸€ä¸ªå‘½åç©ºé—´å°±å®šä¹‰äº†ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸ**ï¼Œå‘½åç©ºé—´ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½å±€é™äºè¯¥å‘½åç©ºé—´ä¸­

### å‘½åç©ºé—´ä½¿ç”¨

è®¿é—®ä¸åŒä½œç”¨åŸŸä¸­çš„é‡åå˜é‡çš„ä¼˜å…ˆçº§ï¼šå±€éƒ¨å˜é‡ -> å…¨å±€å˜é‡ -> å‘½åç©ºé—´

```c
//å±€éƒ¨å˜é‡ -> å…¨å±€å˜é‡ -> å‘½åç©ºé—´
#include<iostream>
using std::endl;
using std::cout;
namespace zt {
	int a = 3;
}
int a = 2;
int main() {
	int a = 1;
	cout << a << endl;		//1 //è®¿é—®å±€éƒ¨å˜é‡a
	cout << ::a << endl;	//2 //è®¿é—®å…¨å±€å˜é‡a
	cout << zt::a << endl;	//3 //æŒ‡å®šè®¿é—®å‘½åç©ºé—´ä¸­çš„a
	//å‘½åç©ºé—´ä¸­çš„å˜é‡éœ€è¦å±•å¼€æˆ–è€…æŒ‡å®šè®¿é—®ï¼Œå¦åˆ™ä¹Ÿä¸ä¼šä½¿ç”¨
	return 0;
}
```

å‘½åç©ºé—´çš„ä½¿ç”¨æœ‰ä¸‰ç§æ–¹å¼ï¼š

1. **åŠ å‘½åç©ºé—´åç§°åŠä½œç”¨åŸŸé™å®šç¬¦**

   ```c
   int main()
   {
       printf("%d\n", N::a);
       return 0;    
   }
   ```

2. **ä½¿ç”¨usingå°†å‘½åç©ºé—´ä¸­æŸä¸ªæˆå‘˜å¼•å…¥**

   ```c
   using N::b;
   int main()
   {
       printf("%d\n", N::a);
       printf("%d\n", b);
       return 0;    
   }
   ```

3. **ä½¿ç”¨using namespace å‘½åç©ºé—´åç§°ï¼Œå¼•å…¥å‘½åç©ºé—´ä¸­çš„å…¨éƒ¨å˜é‡/å‡½æ•°/ç±»å‹**

   ```c
   using namespce N;
   int main()
   {
       printf("%d\n", N::a);
       printf("%d\n", b);
       Add(10, 20);
       return 0;    
   }
   ```

## C++è¾“å…¥&è¾“å‡º

1. ä½¿ç”¨**`cout`æ ‡å‡†è¾“å‡ºå¯¹è±¡(æ§åˆ¶å°)**å’Œ**`cin`æ ‡å‡†è¾“å…¥å¯¹è±¡(é”®ç›˜)**æ—¶ï¼Œå¿…é¡»åŒ…å«`<iostream>`å¤´æ–‡ä»¶ä»¥åŠæŒ‰å‘½åç©ºé—´ä½¿ç”¨æ–¹æ³•ä½¿ç”¨stdã€‚
2. `cout`å’Œ`cin`æ˜¯å…¨å±€çš„æµå¯¹è±¡ï¼Œ`endl`æ˜¯ç‰¹æ®Šçš„C++ç¬¦å·ï¼Œè¡¨ç¤ºæ¢è¡Œè¾“å‡ºï¼Œä»–ä»¬éƒ½åŒ…å«åœ¨åŒ…å«`<iostream>`å¤´æ–‡ä»¶ä¸­ã€‚
3. **<<æ˜¯æµæ’å…¥è¿ç®—ç¬¦ï¼Œ>>æ˜¯æµæå–è¿ç®—ç¬¦**ã€‚
4. ä½¿ç”¨C++è¾“å…¥è¾“å‡ºæ›´æ–¹ä¾¿ï¼Œä¸éœ€è¦åƒ`printf/scanf`è¾“å…¥è¾“å‡ºæ—¶é‚£æ ·ï¼Œéœ€è¦æ‰‹åŠ¨æ§åˆ¶æ ¼å¼ã€‚ **C++çš„è¾“å…¥è¾“å‡ºå¯ä»¥è‡ªåŠ¨è¯†åˆ«å˜é‡ç±»å‹**ã€‚
5. å®é™…ä¸Š`cout`å’Œ`cin`åˆ†åˆ«æ˜¯`ostream`å’Œ`istream`ç±»å‹çš„å¯¹è±¡ï¼Œ`>>`å’Œ`<<`ä¹Ÿæ¶‰åŠè¿ç®—ç¬¦é‡è½½ç­‰çŸ¥è¯†ï¼Œè¿™é‡Œåªæ˜¯ç®€å•å­¦ä¹ ä»–ä»¬çš„ä½¿ç”¨ã€‚

> æ³¨æ„ï¼šæ—©æœŸæ ‡å‡†åº“å°†æ‰€æœ‰åŠŸèƒ½åœ¨å…¨å±€åŸŸä¸­å®ç°ï¼Œå£°æ˜åœ¨.håç¼€çš„å¤´æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨æ—¶åªéœ€åŒ…å«å¯¹åº”å¤´æ–‡ä»¶å³å¯ï¼Œåæ¥å°†å…¶å®ç°åœ¨stdå‘½åç©ºé—´ä¸‹ï¼Œä¸ºäº†å’ŒCå¤´æ–‡ä»¶åŒºåˆ†ï¼Œä¹Ÿä¸ºäº†æ­£ç¡®ä½¿ç”¨å‘½åç©ºé—´ï¼Œ è§„å®šC++å¤´æ–‡ä»¶ä¸å¸¦.hï¼›æ—§ç¼–è¯‘å™¨(vc 6.0)ä¸­è¿˜æ”¯æŒæ ¼å¼ï¼Œåç»­ç¼–è¯‘å™¨å·²ä¸æ”¯æŒï¼Œå›  æ­¤æ¨èä½¿ç”¨+stdçš„æ–¹å¼ã€‚

```c
#include <iostream>
using namespace std;
int main()
{
    int a;
    double b;
    char c;
    cin >> a;
    cin >> b >> c;
    cout << a << endl;
    cout << b << " " << c << endl;
    return 0;
}
// psï¼šå…³äºcoutå’Œcinè¿˜æœ‰å¾ˆå¤šæ›´å¤æ‚çš„ç”¨æ³•ï¼Œæ¯”å¦‚æ§åˆ¶æµ®ç‚¹æ•°è¾“å‡ºç²¾åº¦ï¼Œæ§åˆ¶æ•´å½¢è¾“å‡ºè¿›åˆ¶æ ¼å¼ç­‰ã€‚å› ä¸ºC++å…¼å®¹Cè¯­è¨€çš„ç”¨æ³•ï¼Œè¿™äº›åˆç”¨å¾—ä¸æ˜¯å¾ˆå¤šï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨scanfå’Œprintfæ§åˆ¶æ ¼å¼ã€‚
```

> stdå‘½åç©ºé—´çš„ä½¿ç”¨æƒ¯ä¾‹ï¼š stdæ˜¯C++æ ‡å‡†åº“çš„å‘½åç©ºé—´ï¼Œå¦‚ä½•å±•å¼€stdä½¿ç”¨æ›´åˆç†å‘¢ï¼Ÿ 
>
> 1. åœ¨æ—¥å¸¸ç»ƒä¹ ä¸­ï¼Œå»ºè®®ç›´æ¥using namespace stdå³å¯ï¼Œè¿™æ ·å°±å¾ˆæ–¹ä¾¿ã€‚ 
> 2. `using namespace std;` å±•å¼€ï¼Œæ ‡å‡†åº“å°±å…¨éƒ¨æš´éœ²å‡ºæ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰è·Ÿåº“é‡åçš„ç±»å‹/å¯¹è±¡/å‡½æ•°ï¼Œå°±å­˜åœ¨å†²çªé—®é¢˜ã€‚è¯¥é—®é¢˜åœ¨æ—¥å¸¸ç»ƒä¹ ä¸­å¾ˆå°‘å‡ºç°ï¼Œä½†æ˜¯é¡¹ç›®å¼€å‘ä¸­ä»£ç è¾ƒå¤šã€è§„æ¨¡å¤§ï¼Œå°±å¾ˆå®¹æ˜“å‡ºç°ã€‚æ‰€ä»¥å»ºè®®åœ¨é¡¹ç›®å¼€å‘ä¸­ä½¿ç”¨ï¼Œåƒ`std::cout`è¿™æ ·ä½¿ç”¨æ—¶æŒ‡å®šå‘½åç©ºé—´ +  `using std::cout;`å±•å¼€å¸¸ç”¨çš„åº“å¯¹è±¡/ç±»å‹ç­‰æ–¹å¼ã€‚

## ç¼ºçœå‡½æ•°

### ç¼ºçœå‡½æ•°æ¦‚å¿µ

ç¼ºçœå‚æ•°æ˜¯**å£°æ˜æˆ–å®šä¹‰å‡½æ•°æ—¶ä¸ºå‡½æ•°çš„å‚æ•°æŒ‡å®šä¸€ä¸ªç¼ºçœå€¼**ã€‚åœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šå® å‚åˆ™é‡‡ç”¨è¯¥å½¢å‚çš„ç¼ºçœå€¼ï¼Œå¦åˆ™ä½¿ç”¨æŒ‡å®šçš„å®å‚ã€‚

```c
#include<iostream>
using namespace std;
void Func(int a = 0)
{
	cout << a << endl;
}
int main()
{
	Func();     //0 //æ²¡æœ‰ä¼ å‚æ—¶ï¼Œä½¿ç”¨å‚æ•°çš„é»˜è®¤å€¼
	Func(10);   //10 //ä¼ å‚æ—¶ï¼Œä½¿ç”¨æŒ‡å®šçš„å®å‚
	return 0;
}
```

### ç¼ºçœå‡½æ•°åˆ†ç±»

1. **å…¨ç¼ºçœå‡½æ•°**

   ```c
   #include<iostream>
   using namespace std;
   void Func(int a = 10, int b = 20, int c = 30)
   {
   	cout << a << " ";
   	cout << b << " ";
   	cout << c << endl;
   }
   int main()
   {
   	Func();			//10 20 30
   	Func(1);		//1 20 30
   	Func(1, 2);		//1 2 30
   	Func(1, 2, 3);	//1 2 3
   	return 0;
   }
   ```

2. **åŠç¼ºçœå‡½æ•°**

   ```c
   #include<iostream>
   using namespace std;
   void Func(int a, int b = 20, int c = 30)
   {
   	cout << a << " ";
   	cout << b << " ";
   	cout << c << endl;
   }
   int main()
   {
   	//Func();		//error
   	Func(1);		//1 20 30
   	Func(1, 2);		//1 2 30
   	Func(1, 2, 3);	//1 2 3
   	return 0;
   }
   ```

> æ³¨æ„ï¼š
>
> 1. åŠç¼ºçœå‚æ•°å¿…é¡»ä»å³å¾€å·¦ä¾æ¬¡æ¥ç»™å‡ºï¼Œä¸èƒ½é—´éš”ç€ç»™
>
>    ```c
>    void Func1(int a, int b, int c = 30);		// ok
>    void Func2(int a, int b = 20, int c = 30);	// ok
>    void Func3(int a = 10, int b, int c = 30);	// error
>    void Func4(int a = 10, int b, int c);		// error
>    void Func5(int a = 10, int b = 20, int c);	// error
>    void Func6(int a, int b = 20, int c);		// error
>    ```
>
> 2. ï¼Œç¼ºçœå‚æ•°ä¸èƒ½åœ¨å‡½æ•°å£°æ˜å’Œå®šä¹‰ä¸­åŒæ—¶å‡ºç°ï¼Œå»ºè®®å£°æ˜æ—¶å†™ç¼ºçœå‚æ•°ï¼Œå®šä¹‰æ—¶ä¸å†™
>
>    ```c
>    //a.h
>    void Func(int a = 10);
>    // a.cpp
>    void Func(int a = 20)
>     {}
>    // æ³¨æ„ï¼šå¦‚æœç”Ÿå‘½ä¸å®šä¹‰ä½ç½®åŒæ—¶å‡ºç°ï¼Œæ°å·§ä¸¤ä¸ªä½ç½®æä¾›çš„å€¼ä¸åŒï¼Œé‚£ç¼–è¯‘å™¨å°±æ— æ³•ç¡®å®šåˆ°åº•è¯¥ç”¨é‚£ä¸ªç¼ºçœå€¼ã€‚
>    ```
>
> 3. ç¼ºçœå€¼å¿…é¡»æ˜¯å¸¸é‡æˆ–è€…å…¨å±€å˜é‡
>
> 4. Cè¯­è¨€ä¸æ”¯æŒï¼ˆç¼–è¯‘å™¨ä¸æ”¯æŒï¼‰

## å‡½æ•°é‡è½½

### å‡½æ•°é‡è½½çš„æ¦‚å¿µ

å‡½æ•°é‡è½½ï¼šæ˜¯å‡½æ•°çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼ŒC++å…è®¸åœ¨**åŒä¸€ä½œç”¨åŸŸ**ä¸­å£°æ˜å‡ ä¸ªåŠŸèƒ½ç±»ä¼¼çš„**åŒåå‡½æ•°**ï¼Œè¿™äº›åŒåå‡½æ•°çš„**å½¢å‚åˆ—è¡¨(å‚æ•°ä¸ªæ•° æˆ– ç±»å‹ æˆ– ç±»å‹é¡ºåº)ä¸åŒ**ï¼Œå¸¸ç”¨æ¥å¤„ç†å®ç°åŠŸèƒ½ç±»ä¼¼æ•°æ®ç±»å‹ä¸åŒçš„é—®é¢˜ã€‚

```c
#include<iostream>
using namespace std;
// 1. å‚æ•°ç±»å‹ä¸åŒ
int Add(int left, int right)
{
	cout << "int Add(int left, int right)" << endl;
	return left + right;
}
double Add(double left, double right)
{
	cout << "double Add(double left, double right)" << endl;
	return left + right;
}
// 2. å‚æ•°ä¸ªæ•°ä¸åŒ
void f()
{
	cout << "f()" << endl;
}
void f(int a)
{
	cout << "f(int a)" << endl;
}
// 3. å‚æ•°ç±»å‹é¡ºåºä¸åŒ
void f(int a, char b)
{
	cout << "f(int a,char b)" << endl;
}
void f(char a, int b)
{
	cout << "f(char a, int b)" << endl;
}
int main()
{
	Add(10, 20);
	Add(10.1, 20.2);
	f();
	f(10);
	f(10, 'a');
	f('a', 10);
	return 0;
}
```

### C++æ”¯æŒå‡½æ•°é‡è½½çš„åŸç†--åå­—ä¿®é¥°(name Mangling)

ä¸ºä»€ä¹ˆC++æ”¯æŒå‡½æ•°é‡è½½ï¼Œè€ŒCè¯­è¨€ä¸æ”¯æŒå‡½æ•°é‡è½½å‘¢ï¼Ÿ

<img src="F:/cs/note/images/image-20240522221037439.png" alt="image-20240522221037439" style="zoom: 50%;" />

ç¼–è¯‘åé“¾æ¥å‰ï¼Œé“¾æ¥å™¨çœ‹åˆ°Test.oè°ƒç”¨Sumï¼Œä½†æ˜¯æ²¡æœ‰Sumçš„åœ°å€ï¼Œå°± ä¼šåˆ°Sum.oçš„ç¬¦å·è¡¨ä¸­æ‰¾Sumçš„åœ°å€ï¼Œç„¶åé“¾æ¥åˆ°ä¸€èµ·ã€‚

é‡‡ç”¨Cè¯­è¨€ç¼–è¯‘å™¨ç¼–è¯‘åï¼Œåœ¨linuxä¸‹ï¼Œé‡‡ç”¨gccç¼–è¯‘å®Œæˆåï¼Œå‡½æ•°åå­—çš„ä¿®é¥°æ²¡æœ‰å‘ç”Ÿæ”¹å˜ã€‚

é‡‡ç”¨C++ç¼–è¯‘å™¨ç¼–è¯‘åç»“æœåœ¨linuxä¸‹ï¼Œé‡‡ç”¨g++ç¼–è¯‘å®Œæˆåï¼Œå‡½æ•°åå­—çš„ä¿®é¥°å‘ç”Ÿæ”¹å˜ï¼Œç¼–è¯‘å™¨å°†å‡½æ•°å‚ æ•°ç±»å‹ä¿¡æ¯æ·»åŠ åˆ°ä¿®æ”¹åçš„åå­—ä¸­ã€‚

é€šè¿‡è¿™é‡Œå°±ç†è§£äº†Cè¯­è¨€æ²¡åŠæ³•æ”¯æŒé‡è½½ï¼Œå› ä¸ºåŒåå‡½æ•°æ²¡åŠæ³•åŒºåˆ†ã€‚è€ŒC++æ˜¯é€šè¿‡å‡½æ•°ä¿® é¥°è§„åˆ™æ¥åŒºåˆ†ï¼Œåªè¦å‚æ•°ä¸åŒï¼Œä¿®é¥°å‡ºæ¥çš„åå­—å°±ä¸ä¸€æ ·ï¼Œå°±æ”¯æŒäº†é‡è½½ã€‚

> **å¦‚æœä¸¤ä¸ªå‡½æ•°å‡½æ•°åå’Œå‚æ•°æ˜¯ä¸€æ ·çš„ï¼Œè¿”å›å€¼ä¸åŒæ˜¯ä¸æ„æˆé‡è½½çš„ï¼Œå› ä¸ºè°ƒç”¨æ—¶ç¼–è¯‘å™¨æ²¡åŠæ³•åŒºåˆ†ã€‚**

## å¼•ç”¨

### å¼•ç”¨çš„æ¦‚å¿µ

å¼•ç”¨ä¸æ˜¯æ–°å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œè€Œæ˜¯**ç»™å·²å­˜åœ¨å˜é‡å–äº†ä¸€ä¸ªåˆ«å**ï¼Œç¼–è¯‘å™¨ä¸ä¼šä¸ºå¼•ç”¨å˜é‡å¼€è¾Ÿå†…å­˜ç©ºé—´ï¼Œå®ƒå’Œå®ƒå¼•ç”¨çš„å˜é‡**å…±ç”¨åŒä¸€å—å†…å­˜ç©ºé—´**ã€‚

**ç±»å‹& å¼•ç”¨å˜é‡å(å¯¹è±¡å) = å¼•ç”¨å®ä½“ï¼›**

```c
void TestRef()
{
    int a = 10;
    int& ra = a;		//å®šä¹‰å¼•ç”¨ç±»å‹
    printf("%p\n", &a);
    printf("%p\n", &ra);
}
```

> **æ³¨æ„ï¼šå¼•ç”¨ç±»å‹å¿…é¡»å’Œå¼•ç”¨å®ä½“æ˜¯åŒç§ç±»å‹çš„**

### å¼•ç”¨ç‰¹æ€§

1. å¼•ç”¨**åœ¨å®šä¹‰æ—¶å¿…é¡»åˆå§‹åŒ–**
2. ä¸€ä¸ªå˜é‡å¯ä»¥æœ‰å¤šä¸ªå¼•ç”¨
3. å¼•ç”¨ä¸€æ—¦å¼•ç”¨ä¸€ä¸ªå®ä½“ï¼Œ**å†ä¸èƒ½å¼•ç”¨å…¶ä»–å®ä½“**

```c
void TestRef()
{
	int a = 10;
	//1. å¼•ç”¨åœ¨å®šä¹‰æ—¶å¿…é¡»åˆå§‹åŒ–
	//int& ra;   // ç¼–è¯‘error
	int& ra = a;

	//2. ä¸€ä¸ªå˜é‡å¯ä»¥æœ‰å¤šä¸ªå¼•ç”¨
	int& rra = a;
	int& rrra = rra;
	std::cout << &a << std::endl << &ra << std::endl << &rra << std::endl << &rrra << std::endl;

	//3. å¼•ç”¨ä¸€æ—¦å¼•ç”¨ä¸€ä¸ªå®ä½“ï¼Œå†ä¸èƒ½å¼•ç”¨å…¶ä»–å®ä½“
	int b = 20;
	ra = b;	//è¿™ä¸ªè¯­å¥å¹¶ä¸æ˜¯å¼•ç”¨bï¼Œè€Œæ˜¯å°†bçš„å€¼æ‹·è´ç»™a
	std::cout << a << std::endl << ra << std::endl;

	int* p = &b;
	int*& rp = p;
	std::cout << p << std::endl << rp << std::endl;
}
```

### ä½¿ç”¨åœºæ™¯

1. **å¼•ç”¨å˜é‡åšå‚æ•°**
   å¼•ç”¨å¯ä»¥åšå‡½æ•°çš„å‚æ•°ï¼Œä½œç”¨ç›¸å½“äºæŒ‡é’ˆï¼Œå¯ä»¥æ”¹å˜å˜é‡æœ¬èº«ã€‚

   ```c
   void Swap(int& left, int& right)
   {
      int temp = left;
      left = right;
      right = temp;
   }
   ```

2. **å¼•ç”¨å˜é‡åšè¿”å›å€¼**

   ```c
   //å€¼è¿”å›
   int Count() {
   	static int n = 0;;
   	n++;
   	return n;
   }
   //ä¸´æ—¶å˜é‡nå­˜æ”¾åœ¨å†…å­˜ä¸­çš„é™æ€åŒºï¼Œä¸ä¼šéšå‡½æ•°æ‰§è¡Œç»“æŸè€Œé”€æ¯
   int Count() {
   	int n = 0;;
   	n++;
   	return n;
   }
   //ä¸´æ—¶å˜é‡nå­˜æ”¾åœ¨å†…å­˜ä¸­çš„æ ˆåŒºï¼Œä¼šéšå‡½æ•°æ‰§è¡Œç»“æŸè€Œé”€æ¯
   int main() {
   	int ret = Count();
   	return 0;
   }
   //ä½†æ˜¯ä¸è®ºæ ˆåŒºè¿˜æ˜¯é™æ€åŒºçš„å˜é‡è¿”å›éƒ½éœ€è¦å°†è¿”å›å€¼å­˜æ”¾åœ¨ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼ˆå¯„å­˜å™¨ï¼‰ä¸­ï¼Œç„¶åæ‹·è´ç»™mainå‡½æ•°ä¸­çš„å˜é‡
   ```

   æœ‰æ²¡æœ‰åŠæ³•ä¸é€šè¿‡ä¸´æ—¶å˜é‡è¿”å›è¿”å›å€¼å‘¢ï¼Ÿé‚£å°±æ˜¯å¼•ç”¨è¿”å›

   ```c
   //æ­£ç¡®çš„å¼•ç”¨è¿”å›
   int& Count() {
   	static int n = 0;;
   	n++;
   	return n;
   }
   //å¯¹äºå¼•ç”¨è¿”å›æ¥è¯´å°±ä¸ä¼šäº§ç”Ÿè¿™ä¸ªä¸´æ—¶å˜é‡äº†ï¼Œè¿”å›çš„åªæ˜¯nçš„åˆ«åï¼Œç›¸å½“äºå°±æ˜¯æŠŠnè¿”å›å›å»äº†ï¼Œ
   //å¯¹äºå‡½æ•°æ ˆå¸§é”€æ¯ä¾æ—§å­˜åœ¨çš„å†…å®¹ï¼Œå¦‚æœä¸æƒ³è®©å…¶æ‹·è´åˆ°ä¸´æ—¶å˜é‡ä¸­è¿›è¡Œè¿”å›ï¼Œæ˜¯å¯ä»¥é€šè¿‡å¼•ç”¨æ¥è¿›è¡Œè¿”å›çš„ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘æ‹·è´ï¼Œå¯¹ç¨‹åºåšäº†ä¸€å°éƒ¨åˆ†çš„ä¼˜åŒ–
   int main() {
   	int& ret = Count();
   	return 0;
   }
   ```

   ```c
   //é”™è¯¯çš„å¼•ç”¨è¿”å›
   int& Count() {
   	int n = 0;;
   	n++;
   	return n;
   }
   int main() {
   	int& ret = Count();
   	return 0;
   }
   //è¿™é‡Œæ‰“å°retçš„å€¼æ˜¯ä¸ç¡®å®šçš„ï¼Œretå°±æ˜¯nçš„åˆ«åï¼Œä½†æ˜¯Countå‡½æ•°å·²ç»é”€æ¯
   //å¦‚æœCountå‡½æ•°ç»“æŸï¼Œæ ˆå¸§é”€æ¯æ²¡æœ‰æ¸…ç†æ ˆå¸§ï¼Œé‚£ä¹ˆretçš„ç»“æœä¾¥å¹¸æ˜¯æ­£ç¡®çš„
   //å¦‚æœCountå‡½æ•°ç»“æŸï¼Œæ ˆå¸§é”€æ¯æ¸…ç†æ ˆå¸§ï¼Œé‚£ä¹ˆretçš„ç»“æœæ˜¯éšæœºå€¼
   //ä¾‹å¦‚ï¼š
   #include<iostream>
   int& Add(int a, int b)
   {
       int c = a + b;
       return c;
   }
   int main()
   {
       int& ret = Add(1, 2);
       Add(3, 4);
       std::cout << "Add(1, 2) is :" << ret << std::endl;
       //Add(1, 2) is :-858993460
       return 0;
   }
   ```

   > æ³¨æ„ï¼šå¦‚æœå‡½æ•°è¿”å›æ—¶ï¼Œå‡ºäº†å‡½æ•°ä½œç”¨åŸŸï¼Œå¦‚æœè¿”å›å¯¹è±¡è¿˜åœ¨(è¿˜æ²¡è¿˜ç»™ç³»ç»Ÿ)ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¼•ç”¨è¿”å›ï¼Œå¦‚æœå·²ç»è¿˜ç»™ç³»ç»Ÿäº†ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ä¼ å€¼è¿”å›

> æ€»ç»“ï¼š
>
> 1. å¼•ç”¨åšå‚æ•° ï¼Œåšè¾“å‡ºå‹å‚æ•°ï¼ŒèŠ‚çœç©ºé—´
>
> 2. å¼•ç”¨åšå‚æ•°  ï¼Œå½“ä¼ è¿‡æ¥çš„å½¢å‚æ˜¯å¤§å¯¹è±¡/æ·±æ‹·è´å¯¹è±¡æ—¶ï¼Œèƒ½å¤Ÿæå¤§åœ°æé«˜æ•ˆç‡ã€‚
>
> 3. å¼•ç”¨åšè¿”å›å€¼ ï¼Œè¿”å›å€¼ä¸éœ€è¦é€šè¿‡ä¸´æ—¶å˜é‡è¿”å›ï¼Œå‡å°‘æ‹·è´æé«˜æ•ˆç‡ï¼Œå°¤å…¶æ˜¯è¿”å›å¤§å¯¹è±¡/æ·±æ‹·è´ç±»å¯¹è±¡
>
> 4. å¼•ç”¨åšè¿”å›å€¼ï¼Œå¯ä»¥é€šè¿‡å¼•ç”¨è¿”å›ä¿®æ”¹è¿”å›å€¼+è·å–è¿”å›å€¼
>
>    ```c
>    #include<iostream>
>    #include<assert.h>
>    struct SeqList { int a[100]; };
>    int SLGet(SeqList* ps, int pos) {
>    	assert(pos < 100 && pos >= 0);
>    	return ps->a[pos];
>    }
>    void SLModify(SeqList* ps, int pos, int x) {
>    	assert(pos < 100 && pos >= 0);
>    	ps->a[pos] = x;
>    }
>    int& SLAt(SeqList* ps, int pos) {
>    	assert(pos < 100 && pos >= 0);
>    	return ps->a[pos];
>    }
>    int main() {
>    	SeqList s;
>                                                                         
>    	SLModify(&s, 0, 1);
>    	int ret = SLGet(&s, 0);
>    	std::cout << ret << std::endl;
>    	SLModify(&s, 0, ret + 5);
>                                                                         
>    	//é€šè¿‡å¼•ç”¨è¿”å›å°±èƒ½å®ç°è¯»å†™
>    	SLAt(&s, 0) = 1;
>    	std::cout << SLAt(&s, 0) << std::endl;
>    	SLAt(&s, 0) += 5;
>                                                                         
>    	return 0;
>    }
>    ```

###  ä¼ å€¼ã€ä¼ å¼•ç”¨æ•ˆç‡æ¯”è¾ƒ

ä»¥å€¼ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼ç±»å‹ï¼Œåœ¨ä¼ å‚å’Œè¿”å›æœŸé—´ï¼Œå‡½æ•°ä¸ä¼šç›´æ¥ä¼ é€’å®å‚æˆ–è€…å°†å˜é‡æœ¬èº«ç›´ æ¥è¿”å›ï¼Œè€Œæ˜¯ä¼ é€’å®å‚æˆ–è€…è¿”å›å˜é‡çš„ä¸€ä»½ä¸´æ—¶çš„æ‹·è´ï¼Œå› æ­¤ç”¨å€¼ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼ç±»å‹ï¼Œæ•ˆç‡æ˜¯éå¸¸ä½ä¸‹çš„ï¼Œå°¤å…¶æ˜¯å½“å‚æ•°æˆ–è€…è¿”å›å€¼ç±»å‹éå¸¸å¤§æ—¶ï¼Œæ•ˆç‡å°±æ›´ä½ã€‚

1. **å€¼å’Œå¼•ç”¨çš„ä½œä¸ºå‡½æ•°å‚æ•°ç±»å‹çš„æ€§èƒ½æ¯”è¾ƒ**

   ```c
   #include<iostream>
   #include <time.h>
   struct A { int a[10000]; };
   void TestFunc1(A a) {}
   void TestFunc2(A& a) {}
   void TestRefAndValue()
   {
   	A a;
   	// ä»¥å€¼ä½œä¸ºå‡½æ•°å‚æ•°
   	size_t begin1 = clock();
   	for (size_t i = 0; i < 10000; ++i)
   		TestFunc1(a);
   	size_t end1 = clock();
   	// ä»¥å¼•ç”¨ä½œä¸ºå‡½æ•°å‚æ•°
   	size_t begin2 = clock();
   	for (size_t i = 0; i < 10000; ++i)
   		TestFunc2(a);
   	size_t end2 = clock();
   	// åˆ†åˆ«è®¡ç®—ä¸¤ä¸ªå‡½æ•°è¿è¡Œç»“æŸåçš„æ—¶é—´
   	std::cout << "TestFunc1(A)-time:" << end1 - begin1 << std::endl;
   	std::cout << "TestFunc2(A&)-time:" << end2 - begin2 << std::endl;
   }
   int main() {
   	TestRefAndValue();
   	return 0;
   }
   //TestFunc1(A)-time:8
   //TestFunc2(A&)-time:0
   ```

2. **å€¼å’Œå¼•ç”¨çš„ä½œä¸ºè¿”å›å€¼ç±»å‹çš„æ€§èƒ½æ¯”è¾ƒ**

   ```c
   #include<iostream>
   #include <time.h>
   struct A { int a[10000]; };
   A a;
   // å€¼è¿”å›
   A TestFunc1() { return a; }
   // å¼•ç”¨è¿”å›
   A& TestFunc2() { return a; }
   void TestReturnByRefOrValue()
   {
   	// ä»¥å€¼ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ç±»å‹
   	size_t begin1 = clock();
   	for (size_t i = 0; i < 100000; ++i)
   		TestFunc1();
   	size_t end1 = clock();
   	// ä»¥å¼•ç”¨ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ç±»å‹
   	size_t begin2 = clock();
   	for (size_t i = 0; i < 100000; ++i)
   		TestFunc2();
   	size_t end2 = clock();
   	// è®¡ç®—ä¸¤ä¸ªå‡½æ•°è¿ç®—å®Œæˆä¹‹åçš„æ—¶é—´
   	std::cout << "TestFunc1 time:" << end1 - begin1 << std::endl;
   	std::cout << "TestFunc2 time:" << end2 - begin2 << std::endl;
   }
   int main() {
   	TestReturnByRefOrValue();
   	return 0;
   }
   //TestFunc1 time : 152
   //TestFunc2 time : 0
   ```

### å¸¸å¼•ç”¨

```c
void TestConstRef()
{
    //1. æƒé™ä¸èƒ½æ”¾å¤§ï¼Œåªèƒ½ç¼©å°æˆ–å¹³ç§»
    const int a = 10;
    int& ra = a;        // ç¼–è¯‘æ—¶errorï¼Œaä¸ºå¸¸é‡ï¼Œä¸èƒ½æ”¾å¤§æƒé™å˜ä¸ºå˜é‡
    const int& ra = a;  // æƒé™å¯ä»¥å¹³ç§»
    int b = 20;
    const int& rb = b;  // æƒé™å¯ä»¥ç¼©å°

    //2. å¯ä»¥ç»™å¸¸é‡å–åˆ«å
    int& c = 10;        // ç¼–è¯‘errorï¼Œcä¸ºå¸¸é‡
    const int& c = 10;  // å¸¸é‡å¼•ç”¨éœ€ç”¨const

    //3. åªè¦å‘ç”Ÿç±»å‹è½¬æ¢ï¼Œéƒ½ä¼šäº§ç”Ÿä¸´æ—¶å˜é‡ã€‚è€Œä¸´æ—¶å˜é‡ä¸å¯ä¿®æ”¹ï¼Œå…·æœ‰å¸¸æ€§ã€‚
    double d = 12.34;
    int& rd = d;        // ç¼–è¯‘errorï¼Œç±»å‹ä¸åŒ
    const int& rd = d;  // æŠŠdçš„å€¼èµ‹ç»™rdæ—¶å¹¶ä¸æ˜¯ç›´æ¥èµ‹å€¼çš„ï¼Œä¼šæŠŠdçš„æ•´æ•°éƒ¨åˆ†å–å‡ºæ¥ï¼Œèµ‹å€¼ç»™ä¸€ä¸ªintå‹ä¸´æ—¶å˜é‡ï¼Œéšåå†æŠŠè¿™ä¸ªä¸´æ—¶å˜é‡ç»™ç»™rd
}
```

```c
int func1()
{
	static int x = 0;
	return x;
}
int& func2()
{
	static int x = 0;
	return x;
}
int main()
{
	int& ret1 = func1();		// æƒé™æ”¾å¤§ï¼Œä¼ å€¼è¿”å›è¿”å›çš„æ˜¯ä¸´æ—¶å˜é‡ï¼Œä¸´æ—¶å˜é‡å…·æœ‰å¸¸æ€§
	const int& ret1 = func1();	// æƒé™å¹³ç§»
	int ret1 = func1();			// æ‹·è´

	int& ret2 = func2();		// æƒé™å¹³ç§»
	const int& rret2 = func2(); // æƒé™ç¼©å°

	return 0;
}
```

### å¼•ç”¨å’ŒæŒ‡é’ˆçš„åŒºåˆ«

åœ¨**è¯­æ³•æ¦‚å¿µ**ä¸Šå¼•ç”¨å°±æ˜¯ä¸€ä¸ªåˆ«åï¼Œæ²¡æœ‰ç‹¬ç«‹ç©ºé—´ï¼Œå’Œå…¶å¼•ç”¨å®ä½“å…±ç”¨åŒä¸€å—ç©ºé—´ã€‚

åœ¨**åº•å±‚å®ç°**ä¸Šå®é™…æ˜¯æœ‰ç©ºé—´çš„ï¼Œå› ä¸º**å¼•ç”¨æ˜¯æŒ‰ç…§æŒ‡é’ˆæ–¹å¼æ¥å®ç°çš„**ã€‚

<img src="F:/cs/note/images/image-20240523151214052.png" alt="image-20240523151214052" style="zoom: 50%;" />

> å¼•ç”¨å’ŒæŒ‡é’ˆçš„ä¸åŒç‚¹ï¼š
>
> 1. å¼•ç”¨æ¦‚å¿µä¸Šå®šä¹‰ä¸€ä¸ªå˜é‡çš„åˆ«åï¼ŒæŒ‡é’ˆå­˜å‚¨ä¸€ä¸ªå˜é‡åœ°å€
> 2. å¼•ç”¨åœ¨å®šä¹‰æ—¶å¿…é¡»åˆå§‹åŒ–ï¼ŒæŒ‡é’ˆæ²¡æœ‰è¦æ±‚
> 3. å¼•ç”¨åœ¨åˆå§‹åŒ–æ—¶å¼•ç”¨ä¸€ä¸ªå®ä½“åï¼Œå°±ä¸èƒ½å†å¼•ç”¨å…¶ä»–å®ä½“ï¼Œè€ŒæŒ‡é’ˆå¯ä»¥åœ¨ä»»ä½•æ—¶å€™æŒ‡å‘ä»»ä½•ä¸€ä¸ªåŒç±»å‹å®ä½“
> 4. æ²¡æœ‰NULLå¼•ç”¨ï¼Œä½†æœ‰NULLæŒ‡é’ˆ
> 5. åœ¨sizeofä¸­å«ä¹‰ä¸åŒï¼šå¼•ç”¨ç»“æœä¸ºå¼•ç”¨ç±»å‹çš„å¤§å°ï¼Œä½†æŒ‡é’ˆå§‹ç»ˆæ˜¯åœ°å€ç©ºé—´æ‰€å å­—èŠ‚ä¸ªæ•°(32ä½å¹³å°ä¸‹å 4ä¸ªå­—èŠ‚)
> 6. å¼•ç”¨è‡ªåŠ å³å¼•ç”¨çš„å®ä½“å¢åŠ 1ï¼ŒæŒ‡é’ˆè‡ªåŠ å³æŒ‡é’ˆå‘ååç§»ä¸€ä¸ªç±»å‹çš„å¤§å°
> 7. æœ‰å¤šçº§æŒ‡é’ˆï¼Œä½†æ˜¯æ²¡æœ‰å¤šçº§å¼•ç”¨
> 8. è®¿é—®å®ä½“æ–¹å¼ä¸åŒï¼ŒæŒ‡é’ˆéœ€è¦æ˜¾å¼è§£å¼•ç”¨ï¼Œå¼•ç”¨ç¼–è¯‘å™¨è‡ªå·±å¤„ç†
> 9. å¼•ç”¨æ¯”æŒ‡é’ˆä½¿ç”¨èµ·æ¥ç›¸å¯¹æ›´å®‰å…¨

## å†…è”å‡½æ•°

### æ¦‚å¿µ

ä»¥**inlineä¿®é¥°çš„å‡½æ•°**å«åšå†…è”å‡½æ•°ï¼Œ**ç¼–è¯‘æ—¶C++ç¼–è¯‘å™¨ä¼šåœ¨è°ƒç”¨å†…è”å‡½æ•°çš„åœ°æ–¹å±•å¼€**ï¼Œæ²¡æœ‰å‡½æ•°è°ƒç”¨å»ºç«‹æ ˆå¸§çš„å¼€é”€ï¼Œå†…è”å‡½æ•°æå‡ç¨‹åºè¿è¡Œçš„æ•ˆç‡ã€‚

```c
int Add(int left, int right) {
	return left + right;
}
int main() {
	int ret = 0;
	ret = Add(2, 0);
	return 0;
}
```

<img src="F:/cs/note/images/image-20240523213101878.png" alt="image-20240523213101878" style="zoom: 50%;" />

å¦‚æœåœ¨ä¸Šè¿°å‡½æ•°å‰å¢åŠ inlineå…³é”®å­—å°†å…¶æ”¹æˆå†…è”å‡½æ•°ï¼Œåœ¨ç¼–è¯‘æœŸé—´ç¼–è¯‘å™¨ä¼šç”¨å‡½æ•°ä½“æ›¿æ¢å‡½æ•°çš„è°ƒç”¨ã€‚ 

æŸ¥çœ‹æ–¹å¼ï¼š 

1. åœ¨releaseæ¨¡å¼ä¸‹ï¼ŒæŸ¥çœ‹ç¼–è¯‘å™¨ç”Ÿæˆçš„æ±‡ç¼–ä»£ç ä¸­æ˜¯å¦å­˜åœ¨call Add
2. åœ¨debugæ¨¡å¼ä¸‹ï¼Œéœ€è¦å¯¹ç¼–è¯‘å™¨è¿›è¡Œè®¾ç½®ï¼Œå¦åˆ™ä¸ä¼šå±•å¼€(å› ä¸ºdebugæ¨¡å¼ä¸‹ï¼Œç¼–è¯‘å™¨é»˜è®¤ä¸ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œä»¥ä¸‹ç»™å‡ºvs2022çš„è®¾ç½®æ–¹å¼)

<img src="F:/cs/note/images/image-20240523213246113.png" alt="image-20240523213246113" style="zoom:50%;" />

![image-20240523213308501](F:/cs/note/images/image-20240523213308501.png)

![image-20240523213321316](F:/cs/note/images/image-20240523213321316.png)

```c
inline int Add(int left, int right) {
	return left + right;
}
int main() {
	int ret = 0;
	ret = Add(2, 0);
	return 0;
}
```

<img src="F:/cs/note/images/image-20240523213158884.png" alt="image-20240523213158884" style="zoom:50%;" />

### ç‰¹æ€§

1. inlineæ˜¯ä¸€ç§**ä»¥ç©ºé—´æ¢æ—¶é—´**çš„åšæ³•ï¼Œå¦‚æœç¼–è¯‘å™¨å°†å‡½æ•°å½“æˆå†…è”å‡½æ•°å¤„ç†ï¼Œ**åœ¨ç¼–è¯‘é˜¶æ®µï¼Œä¼šç”¨å‡½æ•°ä½“æ›¿æ¢å‡½æ•°è°ƒç”¨ï¼Œç¼ºé™·ï¼šå¯èƒ½ä¼šä½¿ç›®æ ‡æ–‡ä»¶å˜å¤§ï¼Œä¼˜åŠ¿ï¼šå°‘äº†è°ƒç”¨å¼€é”€ï¼Œæé«˜ç¨‹åºè¿è¡Œæ•ˆç‡ã€‚**

2. inlineå¯¹äºç¼–è¯‘å™¨è€Œè¨€**åªæ˜¯ä¸€ä¸ªå»ºè®®**ï¼Œä¸åŒç¼–è¯‘å™¨å…³äºinlineå®ç°æœºåˆ¶å¯èƒ½ä¸åŒï¼Œä¸€èˆ¬å»ºè®®ï¼šå°†**å‡½æ•°è§„æ¨¡è¾ƒå°**(å³å‡½æ•°ä¸æ˜¯å¾ˆé•¿ï¼Œå…·ä½“æ²¡æœ‰å‡†ç¡®çš„è¯´æ³•ï¼Œå–å†³äºç¼–è¯‘å™¨å†…éƒ¨å®ç°)ã€**ä¸æ˜¯é€’å½’ã€ä¸”é¢‘ç¹è°ƒç”¨çš„å‡½æ•°**é‡‡ç”¨inlineä¿®é¥°ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šå¿½ç•¥inlineç‰¹æ€§ã€‚

3. inline**ä¸å»ºè®®å£°æ˜å’Œå®šä¹‰åˆ†ç¦»**ï¼Œåˆ†ç¦»ä¼šå¯¼è‡´é“¾æ¥é”™è¯¯ã€‚å› ä¸ºinlineè¢«å±•å¼€ï¼Œå°±æ²¡æœ‰å‡½æ•°åœ°å€äº†ï¼Œé“¾æ¥å°±ä¼šæ‰¾ä¸åˆ°ã€‚

   ```c
   // F.h
   #include <iostream>
   using namespace std;
   inline void f(int i);
   // F.cpp
   #include "F.h"
   void f(int i)
   {
    cout << i << endl;
   }
   // main.cpp
   #include "F.h"
   int main()
   {
    f(10);
    return 0;
   }
   // é“¾æ¥é”™è¯¯ï¼šmain.obj : error LNK2019: æ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å· "void __cdecl f(int)" (?f@@YAXH@Z)ï¼Œè¯¥ç¬¦å·åœ¨å‡½æ•° main ä¸­è¢«å¼•ç”¨
   ```

   ```c
   //å»ºè®®åœ¨å†…è”å‡½æ•°å£°æ˜æ—¶å°±å®šä¹‰
   // F.h
   #include <iostream>
   using namespace std;
   inline void f(int i)
   {
    cout << i << endl;
   }
   // main.cpp
   #include "F.h"
   int main()
   {
    f(10);
    return 0;
   }
   ```

> `#define`å®šä¹‰å®ä¸å†…è”å‡½æ•°çš„æ¯”è¾ƒ
>
> å®çš„ä¼˜ç‚¹ï¼š 1.å¢å¼ºä»£ç çš„å¤ç”¨æ€§ã€‚ 2.æé«˜æ€§èƒ½ã€‚ 
> å®çš„ç¼ºç‚¹ï¼š 1.ä¸æ–¹ä¾¿è°ƒè¯•å®ã€‚ï¼ˆå› ä¸ºé¢„ç¼–è¯‘é˜¶æ®µè¿›è¡Œäº†æ›¿æ¢ï¼‰ 2.å¯¼è‡´ä»£ç å¯è¯»æ€§å·®ï¼Œå¯ç»´æŠ¤æ€§å·®ï¼Œå®¹æ˜“è¯¯ç”¨ã€‚ 3.æ²¡æœ‰ç±»å‹å®‰å…¨çš„æ£€æŸ¥ ã€‚
>
> å†…è”å‡½æ•°æ‘’å¼ƒäº†å®çš„ç¼ºç‚¹ï¼Œä¸”ç®€å•ã€ä¸æ˜“å‡ºé”™ã€å¯è¢«è°ƒè¯•ã€å¯è¯»æ€§å¼ºï¼Œä½†æ˜¯ä¼šå¢å¤§å¯æ‰§è¡Œæ–‡ä»¶å®¹é‡ã€‚

## `auto`å…³é”®å­—ï¼ˆC++11ï¼‰

### ç®€ä»‹

**autoå£°æ˜çš„å˜é‡ä¼šåœ¨ç¼–è¯‘é˜¶æ®µæ ¹æ®åˆå§‹å€¼æ¥æ¨å‡ºautoå˜é‡çš„ç±»å‹ã€‚**

```c
#include<iostream>
using namespace std;
int TestAuto()
{
	return 10;
}
int main()
{
	int a = 10;
	auto b = a;
	auto c = 'a';
	auto d = TestAuto();
	auto e; //æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œä½¿ç”¨autoå®šä¹‰å˜é‡æ—¶å¿…é¡»å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–

	cout << typeid(b).name() << endl;
	cout << typeid(c).name() << endl;
	cout << typeid(d).name() << endl;
	return 0;
}
```

> ä½¿ç”¨autoå®šä¹‰å˜é‡æ—¶**å¿…é¡»å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–**ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µç¼–è¯‘å™¨éœ€è¦æ ¹æ®åˆå§‹åŒ–è¡¨è¾¾å¼æ¥æ¨å¯¼auto çš„å®é™…ç±»å‹ã€‚å› æ­¤autoå¹¶éæ˜¯ä¸€ç§â€œç±»å‹â€çš„å£°æ˜ï¼Œè€Œæ˜¯**ä¸€ä¸ªç±»å‹å£°æ˜æ—¶çš„â€œå ä½ç¬¦â€**ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸä¼šå°†autoæ›¿æ¢ä¸ºå˜é‡å®é™…çš„ç±»å‹ã€‚

### ä½¿ç”¨ç»†åˆ™

1.  **autoä¸æŒ‡é’ˆå’Œå¼•ç”¨ç»“åˆèµ·æ¥ä½¿ç”¨**
   ç”¨autoå£°æ˜æŒ‡é’ˆç±»å‹æ—¶ï¼Œç”¨autoå’Œauto*æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œä½†ç”¨autoå£°æ˜å¼•ç”¨ç±»å‹æ—¶åˆ™å¿…é¡»åŠ &

   ```c
   #include<iostream>
   using namespace std;
   int main()
   {
       int x = 10;
       auto a = &x;
       auto* b = &x;
       auto& c = x;
       cout << typeid(a).name() << endl;   //int*
       cout << typeid(b).name() << endl;   //int*
       cout << typeid(c).name() << endl;   //int
       return 0;
   }
   ```

2. **åœ¨åŒä¸€è¡Œå®šä¹‰å¤šä¸ªå˜é‡**
   å½“åœ¨åŒä¸€è¡Œå£°æ˜å¤šä¸ªå˜é‡æ—¶ï¼Œè¿™äº›å˜é‡å¿…é¡»æ˜¯ç›¸åŒçš„ç±»å‹ï¼Œå¦åˆ™ç¼–è¯‘å™¨å°†ä¼šæŠ¥é”™ï¼Œå› ä¸ºç¼–è¯‘å™¨å®é™…åªå¯¹ç¬¬ä¸€ä¸ªç±»å‹è¿›è¡Œæ¨å¯¼ï¼Œç„¶åç”¨æ¨å¯¼å‡ºæ¥çš„ç±»å‹å®šä¹‰å…¶ä»–å˜é‡ã€‚

   ```c
   void TestAuto()
   {
       auto a = 1, b = 2; 
       auto c = 3, d = 4.0;  // è¯¥è¡Œä»£ç ä¼šç¼–è¯‘å¤±è´¥ï¼Œå› ä¸ºcå’Œdçš„åˆå§‹åŒ–è¡¨è¾¾å¼ç±»å‹ä¸åŒ
   }
   ```

3. **autoä¸èƒ½æ¨å¯¼çš„åœºæ™¯**

   1. **autoä¸èƒ½ä½œä¸ºå‡½æ•°çš„å‚æ•°**

   2. **autoä¸èƒ½ç›´æ¥ç”¨æ¥å£°æ˜æ•°ç»„**

      ```c
      void TestAuto()
      {
          int a[] = {1,2,3};
          auto b[] = {4ï¼Œ5ï¼Œ6};//error
      }
      ```

   3. ä¸ºäº†é¿å…ä¸C++98ä¸­çš„autoå‘ç”Ÿæ··æ·†ï¼ŒC++11åªä¿ç•™äº†autoä½œä¸ºç±»å‹æŒ‡ç¤ºç¬¦çš„ç”¨æ³•
      åœ¨æ—©æœŸC/C++ä¸­autoçš„å«ä¹‰æ˜¯ï¼šä½¿ç”¨autoä¿®é¥°çš„å˜é‡ï¼Œæ˜¯å…·æœ‰è‡ªåŠ¨å­˜å‚¨å™¨çš„å±€éƒ¨å˜é‡ï¼Œ

   4. autoåœ¨å®é™…ä¸­æœ€å¸¸è§çš„ä¼˜åŠ¿ç”¨æ³•å°±æ˜¯è·Ÿä»¥åä¼šè®²åˆ°çš„C++11æä¾›çš„æ–°å¼forå¾ªç¯ï¼Œè¿˜æœ‰ lambdaè¡¨è¾¾å¼ç­‰è¿›è¡Œé…åˆä½¿ç”¨ã€‚

## åŸºäºèŒƒå›´çš„forå¾ªç¯(C++11)

### èŒƒå›´forçš„è¯­æ³•

forå¾ªç¯åçš„æ‹¬å·ç”±å†’å·â€œ ï¼šâ€åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¯èŒƒå›´å†…ç”¨äºè¿­ä»£çš„å˜é‡ï¼Œç¬¬äºŒéƒ¨åˆ†åˆ™è¡¨ç¤ºè¢«è¿­ä»£çš„èŒƒå›´ã€‚

```c
#include<iostream>
using namespace std;
void TestFor()
{
    int array[] = { 1, 2, 3, 4, 5 };
    for (auto& e : array)
        e *= 2;
    for (auto e : array)
        cout << e << " ";
}
int main() {
    TestFor();
    return 0;
}
```

> æ³¨æ„ï¼šä¸æ™®é€šå¾ªç¯ç±»ä¼¼ï¼Œå¯ä»¥ç”¨continueæ¥ç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œä¹Ÿå¯ä»¥ç”¨breakæ¥è·³å‡ºæ•´ä¸ªå¾ªç¯ã€‚

### èŒƒå›´forçš„ä½¿ç”¨æ¡ä»¶

1.  forå¾ªç¯è¿­ä»£çš„èŒƒå›´å¿…é¡»æ˜¯ç¡®å®šçš„
   å¯¹äºæ•°ç»„è€Œè¨€ï¼Œå°±æ˜¯æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ çš„èŒƒå›´ï¼›å¯¹äºç±»è€Œè¨€ï¼Œåº”è¯¥æä¾› beginå’Œendçš„æ–¹æ³•ï¼Œbeginå’Œendå°±æ˜¯forå¾ªç¯è¿­ä»£çš„èŒƒå›´ã€‚
   æ³¨æ„ï¼šä»¥ä¸‹ä»£ç å°±æœ‰é—®é¢˜ï¼Œå› ä¸ºforçš„èŒƒå›´ä¸ç¡®å®š

   ```c
   void TestFor(int array[])
   {
       for (auto e : array)//æ­¤å¤„arrayå¹¶ä¸æ˜¯æ•°ç»„ï¼Œè€Œæ˜¯æŒ‡é’ˆ
           cout << e << endl;
   }
   ```

2. **è¿­ä»£çš„å¯¹è±¡è¦å®ç°++å’Œ==çš„æ“ä½œã€‚**(å…³äºè¿­ä»£å™¨è¿™ä¸ªé—®é¢˜ï¼Œä»¥åä¼šè®²)

##  æŒ‡é’ˆç©ºå€¼nullptr(C++11)

NULLå®é™…æ˜¯ä¸€ä¸ªå®ï¼Œåœ¨ä¼ ç»Ÿçš„Cå¤´æ–‡ä»¶(stddef.h)ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä»£ç ï¼š

```c
#ifndef NULL
#ifdef __cplusplus
#define NULL   0
#else
#define NULL   ((void *)0)
#endif
#endif
```

å¯ä»¥çœ‹åˆ°ï¼Œ**NULLå¯èƒ½è¢«å®šä¹‰ä¸ºå­—é¢å¸¸é‡0ï¼Œæˆ–è€…è¢«å®šä¹‰ä¸ºæ— ç±»å‹æŒ‡é’ˆ(void*)çš„å¸¸é‡**ã€‚ä¸è®ºé‡‡å–ä½•ç§å®šä¹‰ï¼Œåœ¨ä½¿ç”¨ç©ºå€¼çš„æŒ‡é’ˆæ—¶ï¼Œéƒ½ä¸å¯é¿å…çš„ä¼šé‡åˆ°ä¸€äº›éº»çƒ¦ï¼Œæ¯”å¦‚ï¼š

```c
void f(int)
{
	cout << "f(int)" << endl;
}
void f(int*)
{
	cout << "f(int*)" << endl;
}
int main()
{
	f(0);			//f(int)
	f(NULL);		//f(int)
	f((int*)0);		//f(int*)
    f(nullptr);		//f(int*)
	return 0;
}
```

åœ¨C++98ä¸­ï¼Œå­—é¢å¸¸é‡0æ—¢å¯ä»¥æ˜¯ä¸€ä¸ªæ•´å½¢æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¯æ— ç±»å‹çš„æŒ‡é’ˆ(void*)å¸¸é‡ï¼Œä½†æ˜¯ç¼–è¯‘å™¨ é»˜è®¤æƒ…å†µä¸‹å°†å…¶çœ‹æˆæ˜¯ä¸€ä¸ªæ•´å½¢å¸¸é‡ï¼Œå¦‚æœè¦å°†å…¶æŒ‰ç…§æŒ‡é’ˆæ–¹å¼æ¥ä½¿ç”¨ï¼Œå¿…é¡»å¯¹å…¶è¿›è¡Œå¼ºè½¬(void  *)0ã€‚

> **æ³¨æ„ï¼š**
>
> 1. **åœ¨ä½¿ç”¨nullptrè¡¨ç¤ºæŒ‡é’ˆç©ºå€¼æ—¶ï¼Œä¸éœ€è¦åŒ…å«å¤´æ–‡ä»¶ï¼Œå› ä¸ºnullptræ˜¯C++11ä½œä¸ºæ–°å…³é”®å­—å¼•å…¥ çš„ã€‚**
> 2. **åœ¨C++11ä¸­ï¼Œsizeof(nullptr) ä¸ sizeof((void*)0)æ‰€å çš„å­—èŠ‚æ•°ç›¸åŒã€‚**
> 3. **ä¸ºäº†æé«˜ä»£ç çš„å¥å£®æ€§ï¼Œåœ¨åç»­è¡¨ç¤ºæŒ‡é’ˆç©ºå€¼æ—¶å»ºè®®æœ€å¥½ä½¿ç”¨nullptrã€‚**

# ç±»å’Œå¯¹è±¡ï¼ˆä¸Šï¼‰

## é¢å‘è¿‡ç¨‹å’Œé¢å‘å¯¹è±¡åˆæ­¥è®¤è¯†

**Cè¯­è¨€**æ˜¯**é¢å‘è¿‡ç¨‹**çš„ï¼Œå…³æ³¨çš„æ˜¯è¿‡ç¨‹ï¼Œåˆ†æå‡ºæ±‚è§£é—®é¢˜çš„æ­¥éª¤ï¼Œé€šè¿‡å‡½æ•°è°ƒç”¨é€æ­¥è§£å†³é—®é¢˜ã€‚

**C++**æ˜¯åŸºäº**é¢å‘å¯¹è±¡**çš„ï¼Œå…³æ³¨çš„æ˜¯å¯¹è±¡ï¼Œå°†ä¸€ä»¶äº‹æƒ…æ‹†åˆ†æˆä¸åŒçš„å¯¹è±¡ï¼Œé å¯¹è±¡ä¹‹é—´çš„äº¤äº’å®Œ æˆã€‚

> ä¸¾ä¸ªä¾‹å­ï¼šå¤–å–ç³»ç»Ÿ
>
> é¢å‘è¿‡ç¨‹çš„æ€æƒ³å°±æ˜¯ä¸Šæ¶â€”ç‚¹é¤â€”æ´¾å•â€”é€é¤â€”ç­¾æ”¶ã€‚
>
> é¢å‘å¯¹è±¡çš„æ€æƒ³å°±æ˜¯é¡¾å®¢ã€å•†å®¶å’Œå¤–å–å‘˜è¿™å‡ ä¸ªå¯¹è±¡ä¹‹é—´äº¤äº’å®Œæˆï¼Œä¸éœ€è¦çŸ¥é“å…·ä½“ç»†èŠ‚ã€‚

## ç±»çš„å¼•å…¥

Cè¯­è¨€ç»“æ„ä½“ä¸­åªèƒ½å®šä¹‰å˜é‡ï¼Œåœ¨C++ä¸­ï¼Œç»“æ„ä½“å†…ä¸ä»…å¯ä»¥å®šä¹‰å˜é‡ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å‡½æ•°ã€‚

```c
#include<stdlib.h>
#include<assert.h>
#include<iostream>
typedef int DataType;
struct Stack {
	void Init(int defaultcapacity = 4) {
		arr = (DataType*)malloc(sizeof(DataType) * defaultcapacity);
		if (!arr) {
			perror("malloc fail");
			return;
		}
		top = 0;
		capacity = defaultcapacity;
	}
	void Push(int x) {
		if (top == capacity) {
			DataType* tmp = (DataType*)realloc(arr, sizeof(DataType) * capacity * 2);
			if (!tmp) {
				perror("realloc fail");
				return;
			}
			arr = tmp;
			capacity *= 2;
		}
		arr[top++] = x;
	}
	void Pop() {
		assert(top);
		top--;
	}
	DataType Top() {
		assert(top);
		return arr[top - 1];
	}
	bool Empty() {
		if (top == 0)
			return true;
		else
			return false;
	}
	void Destory() {
		free(arr);
		arr = nullptr;
		top = capacity = 0;
	}
	DataType* arr;
	int top;
	int capacity;
};
int main() {
	Stack s;
	s.Init();
	for (int i = 0; i < 5; i++)
		s.Push(i + 1);
	while (!s.Empty()) {
		std::cout << s.Top() << std::endl;
		s.Pop();
	}
	s.Destory();
	return 0;
}
```

> ä¸Šé¢ç»“æ„ä½“çš„å®šä¹‰ï¼Œ**åœ¨C++ä¸­æ›´å–œæ¬¢ç”¨classæ¥ä»£æ›¿**ã€‚

## ç±»çš„å®šä¹‰

```c
class className
{
	// ç±»ä½“ï¼šç”±æˆå‘˜å‡½æ•°å’Œæˆå‘˜å˜é‡ç»„æˆ
};  // ä¸€å®šè¦æ³¨æ„åé¢çš„åˆ†å·
```

**class**ä¸ºå®šä¹‰ç±»çš„**å…³é”®å­—**ï¼Œ**ClassName**ä¸º**ç±»çš„åå­—**ï¼Œ**{}**ä¸­ä¸º**ç±»çš„ä¸»ä½“**ï¼Œæ³¨æ„ç±»å®šä¹‰ç»“æŸæ—¶åé¢**åˆ†å·ä¸èƒ½çœç•¥**ã€‚

ç±»ä½“ä¸­å†…å®¹ç§°ä¸º**ç±»çš„æˆå‘˜**ï¼šç±»ä¸­çš„**å˜é‡**ç§°ä¸º**ç±»çš„å±æ€§æˆ–æˆå‘˜å˜é‡**ï¼›ç±»ä¸­çš„**å‡½æ•°**ç§°ä¸º**ç±»çš„æ–¹æ³•æˆ–è€…æˆå‘˜å‡½æ•°**ã€‚

**ç±»çš„ä¸¤ç§å®šä¹‰æ–¹å¼ï¼š**

1. å£°æ˜å’Œå®šä¹‰å…¨éƒ¨æ”¾åœ¨ç±»ä½“ä¸­ï¼Œéœ€æ³¨æ„ï¼šæˆå‘˜å‡½æ•°å¦‚æœ**åœ¨ç±»ä¸­å®šä¹‰**ï¼Œ**ç¼–è¯‘å™¨å¯èƒ½ä¼šå°†å…¶å½“æˆå†…è”å‡½æ•°å¤„ç†**ã€‚
2. ç±»å£°æ˜æ”¾åœ¨.hæ–‡ä»¶ä¸­ï¼Œæˆå‘˜å‡½æ•°å®šä¹‰æ”¾åœ¨.cppæ–‡ä»¶ä¸­ï¼Œæ³¨æ„ï¼š**æˆå‘˜å‡½æ•°åå‰éœ€è¦åŠ ç±»å::**

> **ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ›´æœŸæœ›é‡‡ç”¨ç¬¬äºŒç§æ–¹å¼ã€‚**

æˆå‘˜å˜é‡å‘½åè§„åˆ™çš„å»ºè®®ï¼š

```c
class Date
{
public:
    void Init(int year)
    {
        // è¿™é‡Œçš„yearåˆ°åº•æ˜¯æˆå‘˜å˜é‡ï¼Œè¿˜æ˜¯å‡½æ•°å½¢å‚ï¼Ÿ
        year = year;
    }
private:
	int year;
};

//ä¸€èˆ¬å»ºè®®è¿™æ ·å†™
class Date
{
public:
	void Init(int year)
	{
		_year = year;
	}
private:
	int _year; // æˆ–è€…year_æˆ–è€…myear
	int _month;
	int _day;
};
```

## ç±»çš„è®¿é—®é™å®šç¬¦åŠå°è£…

### è®¿é—®é™å®šç¬¦

ç±»æœ‰ä¸‰ç§è®¿é—®é™å®šç¬¦ï¼š**public**ï¼Œ**protected**ï¼Œ**private**ã€‚

**è®¿é—®é™å®šç¬¦è¯´æ˜ï¼š**

1. **publicä¿®é¥°çš„æˆå‘˜åœ¨ç±»å¤–å¯ä»¥ç›´æ¥è¢«è®¿é—®**

2. **protectedå’Œprivateä¿®é¥°çš„æˆå‘˜åœ¨ç±»å¤–ä¸èƒ½ç›´æ¥è¢«è®¿é—®**ï¼ˆæ­¤å¤„protectedå’Œprivateæ˜¯ç±»ä¼¼çš„ï¼‰

   ```c
   class Student {
   public:
   	void Init(const char* name, const char* sex, int age) {
   		strcpy(_name, name);
   		strcpy(_sex, sex);
   		_age = age;
   	}
   	void Print() {
   		std::cout << _name << " " << _sex << " " << _age << std::endl;
   	}
   private:
   	char _name[20];
   	char _sex[5];
   protected:
   	int _age;
   };
   int main() {
   	Student s;
   	s.Init("å¼ ä¸‰", "ç”·", 18);
   	s.Print();
   	std::cout << s._name << " " << s._sex << " " << s._age << std::endl;//error
   	//â€œStudent::_nameâ€: æ— æ³•è®¿é—® private æˆå‘˜(åœ¨â€œStudentâ€ç±»ä¸­å£°æ˜)
   	//â€œStudent::_sexâ€: æ— æ³•è®¿é—® private æˆå‘˜(åœ¨â€œStudentâ€ç±»ä¸­å£°æ˜)
   	//â€œStudent::_ageâ€: æ— æ³•è®¿é—® protected æˆå‘˜(åœ¨â€œStudentâ€ç±»ä¸­å£°æ˜)
   	return 0;
   }
   ```

3. è®¿é—®æƒé™**ä½œç”¨åŸŸä»è¯¥è®¿é—®é™å®šç¬¦å‡ºç°çš„ä½ç½®å¼€å§‹ç›´åˆ°ä¸‹ä¸€ä¸ªè®¿é—®é™å®šç¬¦å‡ºç°æ—¶ä¸ºæ­¢**

4. å¦‚æœåé¢æ²¡æœ‰è®¿é—®é™å®šç¬¦ï¼Œä½œç”¨åŸŸå°±åˆ° } å³ç±»ç»“æŸã€‚

5. **classçš„é»˜è®¤è®¿é—®æƒé™ä¸ºprivateï¼Œstructä¸ºpublic**(å› ä¸ºstructè¦å…¼å®¹C)

> **æ³¨æ„ï¼šè®¿é—®é™å®šç¬¦åªåœ¨ç¼–è¯‘æ—¶æœ‰ç”¨ï¼Œå½“æ•°æ®æ˜ å°„åˆ°å†…å­˜åï¼Œæ²¡æœ‰ä»»ä½•è®¿é—®é™å®šç¬¦ä¸Šçš„åŒºåˆ«**

### å°è£…

é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§ï¼š**å°è£…**ã€**ç»§æ‰¿**ã€**å¤šæ€**ã€‚

åœ¨ç±»å’Œå¯¹è±¡é˜¶æ®µï¼Œä¸»è¦æ˜¯ç ”ç©¶ç±»çš„å°è£…ç‰¹æ€§ï¼Œé‚£ä»€ä¹ˆæ˜¯å°è£…å‘¢ï¼Ÿ
**å°è£…ï¼šå°†æ•°æ®å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•è¿›è¡Œæœ‰æœºç»“åˆï¼Œéšè—å¯¹è±¡çš„å±æ€§å’Œå®ç°ç»†èŠ‚ï¼Œä»…å¯¹å¤–å…¬å¼€æ¥å£æ¥å’Œå¯¹è±¡è¿›è¡Œäº¤äº’ã€‚**

ä»¥æ ˆçš„å–æ ˆé¡¶å…ƒç´ ä¸ºä¾‹ï¼š
Cè¯­è¨€ä¸­è™½ç„¶å¯ä»¥é€šè¿‡Top()å‡½æ•°å–å¾—æ ˆé¡¶å…ƒç´ ï¼Œä½†å¦‚æœç›´æ¥é€šè¿‡topè®¿é—®æ ˆé¡¶å…ƒç´ ï¼Œç”±äºä¸çŸ¥é“topåˆå€¼æ˜¯-1è¿˜æ˜¯0ï¼Œå°±ä¸çŸ¥é“è®¿é—®çš„æ˜¯æ ˆé¡¶å…ƒç´ è¿˜æ˜¯æ ˆé¡¶å…ƒç´ çš„ä¸Šä¸‹ç©ºé—´ã€‚
C++ä¸­ï¼Œç›´æ¥å°†topé™å®šä¸ºprivateï¼Œå–æ ˆé¡¶å‡½æ•°é™å®šä¸ºpublicï¼Œé‚£è®¿é—®æ ˆé¡¶å…ƒç´ å°±åªèƒ½é€šè¿‡å–æ ˆé¡¶å‡½æ•°ï¼Œå…·ä½“çš„ç»†èŠ‚ä¸éœ€è¦çŸ¥é“ã€‚

> **åœ¨C++è¯­è¨€ä¸­å®ç°å°è£…ï¼Œå¯ä»¥é€šè¿‡ç±»å°†æ•°æ®ä»¥åŠæ“ä½œæ•°æ®çš„æ–¹æ³•è¿›è¡Œæœ‰æœºç»“åˆï¼Œé€šè¿‡è®¿é—®æƒé™æ¥éšè—å¯¹è±¡å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œæ§åˆ¶å“ªäº›æ–¹æ³•å¯ä»¥åœ¨ç±»å¤–éƒ¨ç›´æ¥è¢«ä½¿ç”¨ã€‚**

## ç±»çš„ä½œç”¨åŸŸ

**ç±»å®šä¹‰äº†ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸ**ï¼Œç±»çš„æ‰€æœ‰æˆå‘˜éƒ½åœ¨ç±»çš„ä½œç”¨åŸŸä¸­ã€‚åœ¨ç±»ä½“å¤–å®šä¹‰æˆå‘˜æ—¶ï¼Œéœ€è¦ä½¿ç”¨ ::  ä½œç”¨åŸŸæ“ä½œç¬¦æŒ‡æ˜æˆå‘˜å±äºå“ªä¸ªç±»åŸŸã€‚

```c
//student.h
class Student{
public:
    void showinfo();
private:
    char name[20];
    char sex[5];
    int age;
};
//student.cpp
#include"student.h"
void Student::showinfo(){
    cout<< name << " " << sex << " " << age << endl;
}
```

## ç±»çš„å®ä¾‹åŒ–

**ç”¨ç±»ç±»å‹åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ï¼Œç§°ä¸ºç±»çš„å®ä¾‹åŒ–**

1. ç±»æ˜¯**å¯¹å¯¹è±¡è¿›è¡Œæè¿°çš„**ï¼Œç±»åªæ˜¯ä¸€ä¸ªæ¨¡å‹ä¸€æ ·çš„ä¸œè¥¿ï¼Œé™å®šäº†ç±»æœ‰å“ªäº›æˆå‘˜ï¼Œå®šä¹‰å‡ºä¸€ä¸ªç±»**å¹¶æ²¡æœ‰åˆ†é…å®é™…çš„å†…å­˜ç©ºé—´æ¥å­˜å‚¨å®ƒ**ã€‚
2. ä¸€ä¸ªç±»å¯ä»¥å®ä¾‹åŒ–å‡ºå¤šä¸ªå¯¹è±¡ï¼Œ**å®ä¾‹åŒ–å‡ºçš„å¯¹è±¡å ç”¨å®é™…çš„ç‰©ç†ç©ºé—´ï¼Œå­˜å‚¨ç±»æˆå‘˜å˜é‡**
3. åšä¸ªæ¯”æ–¹ã€‚ç±»å®ä¾‹åŒ–å‡ºå¯¹è±¡å°±åƒç°å®ä¸­ä½¿ç”¨å»ºç­‘è®¾è®¡å›¾å»ºé€ å‡ºæˆ¿å­ï¼Œç±»å°±åƒæ˜¯è®¾è®¡å›¾ï¼Œåªè®¾è®¡å‡ºéœ€è¦ä»€ä¹ˆä¸œè¥¿ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å®ä½“çš„å»ºç­‘å­˜åœ¨ï¼ŒåŒæ ·ç±»ä¹Ÿåªæ˜¯ä¸€ä¸ªè®¾è®¡ï¼Œå®ä¾‹åŒ–å‡ºçš„å¯¹è±¡æ‰èƒ½å®é™…å­˜å‚¨æ•°æ®ï¼Œå ç”¨ç‰©ç†ç©ºé—´

## ç±»å¯¹è±¡æ¨¡å‹

ç±»å¯¹è±¡çš„å­˜å‚¨æ–¹å¼çŒœæµ‹ï¼š

1. å¯¹è±¡ä¸­åŒ…å«ç±»çš„å„ä¸ªæˆå‘˜
   ç¼ºé™·ï¼šæ¯ä¸ªå¯¹è±¡ä¸­æˆå‘˜å˜é‡æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯è°ƒç”¨åŒä¸€ä»½å‡½æ•°ï¼Œå¦‚æœæŒ‰ç…§æ­¤ç§æ–¹å¼å­˜å‚¨ï¼Œå½“ä¸€ä¸ªç±»åˆ›å»ºå¤šä¸ªå¯¹è±¡æ—¶ï¼Œæ¯ä¸ªå¯¹è±¡ä¸­éƒ½ä¼šä¿å­˜ä¸€ä»½ä»£ç ï¼Œç›¸åŒä»£ç ä¿å­˜å¤šæ¬¡ï¼Œæµªè´¹ç©ºé—´ã€‚
2. ä»£ç åªä¿å­˜ä¸€ä»½ï¼Œåœ¨å¯¹è±¡ä¸­ä¿å­˜å­˜æ”¾ä»£ç çš„åœ°å€
3. åªä¿å­˜æˆå‘˜å˜é‡ï¼Œæˆå‘˜å‡½æ•°å­˜æ”¾åœ¨å…¬å…±çš„ä»£ç æ®µ

```c
#include<iostream>
// ç±»ä¸­æ—¢æœ‰æˆå‘˜å˜é‡ï¼Œåˆæœ‰æˆå‘˜å‡½æ•°
class A1 {
public:
    void f1() {}
private:
    int _a;
};
// ç±»ä¸­ä»…æœ‰æˆå‘˜å‡½æ•°
class A2 {
public:
    void f2() {}
};
// ç±»ä¸­ä»€ä¹ˆéƒ½æ²¡æœ‰---ç©ºç±»
class A3
{};
int main() {
    std::cout << sizeof(A1) << std::endl;   //4
    std::cout << sizeof(A2) << std::endl;   //1
    std::cout << sizeof(A3) << std::endl;   //1
    return 0;
}
```

> **ç»“è®ºï¼šç±»å¯¹è±¡çš„å­˜å‚¨æ–¹å¼æ˜¯ç¬¬3ä¸­æ–¹å¼ã€‚ä¸€ä¸ªç±»çš„å¤§å°ï¼Œå®é™…å°±æ˜¯è¯¥ç±»ä¸­â€æˆå‘˜å˜é‡â€ä¹‹å’Œï¼Œå½“ç„¶è¦æ³¨æ„å†…å­˜å¯¹é½ã€‚**
>
> **æ³¨æ„ç©ºç±»çš„å¤§å°ï¼Œç©ºç±»æ¯”è¾ƒç‰¹æ®Šï¼Œç¼–è¯‘å™¨ç»™äº†ç©ºç±»ä¸€ä¸ªå­—èŠ‚æ¥å”¯ä¸€æ ‡è¯†è¿™ä¸ªç±»çš„å¯¹è±¡ã€‚**

## thisæŒ‡é’ˆ

### thisæŒ‡é’ˆçš„å¼•å‡º

```c
#include<iostream>
class Date
{
public:
	void Init(int year, int month, int day)
	{
		_year = year;
		_month = month;
		_day = day;
	}
	void Print()
	{
		std::cout << _year << "-" << _month << "-" << _day << std::endl;
	}
private:
	int _year;     // å¹´
	int _month;    // æœˆ
	int _day;      // æ—¥
};
int main()
{
	Date d1, d2;
	d1.Init(2022, 1, 11);
	d2.Init(2022, 1, 12);
	d1.Print();
	d2.Print();
	return 0;
}
```

å¯¹äºä¸Šè¿°ç±»ï¼Œæœ‰è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ï¼š Dateç±»ä¸­æœ‰ Init ä¸ Print ä¸¤ä¸ªæˆå‘˜å‡½æ•°ï¼Œå‡½æ•°ä½“ä¸­æ²¡æœ‰å…³äºä¸åŒå¯¹è±¡çš„åŒºåˆ†ï¼Œé‚£å½“d1è°ƒç”¨ Init å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°æ˜¯å¦‚ä½•çŸ¥é“åº”è¯¥è®¾ç½®d1å¯¹è±¡ï¼Œè€Œä¸æ˜¯è®¾ç½®d2å¯¹è±¡å‘¢ï¼Ÿ
è¿™å°±æ¶‰åŠåˆ°éšå«çš„thisæŒ‡é’ˆï¼ŒthisæŒ‡é’ˆæ˜¯ä¸€ä¸ªéšå«çš„å½¢å‚ã€‚

```c
#include<iostream>
class Date
{
public:
	//ç¼–è¯‘å¤„ç†å‰
	void Init(int year, int month, int day)
	{
		_year = year;
		_month = month;
		_day = day;
	}
	//ç¼–è¯‘å¤„ç†å
	void Init(Date* const thisï¼Œint year, int month, int day)
	{
		this->_year = year;
		this->_month = month;
		this->_day = day;
	}

	//ç¼–è¯‘å¤„ç†å‰
	void Print()
	{
		std::cout << _year << "-" << _month << "-" << _day << std::endl;
	}
	//ç¼–è¯‘å¤„ç†å
	void Print(Date* const this)
	{
		std::cout << this->_year << "-" << this->_month << "-" << this->_day << std::endl;
	}
private:
	int _year;     // å¹´
	int _month;    // æœˆ
	int _day;      // æ—¥
};
int main()
{
	Date d1, d2;
	//ç¼–è¯‘å¤„ç†å‰
	d1.Init(&d1, 2022, 1, 11);
	d2.Init(&d2, 2022, 1, 12);
	//ç¼–è¯‘å¤„ç†å
	d1.Init(2022, 1, 11);
	d2.Init(2022, 1, 12);

	//ç¼–è¯‘å¤„ç†å‰
	d1.Print();
	d2.Print();
	//ç¼–è¯‘å¤„ç†å
	d1.Print(&d1);
	d2.Print(&d2);
	return 0;
}
```

- **thisä¸èƒ½åœ¨å½¢å‚å’Œå®å‚æ˜¾ç¤ºä¼ é€’ï¼Œä½†æ˜¯å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨æ˜¾ç¤ºä½¿ç”¨**

```c
#include<iostream>
class Date
{
public:
	void Init(int year, int month, int day)
	{
		_year = year;
		_month = month;
		_day = day;
	}
	void Print()
	{
		std::cout << this << std::endl;
		std::cout << this->_year << "-" << this->_month << "-" << this->_day << std::endl;
	}
private:
	int _year;     // å¹´
	int _month;    // æœˆ
	int _day;      // æ—¥
};
int main()
{
	Date d1, d2;
	d1.Init(2022, 1, 11);			//000000E75FF6F748
	std::cout << &d1 << std::endl;	//000000E75FF6F748
	d1.Print();						//2022-1-11
	return 0;
}
```

> **C++ç¼–è¯‘å™¨ç»™æ¯ä¸ªâ€œéé™æ€çš„æˆå‘˜å‡½æ•°â€œå¢åŠ äº†ä¸€ä¸ªéšè—çš„æŒ‡é’ˆå‚æ•°ï¼Œè®©è¯¥æŒ‡é’ˆæŒ‡å‘å½“å‰å¯¹è±¡(å‡½æ•°è¿è¡Œæ—¶è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡)ï¼Œåœ¨å‡½æ•°ä½“ä¸­æ‰€æœ‰â€œæˆå‘˜å˜é‡â€ çš„æ“ä½œï¼Œéƒ½æ˜¯é€šè¿‡è¯¥æŒ‡é’ˆå»è®¿é—®ã€‚åªä¸è¿‡æ‰€æœ‰çš„æ“ä½œå¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ï¼Œå³ç”¨æˆ·ä¸éœ€è¦æ¥ä¼ é€’ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨å®Œæˆã€‚**

### thisæŒ‡é’ˆçš„ç‰¹æ€§

1. thisæŒ‡é’ˆçš„ç±»å‹ï¼š**`ç±»ç±»å‹* const`**ï¼Œå³æˆå‘˜å‡½æ•°ä¸­ï¼Œä¸èƒ½ç»™thisæŒ‡é’ˆèµ‹å€¼ã€‚
2. åªèƒ½åœ¨â€œæˆå‘˜å‡½æ•°â€çš„å†…éƒ¨ä½¿ç”¨ã€‚
3. **thisæŒ‡é’ˆæœ¬è´¨ä¸Šæ˜¯â€œæˆå‘˜å‡½æ•°â€çš„å½¢å‚**ï¼Œå½“å¯¹è±¡è°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼Œå°†å¯¹è±¡åœ°å€ä½œä¸ºå®å‚ä¼ é€’ç»™ thiså½¢å‚ã€‚æ‰€ä»¥**å¯¹è±¡ä¸­ä¸å­˜å‚¨thisæŒ‡é’ˆ**ã€‚
4. **thisæŒ‡é’ˆæ˜¯â€œæˆå‘˜å‡½æ•°â€ç¬¬ä¸€ä¸ªéšå«çš„æŒ‡é’ˆå½¢å‚ï¼Œä¸€èˆ¬æƒ…å†µç”±ç¼–è¯‘å™¨é€šè¿‡ecxå¯„å­˜å™¨è‡ªåŠ¨ä¼ é€’ï¼Œä¸éœ€è¦ç”¨æˆ·ä¼ é€’**ã€‚

> 1. thisæŒ‡é’ˆå­˜åœ¨å“ªé‡Œï¼Ÿ
>    å› ä¸ºthisæ˜¯å½¢å‚ï¼ŒthisæŒ‡é’ˆä¸å…¶ä»–å½¢å‚ä¸€æ ·å­˜å‚¨åœ¨å‡½æ•°è°ƒç”¨çš„æ ˆæ¡¢é‡Œé¢ã€‚
>
> 2. thisæŒ‡é’ˆå¯ä»¥ä¸ºç©ºå—ï¼Ÿ
>
>    ```c++
>    // 1.ä¸‹é¢ç¨‹åºç¼–è¯‘è¿è¡Œç»“æœæ˜¯ï¼Ÿ C
>    //Aã€ç¼–è¯‘æŠ¥é”™ Bã€è¿è¡Œå´©æºƒ Cã€æ­£å¸¸è¿è¡Œ
>    class A
>    {
>    public:
>    	void Print()
>    	{
>    		cout << "Print()" << endl;
>    	}
>    private:
>    	int _a;
>    };
>                                                                   
>    int main()
>    {
>    	A* p = nullptr;
>    	p->Print();
>    	return 0;
>    }
>    ```
>
>    è§£æï¼špè°ƒç”¨Printï¼Œä¸ä¼šå‘ç”Ÿè§£å¼•ç”¨ï¼Œå› ä¸ºPrintçš„åœ°å€ä¸åœ¨å¯¹è±¡ä¸­ã€‚pä¼šä½œä¸ºå®å‚ä¼ é€’ç»™thisæŒ‡é’ˆã€‚thisæŒ‡é’ˆæ˜¯ç©ºçš„ï¼Œä½†æ˜¯åœ¨Printå‡½æ•°å†…æ²¡æœ‰å¯¹thisæŒ‡é’ˆè§£å¼•ç”¨ã€‚
>
>    ```c++
>    // 2.ä¸‹é¢ç¨‹åºç¼–è¯‘è¿è¡Œç»“æœæ˜¯ï¼Ÿ B
>    //Aã€ç¼–è¯‘æŠ¥é”™ Bã€è¿è¡Œå´©æºƒ Cã€æ­£å¸¸è¿è¡Œ
>    class A
>    {
>    public:
>        void PrintA()
>        {
>            cout<<_a<<endl;
>        }
>    private:
>        int _a;
>    };
>                                                                   
>    int main()
>    {
>        A* p = nullptr;
>        p->PrintA();
>        return 0;
>    }
>    ```
>
>    è§£æï¼špè°ƒç”¨Printï¼Œä¸ä¼šå‘ç”Ÿè§£å¼•ç”¨ï¼Œå› ä¸ºPrintçš„åœ°å€ä¸åœ¨å¯¹è±¡ä¸­ã€‚pä¼šä½œä¸ºå®å‚ä¼ é€’ç»™thisæŒ‡é’ˆã€‚thisæŒ‡é’ˆæ˜¯ç©ºçš„ï¼Œä½†æ˜¯åœ¨Printå‡½æ•°å†…è®¿é—®\_aï¼Œæœ¬è´¨æ˜¯this->\_aã€‚

# ç±»å’Œå¯¹è±¡ï¼ˆä¸­ï¼‰

## ç±»çš„6ä¸ªé»˜è®¤æˆå‘˜å‡½æ•°

å¦‚æœä¸€ä¸ªç±»ä¸­ä»€ä¹ˆæˆå‘˜éƒ½æ²¡æœ‰ï¼Œç®€ç§°ä¸ºç©ºç±»ã€‚ 

ç©ºç±»ä¸­çœŸçš„ä»€ä¹ˆéƒ½æ²¡æœ‰å—ï¼Ÿå¹¶ä¸æ˜¯ï¼Œä»»ä½•ç±»åœ¨ä»€ä¹ˆéƒ½ä¸å†™æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹6ä¸ªé»˜è®¤æˆå‘˜å‡½æ•°ã€‚ 

é»˜è®¤æˆå‘˜å‡½æ•°ï¼šç”¨æˆ·æ²¡æœ‰æ˜¾å¼å®ç°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆçš„æˆå‘˜å‡½æ•°ç§°ä¸ºé»˜è®¤æˆå‘˜å‡½æ•°ã€‚

![image-20240526172803257](F:/cs/note/images/image-20240526172803257.png)

## æ„é€ å‡½æ•°

### æ¦‚å¿µ

å¯¹äºDateç±»ï¼Œå¯ä»¥é€šè¿‡ Init å…¬æœ‰æ–¹æ³•ç»™å¯¹è±¡è®¾ç½®æ—¥æœŸï¼Œä½†å¦‚æœæ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶éƒ½è°ƒç”¨è¯¥æ–¹æ³•è®¾ç½®ä¿¡æ¯ï¼Œæœªå…æœ‰ç‚¹éº»çƒ¦ï¼Œé‚£èƒ½å¦åœ¨å¯¹è±¡åˆ›å»ºæ—¶ï¼Œå°±å°†ä¿¡æ¯è®¾ç½®è¿›å»å‘¢ï¼Ÿ 

**æ„é€ å‡½æ•°**æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œ**åå­—ä¸ç±»åç›¸åŒ**ï¼Œåˆ›å»ºç±»ç±»å‹å¯¹è±¡æ—¶ç”±**ç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨**ï¼Œä»¥ä¿è¯æ¯ä¸ªæ•°æ®æˆå‘˜éƒ½æœ‰ä¸€ä¸ªåˆé€‚çš„åˆå§‹å€¼ï¼Œå¹¶ä¸”**åœ¨å¯¹è±¡æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…åªè°ƒç”¨ä¸€æ¬¡**ã€‚

### ç‰¹æ€§

1. **å‡½æ•°åä¸ç±»åç›¸åŒ**ã€‚
2. **æ— è¿”å›å€¼**ã€‚ä¹Ÿä¸éœ€è¦å†™void
3.  å¯¹è±¡å®ä¾‹åŒ–æ—¶ç¼–è¯‘å™¨**è‡ªåŠ¨è°ƒç”¨**å¯¹åº”çš„æ„é€ å‡½æ•°ã€‚
4. æ„é€ å‡½æ•°**å¯ä»¥é‡è½½**ã€‚
5. å¦‚æœç±»ä¸­æ²¡æœ‰æ˜¾å¼å®šä¹‰æ„é€ å‡½æ•°ï¼Œåˆ™C++ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª**æ— å‚çš„é»˜è®¤æ„é€ å‡½æ•°**ï¼Œä¸€æ—¦ç”¨æˆ·æ˜¾å¼å®šä¹‰ç¼–è¯‘å™¨å°†ä¸å†ç”Ÿæˆã€‚

**è§£æç‰¹æ€§1-4ï¼š**

> ```c++
> #include<iostream>
> using namespace std;
> class Date{
> public:
> 	Date() {
> 		_year = 1970;
> 		_month = 1;
> 		_day = 1;
> 	}
> 	Date(int year, int month, int day) {
> 		_year = year;
> 		_month = month;
> 		_day = day;
> 	}
> 	void Print() {
> 		cout << _year << "-" << _month << "-" << _day << endl;
> 	}
> private:
> 	int _year;
> 	int _month;
> 	int _day;
> };
> int main() {
> 	Date d1;
> 	d1.Print();//1970-1-1
> 	Date d2(2024, 5, 26);
> 	d2.Print();//2024-5-26
> 	return 0;
> }
> ```

**è§£æç‰¹æ€§5ï¼š**

> ```c++
> #include<iostream>
> using namespace std;
> class Date{
> public:
> 	void Print() {
> 		cout << _year << "-" << _month << "-" << _day << endl;
> 	}
> private:
> 	int _year;
> 	int _month;
> 	int _day;
> };
> int main() {
> 	Date d1;
> 	d1.Print();//-858993460--858993460--858993460
> 	return 0;
> }
> ```
>
> ä¸ºä»€ä¹ˆd1å¯¹è±¡è°ƒç”¨äº†ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½†æ˜¯d1å¯¹è±¡\_year/\_month/\_dayï¼Œä¾æ—§æ˜¯éšæœºå€¼ï¼Ÿ
> C++æŠŠç±»å‹åˆ†æˆå†…ç½®ç±»å‹(åŸºæœ¬ç±»å‹)å’Œè‡ªå®šä¹‰ç±»å‹ã€‚å†…ç½®ç±»å‹å°±æ˜¯è¯­è¨€æä¾›çš„æ•°æ®ç±»å‹ï¼Œå¦‚ï¼šint/char...ï¼Œè‡ªå®šä¹‰ç±»å‹å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨class/struct/unionç­‰è‡ªå·±å®šä¹‰çš„ç±»å‹ï¼ŒğŸ’¡**ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤çš„æ„é€ å‡½æ•°å¯¹å†…ç½®ç±»å‹æˆå‘˜å˜é‡ä¸å¤„ç†ï¼Œå¯¹è‡ªå®šç±»å‹æˆå‘˜è°ƒç”¨çš„å®ƒè‡ªå·±çš„é»˜è®¤æˆå‘˜å‡½æ•°ã€‚**æ•…ä¸Šè¿°ä»£ç ä¸­d1çš„æˆå‘˜å˜é‡å¹¶æœªå¤„ç†ã€‚
>
> é»˜è®¤æ„é€ å‡½æ•°ï¼š**æ— å‚æ„é€ å‡½æ•°ã€å…¨ç¼ºçœæ„é€ å‡½æ•°ã€æˆ‘ä»¬æ²¡å†™ç¼–è¯‘å™¨é»˜è®¤ç”Ÿæˆçš„æ„é€ å‡½æ•°**ï¼Œéƒ½å¯ä»¥è®¤ä¸ºæ˜¯é»˜è®¤æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”**é»˜è®¤æ„é€ å‡½æ•°åªèƒ½æœ‰ä¸€ä¸ª**ã€‚
> **æ— å‚æ„é€ å‡½æ•°å’Œå…¨ç¼ºçœæ„é€ å‡½æ•°æ„æˆé‡è½½ï¼Œåœ¨ä¸è°ƒç”¨çš„æƒ…å†µä¸‹å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œç¼–è¯‘ä¹Ÿæ²¡æœ‰é”™è¯¯ã€‚ä½†æ˜¯åœ¨å®é™…è°ƒç”¨çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå­˜åœ¨æ­§ä¹‰ã€‚æ¨èå†™å…¨ç¼ºçœçš„æ„é€ å‡½æ•°ã€‚**
>
> ```c++
> #include<iostream>
> using namespace std;
> class Date{
> public:
> 	Date() {
> 		_year = 1970;
> 		_month = 1;
> 		_day = 1;
> 	}
> 	Date(int year = 1, int month = 1, int day = 1) {
> 		_year = year;
> 		_month = month;
> 		_day = day;
> 	}
> 	void Print() {
> 		cout << _year << "-" << _month << "-" << _day << endl;
> 	}
> private:
> 	int _year;
> 	int _month;
> 	int _day;
> };
> int main() {
> 	Date d1;	//errorï¼Œç±»"Date"åŒ…å«å¤šä¸ªé»˜è®¤æ„é€ å‡½æ•°
> 
> 	Date d2();	
> 	d2.Print();	//errorï¼Œè¡¨è¾¾å¼å¿…é¡»å…·æœ‰ç±»ç±»å‹ï¼Œä½†å®ƒå…·æœ‰ç±»å‹Date(*)()
> 	//æ­¤å¤„ç¼–è¯‘å™¨å°†d2è¯†åˆ«ä¸ºå‡½æ•°æŒ‡é’ˆ
> 	return 0;
> }
> ```
>
> **æ„é€ å‡½æ•°æ— å‚æ•°æ—¶ï¼Œå®šä¹‰å¯¹è±¡æ—¶`Date d2();`è¯­å¥æœ‰æ­§ä¹‰ï¼Œä¼šè·Ÿå‡½æ•°å£°æ˜æœ‰ç‚¹å†²çªï¼Œç¼–è¯‘å™¨ä¸å¥½è¯†åˆ«ï¼Œåªèƒ½`Date d1;`è¿™æ ·å®šä¹‰å¯¹è±¡ã€‚**
>
> æ³¨æ„ï¼šC++11 ä¸­é’ˆå¯¹å†…ç½®ç±»å‹æˆå‘˜ä¸åˆå§‹åŒ–çš„ç¼ºé™·ï¼Œåˆæ‰“äº†è¡¥ä¸ï¼Œå³ï¼š**å†…ç½®ç±»å‹æˆå‘˜å˜é‡åœ¨ç±»ä¸­å£°æ˜æ—¶å¯ä»¥ç»™é»˜è®¤å€¼ã€‚**
>
> ```c++
> #include<iostream>
> using namespace std;
> class Time {
> public:
> 	void Print() {
> 		cout << _hour << ":" << _minute << ":" << _second << endl;
> 	}
> private:
> 	int _hour = 8;
> 	int _minute = 0;
> 	int _second = 0;
> };
> class Date{
> public:
> 	void Print() {
> 		cout << _year << "-" << _month << "-" << _day << endl;
> 		_t.Print();
> 	}
> private:
> 	int _year = 1970;
> 	int _month = 1;
> 	int _day = 1;
> 	Time _t;
> };
> int main() {
> 	Date d1;
> 	d1.Print();
> 	//1970-1-1
> 	//8:0:0
> 	return 0;
> }
> ```

## ææ„å‡½æ•°

### æ¦‚å¿µ

é€šè¿‡å‰é¢æ„é€ å‡½æ•°çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªå¯¹è±¡æ˜¯æ€ä¹ˆæ¥çš„ï¼Œé‚£ä¸€ä¸ªå¯¹è±¡åˆæ˜¯æ€ä¹ˆæ²¡å‘¢çš„ï¼Ÿ 

**ææ„å‡½æ•°**ï¼šä¸æ„é€ å‡½æ•°åŠŸèƒ½ç›¸åï¼Œææ„å‡½æ•°ä¸æ˜¯å®Œæˆå¯¹å¯¹è±¡æœ¬èº«çš„é”€æ¯ï¼Œå±€éƒ¨å¯¹è±¡é”€æ¯å·¥ä½œæ˜¯ç”±ç¼–è¯‘å™¨å®Œæˆçš„ã€‚è€Œ**å¯¹è±¡åœ¨é”€æ¯æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ï¼Œå®Œæˆå¯¹è±¡ä¸­èµ„æºçš„æ¸…ç†å·¥ä½œã€‚**

### ç‰¹æ€§

1. ææ„å‡½æ•°åæ˜¯åœ¨**ç±»åå‰åŠ ä¸Šå­—ç¬¦ ~**ã€‚
2. æ— å‚æ•°**æ— è¿”å›å€¼**ç±»å‹ã€‚
3. ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªææ„å‡½æ•°ã€‚è‹¥æœªæ˜¾å¼å®šä¹‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆ**é»˜è®¤çš„ææ„å‡½æ•°**ã€‚æ³¨æ„ï¼š**ææ„å‡½æ•°ä¸èƒ½é‡è½½**ã€‚
4. å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼ŒC++ç¼–è¯‘ç³»ç»Ÿç³»ç»Ÿ**è‡ªåŠ¨è°ƒç”¨**ææ„å‡½æ•°ã€‚
5. ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤ææ„å‡½æ•°ï¼Œå¯¹å†…ç½®ç±»å‹æˆå‘˜ä¸åšå¤„ç†ï¼Œå¯¹è‡ªå®šç±»å‹æˆå‘˜è°ƒç”¨å®ƒçš„ææ„å‡½æ•°ã€‚
6. å¦‚æœç±»ä¸­æ²¡æœ‰ç”³è¯·èµ„æºæ—¶ï¼Œææ„å‡½æ•°å¯ä»¥ä¸å†™ï¼Œç›´æ¥ä½¿ç”¨ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤ææ„å‡½æ•°ï¼Œæ¯”å¦‚ Dateç±»ï¼›**æœ‰èµ„æºç”³è¯·æ—¶ï¼Œä¸€å®šè¦å†™ï¼Œå¦åˆ™ä¼šé€ æˆèµ„æºæ³„æ¼**ï¼Œæ¯”å¦‚Stackç±»ã€‚

```c++
#include<iostream>
using namespace std;
class Time {
public:
	void Print() {
		cout << _hour << ":" << _minute << ":" << _second << endl;
	}
	~Time() {
		cout << "~Time()" << endl;
	}
private:
	int _hour = 8;
	int _minute = 0;
	int _second = 0;
};
class Date{
public:
	void Print() {
		cout << _year << "-" << _month << "-" << _day << endl;
		_t.Print();
	}
	~Date() {
		cout << "~Date()" << endl;
	}
private:
	int _year = 1970;
	int _month = 1;
	int _day = 1;
	Time _t;
};
int main() {
	Date d1;
	//~Date()
	//~Time()
	return 0;
}
```

ç°åœ¨æˆ‘ç”¨ç±»å®ä¾‹åŒ–å‡ºst1å’Œst2ä¸¤ä¸ªå¯¹è±¡ï¼Œé¦–å…ˆï¼Œst1è‚¯å®šå…ˆæ„é€ ï¼Œst2è‚¯å®šåæ„é€ ï¼Œè¿™ç‚¹æ¯‹åº¸ç½®ç–‘ï¼Œé‚£å…³é”®æ˜¯è°å…ˆææ„å‘¢ï¼Ÿ

```c++
int main()
{
	Stack st1;
	Stack st2;
}
```

**st2å…ˆææ„ï¼Œst1åææ„**ï¼Œè¿™é‡Œst1å’Œst2çš„ç©ºé—´æ˜¯å¼€è¾Ÿåœ¨æ ˆå¸§ä¸Šçš„ï¼Œåè¿›å…ˆå‡ºï¼Œst2åå‹æ ˆï¼Œé‚£ä¹ˆå®ƒè‚¯å®šæ˜¯æœ€å…ˆææ„çš„ã€‚æ‰€ä»¥æ ˆé‡Œé¢å®šä¹‰å¯¹è±¡ï¼Œææ„é¡ºåºå’Œæ„é€ é¡ºåºæ˜¯åçš„ã€‚

## æ‹·è´æ„é€ å‡½æ•°

### æ¦‚å¿µ

é‚£åœ¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå¯å¦åˆ›å»ºä¸€ä¸ªä¸å·²å­˜åœ¨å¯¹è±¡ä¸€æŸä¸€æ ·çš„æ–°å¯¹è±¡å‘¢ï¼Ÿ 

**æ‹·è´æ„é€ å‡½æ•°**ï¼š**åªæœ‰å•ä¸ªå½¢å‚**ï¼Œè¯¥å½¢å‚æ˜¯å¯¹**æœ¬ç±»ç±»å‹å¯¹è±¡çš„å¼•ç”¨(ä¸€èˆ¬å¸¸ç”¨constä¿®é¥°)**ï¼Œ**åœ¨ç”¨å·²å­˜åœ¨çš„ç±»ç±»å‹å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡æ—¶ç”±ç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨**ã€‚

### ç‰¹æ€§

1. æ‹·è´æ„é€ å‡½æ•°æ˜¯**æ„é€ å‡½æ•°çš„ä¸€ä¸ªé‡è½½å½¢å¼**ã€‚
   **æ‹·è´æ„é€ å‡½æ•°ä¹Ÿæ˜¯æ„é€ å‡½æ•°ï¼Œé»˜è®¤æ„é€ å‡½æ•°åªåœ¨æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°çš„æ—¶å€™ç³»ç»Ÿæ‰ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚**
2. æ‹·è´æ„é€ å‡½æ•°çš„**å‚æ•°åªæœ‰ä¸€ä¸ª**ä¸”å¿…é¡»æ˜¯**ç±»ç±»å‹å¯¹è±¡çš„å¼•ç”¨**ï¼Œ<u>ä½¿ç”¨ä¼ å€¼æ–¹å¼ç¼–è¯‘å™¨ç›´æ¥æŠ¥é”™ï¼Œ å› ä¸ºä¼šå¼•å‘æ— ç©·é€’å½’è°ƒç”¨</u>ã€‚
3. è‹¥æœªæ˜¾å¼å®šä¹‰ï¼Œ**ç¼–è¯‘å™¨ä¼šç”Ÿæˆé»˜è®¤çš„æ‹·è´æ„é€ å‡½æ•°**ã€‚ é»˜è®¤çš„æ‹·è´æ„é€ å‡½æ•°å¯¹è±¡æŒ‰å†…å­˜å­˜å‚¨æŒ‰å­—èŠ‚åºå®Œæˆæ‹·è´ï¼Œè¿™ç§æ‹·è´å«åš**æµ…æ‹·è´**ï¼Œæˆ–è€…å€¼æ‹·è´ã€‚
4. æ‹·è´æ„é€ å‡½æ•°å…¸å‹è°ƒç”¨åœºæ™¯ï¼š **ä½¿ç”¨å·²å­˜åœ¨å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡ï¼Œå‡½æ•°å‚æ•°ç±»å‹ä¸ºç±»ç±»å‹å¯¹è±¡ï¼Œå‡½æ•°è¿”å›å€¼ç±»å‹ä¸ºç±»ç±»å‹å¯¹è±¡**

**è§£æç‰¹æ€§1ï¼š**

> ```c++
> #include<iostream>
> using namespace std;
> class Date {
> public:
> 	Date(int year = 1970, int month = 1, int day = 1) {
> 		_year = year;
> 		_month = month;
> 		_day = day;
> 	}
> 	Date(const Date& d)
> 	{
> 		_year = d._year;
> 		_month = d._month;
> 		_day = d._day;
> 	}
> 	void Print() {
> 		cout << _year << "-" << _month << "-" << _day << endl;
> 	}
> private:
> 	int _year;
> 	int _month;
> 	int _day;
> };
> int main() {
> 	Date d1(2024, 5, 27);
> 	Date d2(d1);
> 	d2.Print();//2024-5-27
> 	return 0;
> }
> ```

**è§£æç‰¹æ€§2ï¼š**

> ä¸ºä»€ä¹ˆä½¿ç”¨ä¼ å€¼æ–¹å¼ç¼–è¯‘å™¨ç›´æ¥æŠ¥é”™ï¼Œä¼šå¼•å‘æ— ç©·é€’å½’è°ƒç”¨ï¼Ÿ
>
> C++è§„å®šï¼šå†…ç½®ç±»å‹å€¼ä¼ é€’æ—¶ç›´æ¥æ‹·è´ï¼Œè‡ªå®šä¹‰ç±»å‹å€¼ä¼ é€’æ—¶å¿…é¡»è°ƒç”¨æ‹·è´æ„é€ å®Œæˆæ‹·è´ï¼Œä¸æƒ³ç”¨æ‹·è´æ„é€ å°±éœ€è¦å¼•ç”¨ä¼ é€’
>
> ```c++
> void Func(Date d) {
> 
> }
> int main() {
> 	Date d1(2024, 5, 27);
> 	Func(d1);//Date(const Date& d)
> 	return 0;
> }
> ```
>
> é‚£å¦‚æœæ‹·è´æ„é€ æ˜¯å€¼ä¼ å‚ï¼Œé‚£ä¹ˆå°±ä¼šæ— é™è°ƒç”¨æ‹·è´æ„é€ ã€‚
>
> ![image-20240527211259472](F:/cs/note/images/image-20240527211259472.png)

**è§£æç‰¹æ€§3ï¼š**

> **åœ¨ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ä¸­ï¼Œå†…ç½®ç±»å‹æ˜¯æŒ‰ç…§å­—èŠ‚æ–¹å¼ç›´æ¥æ‹·è´çš„ï¼Œè€Œè‡ªå®šä¹‰ç±»å‹æ˜¯è°ƒç”¨å…¶æ‹·è´æ„é€ å‡½æ•°å®Œæˆæ‹·è´çš„ã€‚**
>
> ```c++
> #include<iostream>
> using namespace std;
> class Time {
> public:
> 	Time(int hour = 8, int minute = 0, int second = 0) {
> 		_hour = hour;
> 		_minute = minute;
> 		_second = second;
> 	}
> 	void Print() {
> 		cout << _hour << ":" << _minute << ":" << _second << endl;
> 	}
> private:
> 	int _hour;
> 	int _minute;
> 	int _second;
> };
> class Date {
> public:
> 	Date(int year = 1970, int month = 1, int day = 1, int hour = 8, int minute = 0, int second = 0) :_t(hour, minute, second)
> 	{
> 		_year = year;
> 		_month = month;
> 		_day = day;
> 	}
> 	void Print() {
> 		cout << _year << "-" << _month << "-" << _day << endl;
> 		_t.Print();
> 	}
> private:
> 	int _year;
> 	int _month;
> 	int _day;
> 	Time _t;
> };
> int main() {
> 	Date d1(2024, 5, 27, 1, 1, 1);
> 	Date d2(d1);
> 	d2.Print();
> 	//2024-5-27
> 	//1:1:1
> 	return 0;
> }
> ```
>
> ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å·²ç»å¯ä»¥å®Œæˆå­—èŠ‚åºçš„å€¼æ‹·è´äº†ï¼Œè¿˜éœ€è¦è‡ªå·±æ˜¾å¼å®ç°å—ï¼Ÿ
>
> ```c++
> // è¿™é‡Œä¼šå‘ç°ä¸‹é¢çš„ç¨‹åºä¼šå´©æºƒæ‰ï¼Ÿè¿™é‡Œå°±éœ€è¦æˆ‘ä»¬ä»¥åè®²çš„æ·±æ‹·è´å»è§£å†³ã€‚
> #include<iostream>
> #include<stdlib.h>
> typedef int DataType;
> class Stack
> {
> public:
> 	Stack(size_t capacity = 10)
> 	{
> 		_array = (DataType*)malloc(capacity * sizeof(DataType));
> 		if (nullptr == _array)
> 		{
> 			perror("mallocç”³è¯·ç©ºé—´å¤±è´¥");
> 			return;
> 		}
> 		_size = 0;
> 		_capacity = capacity;
> 	}
> 	void Push(const DataType& data)
> 	{
> 		// CheckCapacity();
> 		_array[_size] = data;
> 		_size++;
> 	}
> 	~Stack()
> 	{
> 		if (_array)
> 		{
> 			free(_array);
> 			_array = nullptr;
> 			_capacity = 0;
> 			_size = 0;
> 		}
> 	}
> private:
> 	DataType* _array;
> 	size_t _size;
> 	size_t _capacity;
> };
> int main()
> {
> 	Stack s1;
> 	s1.Push(1);
> 	s1.Push(2);
> 	s1.Push(3);
> 	s1.Push(4);
> 	Stack s2(s1);
> 	return 0;
> }
> ```
>
> ![image-20240527214536132](F:/cs/note/images/image-20240527214536132.png)
>
> è¿™æ®µç¨‹åºæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š
>
> 1. å…³äºæ‹·è´çš„é—®é¢˜ï¼Œé»˜è®¤æ‹·è´æ„é€ å‡½æ•°æ˜¯æµ…æ‹·è´ï¼Œå°†s1ä¸­çš„å†…å®¹åŸåŸæœ¬æœ¬åœ°æ‹·è´ç»™s2ï¼Œå› æ­¤s1å’Œs2æŒ‡å‘åŒä¸€ä¸ªå†…å­˜ç©ºé—´ã€‚
> 2. å½“ç¨‹åºé€€å‡ºæ—¶ï¼Œs2å’Œs1è¦é”€æ¯ã€‚s2å…ˆé”€æ¯ï¼Œs2é”€æ¯æ—¶è°ƒç”¨ææ„å‡½æ•°ï¼Œå·²ç»å°†0x00d50c08çš„ç©ºé—´é‡Šæ”¾äº†ï¼Œä½†æ˜¯s1å¹¶ä¸çŸ¥é“ï¼Œåˆ°s1é”€æ¯æ—¶ï¼Œä¼šå°†0x00d50c08çš„ç©ºé—´å†é‡Šæ”¾ä¸€æ¬¡ï¼Œä¸€å—å†…å­˜ç©ºé—´å¤šæ¬¡é‡Šæ”¾ï¼Œè‚¯å®šä¼šé€ æˆç¨‹åºå´©æºƒã€‚
>
> **æ³¨æ„ï¼šç±»ä¸­å¦‚æœæ²¡æœ‰æ¶‰åŠèµ„æºç”³è¯·æ—¶ï¼Œæ‹·è´æ„é€ å‡½æ•°æ˜¯å¦å†™éƒ½å¯ä»¥ï¼›ä¸€æ—¦æ¶‰åŠåˆ°èµ„æºç”³è¯· æ—¶ï¼Œåˆ™æ‹·è´æ„é€ å‡½æ•°æ˜¯ä¸€å®šè¦å†™çš„ï¼Œå¦åˆ™å°±æ˜¯æµ…æ‹·è´ã€‚**

**è§£æç‰¹æ€§4ï¼š**

> ```c++
> #include<iostream>
> using namespace std;
> class Date
> {
> public:
> 	Date(int year = 1, int month = 1, int day = 1) {
> 		cout << "Construct " << this << endl;
> 		_year = year;
> 		_month = month;
> 		_day = day;
> 
> 	}
> 	Date(const Date& d) {
> 		cout << "Copy Construct " << this << endl;
> 		_year = d._year;
> 		_month = d._month;
> 		_day = d._day;
> 	}
> 	~Date() {
> 		cout << "Destruct " << this << endl;
> 	}
> 	void Print() {
> 		cout << _year << "-" << _month << "-" << _day << endl;
> 	}
> private:
> 	int _year;
> 	int _month;
> 	int _day;
> };
> Date Test(Date d) {
> 	Date temp(d);
> 	return temp;
> }
> int main()
> {
> 	Date d1(2024, 5, 27);
> 	Test(d1);
> 	return 0;
> }
> //Construct 0073FC90			//æ„é€ d1
> //Copy Construct 0073FB80		//æ‹·è´å®å‚d1ç»™å½¢å‚d
> //Copy Construct 0073FB54		//æ‹·è´åˆ›å»ºtemp
> //Copy Construct 0073FBB0		//æ‹·è´åˆ›å»ºä¸´æ—¶å˜é‡ç”¨æ¥è¿”å›
> //Destruct 0073FB54				//ææ„temp
> //Destruct 0073FB80				//ææ„å½¢å‚d
> //Destruct 0073FBB0				//ææ„ä¸´æ—¶å˜é‡
> //Destruct 0073FC90				//ææ„d1
> //VS2022æµ‹è¯•æ—¶ä¼šè‡ªåŠ¨ä¼˜åŒ–æ‰æ‹·è´åˆ›å»ºä¸´æ—¶å˜é‡ï¼Œç›´æ¥è¿”å›temp
> ```
>
> ä¸ºäº†æé«˜ç¨‹åºæ•ˆç‡ï¼Œä¸€èˆ¬å¯¹è±¡ä¼ å‚æ—¶ï¼Œå°½é‡ä½¿ç”¨å¼•ç”¨ç±»å‹ï¼Œè¿”å›æ—¶æ ¹æ®å®é™…åœºæ™¯ï¼Œèƒ½ç”¨å¼•ç”¨å°½é‡ä½¿ç”¨å¼•ç”¨ã€‚

## èµ‹å€¼è¿ç®—ç¬¦é‡è½½

### è¿ç®—ç¬¦é‡è½½

C++ä¸ºäº†å¢å¼ºä»£ç çš„å¯è¯»æ€§å¼•å…¥äº†è¿ç®—ç¬¦é‡è½½ï¼Œè¿ç®—ç¬¦é‡è½½æ˜¯å…·æœ‰ç‰¹æ®Šå‡½æ•°åçš„å‡½æ•°ï¼Œä¹Ÿå…·æœ‰å…¶è¿”å›å€¼ç±»å‹ï¼Œå‡½æ•°åå­—ä»¥åŠå‚æ•°åˆ—è¡¨ï¼Œå…¶è¿”å›å€¼ç±»å‹ä¸å‚æ•°åˆ—è¡¨ä¸æ™®é€šçš„å‡½æ•°ç±»ä¼¼ã€‚ 

å‡½æ•°åå­—ä¸ºï¼šå…³é”®å­—**operatoråé¢æ¥éœ€è¦é‡è½½çš„è¿ç®—ç¬¦ç¬¦å·**ã€‚ 

å‡½æ•°åŸå‹ï¼š**è¿”å›å€¼ç±»å‹ operatoræ“ä½œç¬¦(å‚æ•°åˆ—è¡¨)** 

æ³¨æ„ï¼š 

1. ä¸èƒ½é€šè¿‡è¿æ¥å…¶ä»–ç¬¦å·æ¥åˆ›å»ºæ–°çš„æ“ä½œç¬¦ï¼šæ¯”å¦‚operator@
2. é‡è½½æ“ä½œç¬¦å¿…é¡»æœ‰ä¸€ä¸ªç±»ç±»å‹å‚æ•°
3. ç”¨äºå†…ç½®ç±»å‹çš„è¿ç®—ç¬¦ï¼Œå…¶å«ä¹‰ä¸èƒ½æ”¹å˜ï¼Œä¾‹å¦‚ï¼šå†…ç½®çš„æ•´å‹+ï¼Œä¸ èƒ½æ”¹å˜å…¶å«ä¹‰
4. ä½œä¸ºç±»æˆå‘˜å‡½æ•°é‡è½½æ—¶ï¼Œå…¶å½¢å‚çœ‹èµ·æ¥æ¯”æ“ä½œæ•°æ•°ç›®å°‘1ï¼Œå› ä¸ºæˆå‘˜å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºéšè—çš„this
5. `.*   ::   sizeof   ?:   .` æ³¨æ„ä»¥ä¸Š5ä¸ªè¿ç®—ç¬¦ä¸èƒ½é‡è½½ã€‚è¿™ä¸ªç»å¸¸åœ¨ç¬”è¯•é€‰æ‹©é¢˜ä¸­å‡ºç°ã€‚ 

```c++
#include<iostream>
using namespace std;
class Date
{
public:
	Date(int year = 1970, int month = 1, int day = 1) {
		_year = year;
		_month = month;
		_day = day;
	}
	bool operator==(const Date& d2) {
		return _year == d2._year
			&& _month == d2._month
			&& _day == d2._day;
	}
private:
	int _year;
	int _month;
	int _day;
};
int main()
{
	Date d1(2024, 5, 28);
	Date d2(d1);
	if (d1 == d2)	//ç­‰ä»·äº d1.operator==(d2)
		cout << "yes" << endl;
	else
		cout << "no" << endl;
	return 0;
}
```

### èµ‹å€¼è¿ç®—ç¬¦é‡è½½

1. èµ‹å€¼è¿ç®—ç¬¦é‡è½½æ ¼å¼
   **å‚æ•°ç±»å‹**ï¼š**const T&**ï¼Œä¼ é€’å¼•ç”¨å¯ä»¥æé«˜ä¼ å‚æ•ˆç‡
   **è¿”å›å€¼ç±»å‹**ï¼š**T&**ï¼Œè¿”å›å¼•ç”¨å¯ä»¥æé«˜è¿”å›çš„æ•ˆç‡ï¼Œæœ‰è¿”å›å€¼ç›®çš„æ˜¯ä¸ºäº†æ”¯æŒè¿ç»­èµ‹å€¼
   **æ£€æµ‹æ˜¯å¦è‡ªå·±ç»™è‡ªå·±èµ‹å€¼**
   **è¿”å›*this** ï¼šè¦å¤åˆè¿ç»­èµ‹å€¼çš„å«ä¹‰
2. . **èµ‹å€¼è¿ç®—ç¬¦åªèƒ½é‡è½½æˆç±»çš„æˆå‘˜å‡½æ•°ä¸èƒ½é‡è½½æˆå…¨å±€å‡½æ•°**
   åŸå› ï¼šèµ‹å€¼è¿ç®—ç¬¦å¦‚æœä¸æ˜¾å¼å®ç°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„ã€‚æ­¤æ—¶ç”¨æˆ·å†åœ¨ç±»å¤–è‡ªå·±å®ç° ä¸€ä¸ªå…¨å±€çš„èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼Œå°±å’Œç¼–è¯‘å™¨åœ¨ç±»ä¸­ç”Ÿæˆçš„é»˜è®¤èµ‹å€¼è¿ç®—ç¬¦é‡è½½å†²çªäº†ï¼Œæ•…èµ‹å€¼ è¿ç®—ç¬¦é‡è½½åªèƒ½æ˜¯ç±»çš„æˆå‘˜å‡½æ•°ã€‚
3. **ç”¨æˆ·æ²¡æœ‰æ˜¾å¼å®ç°æ—¶ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼Œä»¥å€¼çš„æ–¹å¼é€å­—èŠ‚æ‹·è´ã€‚**æ³¨æ„ï¼šå†…ç½®ç±»å‹æˆå‘˜å˜é‡æ˜¯ç›´æ¥èµ‹å€¼çš„ï¼Œè€Œè‡ªå®šä¹‰ç±»å‹æˆå‘˜å˜é‡éœ€è¦è°ƒç”¨å¯¹åº”ç±»çš„èµ‹å€¼è¿ç®—ç¬¦é‡è½½å®Œæˆèµ‹å€¼ã€‚

```c++
#include<iostream>
using namespace std;
class Date
{
public:
	Date(int year = 1970, int month = 1, int day = 1) {
		_year = year;
		_month = month;
		_day = day;
	}
	Date(const Date& d)
	{
		_year = d._year;
		_month = d._month;
		_day = d._day;
	}
	bool operator==(const Date& d2) {
		return _year == d2._year
			&& _month == d2._month
			&& _day == d2._day;
	}
	Date& operator=(const Date & d2){
		if (this == &d2)	//ä¸å»ºè®®å†™æˆ*this == d2ï¼Œå› ä¸ºå¯èƒ½æ²¡æœ‰==è¿ç®—ç¬¦é‡è½½
			return *this;
		_year = d2._year;
		_month = d2._month;
		_day = d2._day;
		return *this;
	}
private:
	int _year;
	int _month;
	int _day;
};
int main()
{
	Date d1(2024, 5, 28);
	Date d2;
	Date d3 = d1;
	d2 = d1;
	return 0;
}
```

ä¸Šè¿°ä»£ç ä¸­`Date d3 = d1;` æ˜¯æ‹·è´æ„é€ ï¼Œ`d2 = d1;` æ˜¯èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼š
æ‹·è´æ„é€ æ˜¯ç”¨å·²æœ‰çš„å¯¹è±¡å»åˆå§‹åŒ–å¦ä¸€ä¸ªå¯¹è±¡ï¼Œèµ‹å€¼è¿ç®—ç¬¦é‡è½½æ˜¯å·²ç»å­˜åœ¨çš„ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å¤åˆ¶æ‹·è´ã€‚`Date d3 = d1;`ç­‰ä»·äº`Date d3(d1);`ã€‚

### å‰ç½®++å’Œåç½®++**é‡è½½**

```c++
// å‰ç½®++ï¼šè¿”å›+1ä¹‹åçš„ç»“æœ
// thisæŒ‡å‘çš„å¯¹è±¡å‡½æ•°ç»“æŸåä¸ä¼šé”€æ¯ï¼Œæ•…ä»¥å¼•ç”¨æ–¹å¼è¿”å›æé«˜æ•ˆç‡
Date& Date::operator++()
{
	*this += 1;
	return *this;
}

// åç½®++ï¼šè¿”å›+1ä¹‹å‰çš„ç»“æœ
// C++è§„å®šï¼šåç½®++é‡è½½æ—¶å¤šå¢åŠ ä¸€ä¸ªintç±»å‹çš„å‚æ•°ï¼Œä½†è°ƒç”¨å‡½æ•°æ—¶è¯¥å‚æ•°ä¸ç”¨ä¼ é€’ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨ä¼ é€’
// åç½®++æ˜¯å…ˆä½¿ç”¨å+1ï¼Œå› æ­¤éœ€è¦è¿”å›+1ä¹‹å‰çš„æ—§å€¼ï¼Œæ•…éœ€åœ¨å®ç°æ—¶éœ€è¦å…ˆå°†thisä¿å­˜ä¸€ä»½ï¼Œç„¶åç»™this+1ï¼Œè€Œtempæ˜¯ä¸´æ—¶å¯¹è±¡ï¼Œå› æ­¤åªèƒ½ä»¥å€¼çš„æ–¹å¼è¿”å›ï¼Œä¸èƒ½è¿”å›å¼•ç”¨
Date Date::operator++(int)
{
	Date tmp = *this;
	*this += 1;
	return tmp;
}
```

## constæˆå‘˜å‡½æ•°

**å°†constä¿®é¥°çš„â€œæˆå‘˜å‡½æ•°â€ç§°ä¹‹ä¸ºconstæˆå‘˜å‡½æ•°**ï¼Œconstä¿®é¥°ç±»æˆå‘˜å‡½æ•°ï¼Œ**å®é™…ä¿®é¥°è¯¥æˆå‘˜å‡½æ•°éšå«çš„thisæŒ‡é’ˆ**ï¼Œè¡¨æ˜åœ¨è¯¥æˆå‘˜å‡½æ•°ä¸­**ä¸èƒ½å¯¹ç±»çš„ä»»ä½•æˆå‘˜è¿›è¡Œä¿®æ”¹**ã€‚

```c++
#include<iostream>
using namespace std;
class Date
{
public:
	Date(int year, int month, int day)
	{
		_year = year;
		_month = month;
		_day = day;
	}
	void Print()		//ç¼–è¯‘å™¨å¤„ç†åä¸ºvoid Print(Date* const this)
	{
		cout << "Print()" << endl;
		cout << _year  <<"-" << _month << "-" << _day << endl;
	}
	void Print() const	//ç¼–è¯‘å™¨å¤„ç†åä¸ºvoid Print(const Date* const this)
	{
		cout << "Print()const" << endl;
		cout << _year << "-" << _month << "-" << _day << endl;
	}
private:
	int _year; // å¹´
	int _month; // æœˆ
	int _day; // æ—¥
};
void Test()
{
	Date d1(2022, 1, 13);
	d1.Print(); 
	// Print()
	// 2022-1-13
	const Date d2(2022, 1, 13);
	d2.Print();
	// Print()const
	// 2022-1-13
}
```

è¯·æ€è€ƒä¸‹é¢çš„å‡ ä¸ªé—®é¢˜ï¼š

1. constå¯¹è±¡å¯ä»¥è°ƒç”¨éconstæˆå‘˜å‡½æ•°å—ï¼Ÿ
   ä¸å¯ä»¥ï¼Œæƒé™æ”¾å¤§
2. éconstå¯¹è±¡å¯ä»¥è°ƒç”¨constæˆå‘˜å‡½æ•°å—ï¼Ÿ
   å¯ä»¥ï¼Œæƒé™ç¼©å°
3. constæˆå‘˜å‡½æ•°å†…å¯ä»¥è°ƒç”¨å…¶å®ƒçš„éconstæˆå‘˜å‡½æ•°å—ï¼Ÿ
    ä¸å¯ä»¥ï¼Œ**constæˆå‘˜å‡½æ•°å†…éƒ¨åªèƒ½è°ƒç”¨constæˆå‘˜å‡½æ•°**ã€‚å› ä¸ºconstæˆå‘˜å‡½æ•°å†…éƒ¨çš„thisæŒ‡é’ˆå·²ç»å…·æœ‰å¸¸å±æ€§çš„ï¼Œä¸‡ä¸€è¿™ä¸ªéconstæˆå‘˜å‡½æ•°å»ä¿®æ”¹äº†æˆå‘˜å˜é‡çš„å†…å®¹å°±ä¼šå‡ºé—®é¢˜äº†
4.  éconstæˆå‘˜å‡½æ•°å†…å¯ä»¥è°ƒç”¨å…¶å®ƒçš„constæˆå‘˜å‡½æ•°å—ï¼Ÿ
   å¯ä»¥ï¼Œæƒé™ç¼©å°

```c++
class Date
{
public:
	Date(int year = 1970, int month = 1, int day = 1)
	{
		_year = year;
		_month = month;
		_day = day;
	}
	void Print1()
	{
		cout << _year << "-" << _month << "-" << _day << endl;
	}
	void Print2() const
	{
		cout << _year << "-" << _month << "-" << _day << endl;
	}
	void Func1() 
	{
		Print2();	//æ™®é€šæˆå‘˜å‡½æ•°è°ƒç”¨constæˆå‘˜å‡½æ•°		//okï¼Œæƒé™ç¼©å°
	}
	void Func2() const
	{
		Print1();	//constæˆå‘˜å‡½æ•°è°ƒç”¨æ™®é€šæˆå‘˜å‡½æ•°		//errorï¼Œæƒé™æ”¾å¤§
	}
private:
	int _year; // å¹´
	int _month; // æœˆ
	int _day; // æ—¥
};
void Test()
{
	Date d1(2024, 5, 28);
	d1.Print1();	//æ™®é€šæˆå‘˜å˜é‡è°ƒç”¨æ™®é€šæˆå‘˜å‡½æ•°		//okï¼Œæƒé™å¹³ç§»
	d1.Print2();	//æ™®é€šæˆå‘˜å˜é‡è°ƒç”¨constæˆå‘˜å‡½æ•°		//okï¼Œæƒé™ç¼©å°
	const Date d2(2024, 5, 29);
	d2.Print1();	//constæˆå‘˜å˜é‡è°ƒç”¨æ™®é€šæˆå‘˜å‡½æ•°		//errorï¼Œæƒé™æ”¾å¤§
	d2.Print2();	//constæˆå‘˜å˜é‡è°ƒç”¨constæˆå‘˜å‡½æ•°	//okï¼Œæƒé™å¹³ç§»
}
int main() {
	Test();
	return 0;
}
```

> ç»“è®ºï¼šåªè¦æˆå‘˜å‡½æ•°å†…éƒ¨ä¸ä¿®æ”¹æˆå‘˜å˜é‡ï¼Œéƒ½åº”è¯¥åŠ constï¼Œè¿™æ ·constå¯¹è±¡å’Œæ™®é€šå¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨

## å–åœ°å€åŠconstå–åœ°å€æ“ä½œç¬¦é‡è½½

è¿™ä¸¤ä¸ªé»˜è®¤æˆå‘˜å‡½æ•°ä¸€èˆ¬ä¸ç”¨é‡æ–°å®šä¹‰ ï¼Œç¼–è¯‘å™¨é»˜è®¤ä¼šç”Ÿæˆã€‚

```c++
#include<iostream>
using namespace std;
class Date
{
public:
	//å–åœ°å€&é‡è½½
	Date* operator&()
	{
		cout << "Date* operator&()" << endl;
		return this;
	}
	//constå–åœ°å€&é‡è½½
	const Date* operator&() const
	{
		cout << "const Date* operator&() const" << endl;
		return this;
	}
private:
	int _year = 1; // å¹´
	int _month = 1; // æœˆ
	int _day = 1; // æ—¥
};
int main()
{
	Date d1;
	const Date d2;
	cout << &d1 << endl;
	cout << &d2 << endl;
	return 0;
}
```

è¿™ä¸¤ä¸ªè¿ç®—ç¬¦ä¸€èˆ¬ä¸éœ€è¦é‡è½½ï¼Œä½¿ç”¨ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤å–åœ°å€çš„é‡è½½å³å¯ï¼Œåªæœ‰ç‰¹æ®Šæƒ…å†µï¼Œæ‰éœ€è¦é‡è½½ï¼Œæ¯”å¦‚æƒ³è®©åˆ«äººè·å–åˆ°æŒ‡å®šçš„å†…å®¹ï¼

## æ—¥æœŸç±»å®ç°

Date.h

```c++
#include<iostream>
#include<assert.h>
using namespace std;

class Date {
	// å‹å…ƒå‡½æ•°å£°æ˜
    // <<æµè¾“å…¥æ“ä½œç¬¦é‡è½½
	friend ostream& operator<<(ostream& out, const Date& d);
    // >>æµæå–æ“ä½œç¬¦é‡è½½
	friend istream& operator>>(istream& in, Date& d);
public:
	// æ„é€ å‡½æ•°
	Date(int year = 1970, int month = 1, int day = 1);
	// æ‹·è´æ„é€ å‡½æ•°
	Date(const Date& x);
	// ææ„å‡½æ•°
	~Date(){}
    
	// èµ‹å€¼è¿ç®—ç¬¦é‡è½½
	Date& operator=(const Date& x);

	// <è¿ç®—ç¬¦é‡è½½
	bool operator<(const Date& x) const;
	// ==è¿ç®—ç¬¦é‡è½½
	bool operator==(const Date& x) const;
	// <=è¿ç®—ç¬¦é‡è½½
	bool operator<=(const Date& x) const;
	// >è¿ç®—ç¬¦é‡è½½
	bool operator>(const Date& x) const;
	// >=è¿ç®—ç¬¦é‡è½½
	bool operator>=(const Date& x) const;
	// !=è¿ç®—ç¬¦é‡è½½
	bool operator!=(const Date& x) const;
    
	// è·å–æŸå¹´æŸæœˆçš„å¤©æ•°
	int GetMonthDay(int year, int month);
	// æ—¥æœŸ+=å¤©æ•°
	Date& operator+=(int day);
	// æ—¥æœŸ+å¤©æ•°
	Date operator+(int day) const;
	// æ—¥æœŸ-=å¤©æ•°
	Date& operator-=(int day);
	// æ—¥æœŸ-å¤©æ•°
	Date operator-(int day) const;
    
	// å‰ç½®++
	Date& operator++();
	// åç½®++
	Date operator++(int);
	// å‰ç½®--
	Date& operator--();
	// åç½®--
	Date operator--(int);
    
	// æ—¥æœŸ-æ—¥æœŸï¼Œè¿”å›å¤©æ•°
	int operator-(const Date& d) const;
    
	// æ‰“å°å¯¹è±¡
	void Print() const
	{
		cout << _year << "-" << _month << "-" << _day << endl;
	}
private:
	int _year;
	int _month;
	int _day;
};
ostream& operator<<(ostream& out, const Date& d);
istream& operator>>(istream& in, Date& d);
```

Date.cpp

```c++
#include"Date.h"
// æ„é€ å‡½æ•°
Date::Date(int year, int month, int day) {
	if (month <= 12 && month >= 1 && day >= 1 && day <= GetMonthDay(year, month)) {
		_year = year;
		_month = month;
		_day = day;
	}
	else {
		cout << "éæ³•æ—¥æœŸ" << endl;
		assert(false);
	}
}
// æ‹·è´æ„é€ å‡½æ•°
Date::Date(const Date& x) {
	_year = x._year;
	_month = x._month;
	_day = x._day;
}
// èµ‹å€¼è¿ç®—ç¬¦é‡è½½
Date& Date::operator=(const Date& x) {
	if (this == &x)
		return *this;
	_year = x._year;
	_month = x._month;
	_day = x._day;
	return *this;
}
// <è¿ç®—ç¬¦é‡è½½
bool Date::operator<(const Date& x) const {
	if (_year < x._year)
		return true;
	else if (_year == x._year && _month < x._month)
		return true;
	else if (_year == x._year && _month == x._month && _day < x._day)
		return true;
	return false;
}
// ==è¿ç®—ç¬¦é‡è½½
bool Date::operator==(const Date& x) const {
	return _year == x._year
		&& _month == x._month
		&& _day == x._day;
}
// <=è¿ç®—ç¬¦é‡è½½
bool Date::operator<=(const Date& x) const {
	return *this < x || *this == x;
}
// >è¿ç®—ç¬¦é‡è½½
bool Date::operator>(const Date& x) const {
	return !(*this <= x);
}
// >=è¿ç®—ç¬¦é‡è½½
bool Date::operator>=(const Date& x) const {
	return !(*this < x);
}
// !=è¿ç®—ç¬¦é‡è½½
bool Date::operator!=(const Date& x) const {
	return !(*this == x);
}
// è·å–æŸå¹´æŸæœˆçš„å¤©æ•°
int Date::GetMonthDay(int year, int month) {
	int mdays[13] = { 0,31,28,31,30,31,30,31,31,30,31,30,31 };
	if (month == 2 && ((year % 400 == 0) || (year % 4 == 0 && year % 100 != 0)))
		return 29;
	else
		return mdays[month];
}
// æ—¥æœŸ+=å¤©æ•°
Date& Date::operator+=(int day) {
	if (day < 0) {
		return *this -= -day;
	}
	_day += day;
	while (_day > GetMonthDay(_year, _month)) {
		_day -= GetMonthDay(_year, _month);
		++_month;
		if (_month == 13) {
			++_year;
			_month = 1;
		}
	}
	return *this;
}
// æ—¥æœŸ+å¤©æ•°
Date Date::operator+(int day) const {
	Date temp = *this;
	temp += day;
	return temp;
}
// æ—¥æœŸ-=å¤©æ•°
Date& Date::operator-=(int day) {
	if (day < 0) {
		return *this += -day;
	}
	_day -= day;
	while (_day <= 0) {
		--_month;
		if (_month == 0) {
			--_year;
			_month = 12;
		}
		_day += GetMonthDay(_year, _month);
	}
	return *this;
}
// æ—¥æœŸ-å¤©æ•°
Date Date::operator-(int day) const {
	Date temp = *this;
	temp -= day;
	return temp;
}
// å‰ç½®++
Date& Date::operator++() {
	*this += 1;
	return *this;
}
// åç½®++
Date Date::operator++(int) {
	Date temp(*this);
	*this += 1;
	return temp;
}
// å‰ç½®--
Date& Date::operator--() {
	*this -= 1;
	return *this;
}
// åç½®--
Date Date::operator--(int) {
	Date temp(*this);
	*this -= 1;
	return temp;
}
// æ—¥æœŸ-æ—¥æœŸ
int Date::operator-(const Date& d) const {
	Date max = *this;
	Date min = d;
	int flag = 1;
	if (*this < d) {
		max = d;
		min = *this;
		flag = -1;
	}
	int day = 0;
	while (min != max) {
		++min;
		++day;
	}
	return day * flag;
}
// <<æµè¾“å…¥æ“ä½œç¬¦é‡è½½
ostream& operator<<(ostream& out, const Date& d) {
	out << d._year << "å¹´" << d._month << "æœˆ" << d._day << "æ—¥" << endl;
	return out;
}
// >>æµæå–æ“ä½œç¬¦é‡è½½
istream& operator>>(istream& in, Date& d) {
	int year, month, day;
	in >> year >> month >> day;
	if (month <= 12 && month >= 1 && day >= 1 && day <= d.GetMonthDay(year, month)) {
		d._year = year;
		d._month = month;
		d._day = day;
	}
	else {
		cout << "éæ³•æ—¥æœŸ" << endl;
		assert(false);
	}
	return in;
}
```



# ç±»å’Œå¯¹è±¡ï¼ˆä¸‹ï¼‰

## å†è°ˆæ„é€ å‡½æ•°

###  æ„é€ å‡½æ•°ä½“èµ‹å€¼

åœ¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨é€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°ï¼Œç»™å¯¹è±¡ä¸­å„ä¸ªæˆå‘˜å˜é‡ä¸€ä¸ªåˆé€‚çš„åˆå§‹å€¼ã€‚

```c++
class Date
{
public:
	Date(int year = 2022, int month = 5, int day = 24)
	{
		_year = year;
		_year = 2023; //ç¬¬äºŒæ¬¡èµ‹å€¼
        _year = 2024; //ç¬¬ä¸‰æ¬¡èµ‹å€¼
		_month = month;
		_day = day;
	}
private:
	int _year;
	int _month;
	int _day;
};
```

è™½ç„¶ä¸Šè¿°æ„é€ å‡½æ•°è°ƒç”¨ä¹‹åï¼Œå¯¹è±¡ä¸­å·²ç»æœ‰äº†ä¸€ä¸ªåˆå§‹å€¼ï¼Œä½†æ˜¯ä¸èƒ½å°†å…¶ç§°ä¸ºå¯¹å¯¹è±¡ä¸­æˆå‘˜å˜é‡çš„åˆå§‹åŒ–ï¼Œ æ„é€ å‡½æ•°ä½“ä¸­çš„è¯­å¥åªèƒ½å°†å…¶ç§°ä¸º**èµ‹åˆå€¼**ï¼Œè€Œä¸èƒ½ç§°ä½œåˆå§‹åŒ–ã€‚**å› ä¸ºåˆå§‹åŒ–åªèƒ½åˆå§‹åŒ–ä¸€æ¬¡ï¼Œè€Œæ„é€ å‡½æ•°ä½“å†…å¯ä»¥å¤šæ¬¡èµ‹å€¼ã€‚**

### åˆå§‹åŒ–åˆ—è¡¨

åˆå§‹åŒ–åˆ—è¡¨ï¼šä»¥ä¸€ä¸ª**å†’å·å¼€å§‹**ï¼Œæ¥ç€æ˜¯ä¸€ä¸ª**ä»¥é€—å·åˆ†éš”çš„æ•°æ®æˆå‘˜åˆ—è¡¨**ï¼Œæ¯ä¸ª"**æˆå‘˜å˜é‡**"åé¢è·Ÿä¸€ä¸ªæ”¾åœ¨**æ‹¬ å·ä¸­çš„åˆå§‹å€¼æˆ–è¡¨è¾¾å¼**ã€‚

```c++
class Date
{
public:
	Date(int year, int month, int day)
		: _year(year)		//å¯¹æˆå‘˜å˜é‡è¿›è¡Œå®šä¹‰å’Œåˆå§‹åŒ–
		, _month(month)
		, _day(day)
	{}
private:
	int _year;	//ç±»ä¸­æˆå‘˜å˜é‡çš„å£°æ˜
	int _month;
	int _day;
};
```

ä¹Ÿå¯ä»¥åœ¨åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–ï¼Œä¹Ÿå¯ä»¥åœ¨å¤§æ‹¬å·å†…è¿›è¡Œèµ‹å€¼ï¼š

```c++
Date(int year = 1970, int month = 1, int day = 1)
    : _year(year)
    , _month(month)
    , _day(day)
    {
        _year = 2024;
    }
//æœ€åçš„_yearçš„å€¼ä¸º2024
```

åˆå§‹åŒ–åˆ—è¡¨çš„æ³¨æ„äº‹é¡¹ï¼š

1. æ¯ä¸ªæˆå‘˜å˜é‡åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­**åªèƒ½å‡ºç°ä¸€æ¬¡**ï¼ˆåˆå§‹åŒ–åªèƒ½åˆå§‹åŒ–ä¸€æ¬¡ï¼‰

2. ç±»ä¸­åŒ…å«ä»¥ä¸‹æˆå‘˜ï¼Œå¿…é¡»æ”¾åœ¨åˆå§‹åŒ–åˆ—è¡¨ä½ç½®è¿›è¡Œåˆå§‹åŒ–ï¼š
   **å¼•ç”¨æˆå‘˜å˜é‡**ï¼ˆå¿…é¡»åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼‰
   **constæˆå‘˜å˜é‡**ï¼ˆå¿…é¡»åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼‰
   **è‡ªå®šä¹‰ç±»å‹æˆå‘˜ä¸”è¯¥ç±»æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°æ—¶**

   ```c++
   class A
   {
   public:
   	A(int a) :_a(a)
   	{}
   private:
   	int _a;
   };
   class B
   {
   public:
   	B(int a, int ref) :_aobj(a), _ref(ref), _n(10)
   	{}
   private:
   	A _aobj;		// æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°
   	int& _ref;		// å¼•ç”¨
   	const int _n;	// const 
   	int _x = 1;		// è¿™é‡Œ1æ˜¯ç¼ºçœå€¼ï¼Œç¼ºçœå€¼æ˜¯ç»™åˆå§‹åŒ–åˆ—è¡¨çš„
   };
   int main() {
   	int ref = 1;
   	B b(10, ref);
   	return 0;
   }
   ```

3. å°½é‡ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–ï¼Œå› ä¸ºä¸ç®¡ä½ æ˜¯å¦ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼Œå¯¹äºè‡ªå®šä¹‰ç±»å‹æˆå‘˜å˜é‡ï¼Œä¸€å®šä¼šå…ˆä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–ã€‚

4. æˆå‘˜å˜é‡åœ¨ç±»ä¸­**å£°æ˜æ¬¡åº**å°±æ˜¯å…¶åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„**åˆå§‹åŒ–é¡ºåº**ï¼Œ**ä¸å…¶åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„å…ˆåæ¬¡åºæ— å…³**ã€‚

   ```c++
   #include<iostream>
   using namespace std;
   class A
   {
   public:
   	A(int a) :_a1(a), _a2(_a1)
   	{}
   	void Print()
   	{
   		cout << _a1 << " " << _a2 << endl;
   	}
   private:
   	int _a2;
   	int _a1;
   };
   int main()
   {
   	A aa(1);	//1 -858993460
   	aa.Print();
   }
   ```

### explicitå…³é”®å­—

æ„é€ å‡½æ•°ä¸ä»…å¯ä»¥æ„é€ ä¸åˆå§‹åŒ–å¯¹è±¡ï¼Œ**å¯¹äºæ¥æ”¶å•ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°ï¼Œè¿˜å…·æœ‰ç±»å‹è½¬æ¢çš„ä½œç”¨**ã€‚æ¥æ”¶å•ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°å…·ä½“è¡¨ç°ï¼š

1. æ„é€ å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°
2. æ„é€ å‡½æ•°æœ‰å¤šä¸ªå‚æ•°ï¼Œé™¤ç¬¬ä¸€ä¸ªå‚æ•°æ²¡æœ‰é»˜è®¤å€¼å¤–ï¼Œå…¶ä½™å‚æ•°éƒ½æœ‰é»˜è®¤å€¼
3. å…¨ç¼ºçœæ„é€ å‡½æ•°

```c++
#include<iostream>
using namespace std;
class A
{
public:
	A(int x) {
		_x = x;
	}
	A(const A& a) {
		_x = a._x;
		cout << "copy" << endl;
	}
	A& operator=(const A&a) {
		if (this != &a) {
			_x = a._x;
		}
		cout << "operator=" << endl;
		return *this;
	}
private:
	int _x;
};
int main() {
	A a1 = 1;//éšå¼ç±»å‹è½¬æ¢ï¼Œæ•´å½¢è½¬æ¢æˆè‡ªå®šä¹‰ç±»å‹
	//1æ„é€ ä¸€ä¸ªAçš„ä¸´æ—¶å¯¹è±¡ï¼Œä¸´æ—¶å¯¹è±¡å†æ‹·è´æ„é€ a1
	//ä½†æ˜¯è¿™é‡Œä¸ºä»€ä¹ˆæ²¡æœ‰è¿›å…¥æ‹·è´æ„é€ å‘¢ï¼Ÿå› ä¸ºç¼–è¯‘å™¨è‡ªåŠ¨ä¼˜åŒ–äº†ï¼Œç›´æ¥ç”¨1å»æ„é€ a1

	A a2(1);
	a2 = 2;//éšå¼ç±»å‹è½¬æ¢ï¼Œæ•´å½¢è½¬æ¢æˆè‡ªå®šä¹‰ç±»å‹
	//2æ„é€ ä¸€ä¸ªAçš„ä¸´æ—¶å¯¹è±¡ï¼Œä¸´æ—¶å¯¹è±¡å†èµ‹å€¼ç»™a2

	//A& a3 = 3;//error:â€œåˆå§‹åŒ–â€: æ— æ³•ä»â€œintâ€è½¬æ¢ä¸ºâ€œA &â€
	const A& a3 = 3;	//ä¸´æ—¶å˜é‡å…·æœ‰å¸¸æ€§

	return 0;
}
```

**ç”¨explicitä¿®é¥°æ„é€ å‡½æ•°ï¼Œå°†ä¼šç¦æ­¢æ„é€ å‡½æ•°çš„éšå¼è½¬æ¢ã€‚**

```c++
#include<iostream>
using namespace std;
class A
{
public:
	explicit A(int x, int y = 0, int z = 0) :_x(x), _y(y), _z(z)
	{}
private:
	int _x;
	int _y;
	int _z;
};
int main() {
	A a1 = 1;//error:ä¸å­˜åœ¨ä»"int"è½¬æ¢åˆ°"A"çš„é€‚å½“æ„é€ å‡½æ•°
	return 0;
}
```

## staticæˆå‘˜

### æ¦‚å¿µ

å£°æ˜ä¸ºstaticçš„ç±»æˆå‘˜ç§°ä¸º**ç±»çš„é™æ€æˆå‘˜**ï¼Œç”¨staticä¿®é¥°çš„æˆå‘˜å˜é‡ï¼Œç§°ä¹‹ä¸º**é™æ€æˆå‘˜å˜é‡**ï¼›ç”¨staticä¿®é¥°çš„ æˆå‘˜å‡½æ•°ï¼Œç§°ä¹‹ä¸º**é™æ€æˆå‘˜å‡½**æ•°ã€‚**é™æ€æˆå‘˜å˜é‡ä¸€å®šè¦åœ¨ç±»å¤–è¿›è¡Œåˆå§‹åŒ–**ã€‚

```c++
//é¢è¯•é¢˜
#include<iostream>
using namespace std;
class A
{
public:
	A() { ++_scount; }
	A(const A& t) { ++_scount; }
	~A() { --_scount; }
	static int GetACount() { return _scount; }
private:
	static int _scount;
};
int A::_scount = 0;
void TestA()
{
	static A a2;
	cout << __LINE__ << " " << A::GetACount() << endl;

}
int main() {
	A a1;
	cout << __LINE__ << " " << A::GetACount() << endl;//1	
	TestA();//2
	TestA();//2
	return 0;
}
```

### ç‰¹æ€§

1. **é™æ€æˆå‘˜ä¸ºæ‰€æœ‰ç±»å¯¹è±¡æ‰€å…±äº«**ï¼Œä¸å±äºæŸä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œå­˜æ”¾åœ¨é™æ€åŒº
2. **é™æ€æˆå‘˜å˜é‡å¿…é¡»åœ¨ç±»å¤–å®šä¹‰**ï¼Œå®šä¹‰æ—¶ä¸æ·»åŠ staticå…³é”®å­—ï¼Œç±»ä¸­åªæ˜¯å£°æ˜
3. ç±»é™æ€æˆå‘˜å³å¯ç”¨ **ç±»å::é™æ€æˆå‘˜** ã€**å¯¹è±¡.é™æ€æˆå‘˜** æˆ–è€… **ç±»å(æ„é€ å‡½æ•°å‚æ•°).é™æ€æˆå‘˜** æ¥è®¿é—®
4. é™æ€æˆå‘˜å‡½æ•°**æ²¡æœ‰**éšè—çš„**thisæŒ‡é’ˆ**ï¼Œä¸èƒ½è®¿é—®ä»»ä½•éé™æ€æˆå‘˜
5. é™æ€æˆå‘˜ä¹Ÿæ˜¯ç±»çš„æˆå‘˜ï¼Œå—publicã€protectedã€private è®¿é—®é™å®šç¬¦çš„é™åˆ¶

> **ã€é—®é¢˜ã€‘**
>
> 1. é™æ€æˆå‘˜å‡½æ•°å¯ä»¥è°ƒç”¨éé™æ€æˆå‘˜å‡½æ•°å—ï¼Ÿ
>    ä¸å¯ä»¥ï¼Œå› ä¸ºé™æ€æˆå‘˜å‡½æ•°æ˜¯æ²¡æœ‰thisæŒ‡é’ˆçš„ï¼Œæ— æ³•è°ƒç”¨éé™æ€æˆå‘˜å‡½æ•°ã€‚
> 2. éé™æ€æˆå‘˜å‡½æ•°å¯ä»¥è°ƒç”¨ç±»çš„é™æ€æˆå‘˜å‡½æ•°å—ï¼Ÿ
>    å¯ä»¥ï¼Œå› ä¸ºé™æ€æˆå‘˜ä¸ºæ‰€æœ‰ç±»å¯¹è±¡æ‰€å…±äº«ï¼Œä¸å—è®¿é—®é™åˆ¶

**OJç»ƒä¹ ï¼š**

æ±‚1+2+3+...+nï¼Œè¦æ±‚ä¸èƒ½ä½¿ç”¨ä¹˜é™¤æ³•ã€forã€whileã€ifã€elseã€switchã€caseç­‰å…³é”®å­—åŠæ¡ä»¶åˆ¤æ–­è¯­å¥ï¼ˆA?B:Cï¼‰ã€‚

```c++
class A{
public:
    A(){
        ++_k;
        _ret += _k;
    }
    static int Sum(){
        return _ret;
    }
private:
    static int _k;
    static int _ret;
};
int A::_k = 0;
int A::_ret = 0;
class Solution {
public:
    int Sum_Solution(int n) {
        A a[n];
        return A::Sum();
    }
};
```

## å‹å…ƒ

å‹å…ƒæä¾›äº†ä¸€ç§çªç ´å°è£…çš„æ–¹å¼ï¼Œæœ‰æ—¶æä¾›äº†ä¾¿åˆ©ã€‚ä½†æ˜¯å‹å…ƒä¼šå¢åŠ è€¦åˆåº¦ï¼Œç ´åäº†å°è£…ï¼Œæ‰€ä»¥å‹å…ƒä¸å®œå¤šç”¨ã€‚ 

å‹å…ƒåˆ†ä¸ºï¼š**å‹å…ƒå‡½æ•°**å’Œ**å‹å…ƒç±»**

### å‹å…ƒå‡½æ•°

é—®é¢˜ï¼šå¦‚æœå°è¯•å»é‡è½½operator<<ï¼Œä¼šå‘ç°operator<<å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éšå«çš„thisæŒ‡é’ˆè€Œä¸æ˜¯coutçš„è¾“å‡ºæµå¯¹è±¡ï¼Œä¼šå¯¼è‡´æ²¡æ³•æ­£å¸¸ä½¿ç”¨coutï¼ˆd<<coutï¼Œå³d.operator<<(&d, cout)ï¼‰ï¼Œå¦‚æœå°†operator<<å®šä¹‰ä¸ºå…¨å±€å‡½æ•°åˆä¼šä½¿å¾—å‡½æ•°æ— æ³•è®¿é—®ç±»ä¸­çš„ç§æœ‰æˆå‘˜ï¼Œè¿™æ—¶å€™å°±éœ€è¦å‹å…ƒå‡½æ•°ã€‚

å‹å…ƒå‡½æ•°å¯ä»¥**ç›´æ¥è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜**ï¼Œå®ƒæ˜¯**å®šä¹‰åœ¨ç±»å¤–éƒ¨çš„æ™®é€šå‡½æ•°**ï¼Œä¸å±äºä»»ä½•ç±»ï¼Œä½†éœ€è¦**åœ¨ç±»çš„å†…éƒ¨å£°æ˜**ï¼Œå£°æ˜æ—¶éœ€è¦åŠ **friend**å…³é”®å­—ã€‚

```c++
class Date
{
     friend ostream& operator<<(ostream& _cout, const Date& d);
     friend istream& operator>>(istream& _cin, Date& d);
public:
    Date(int year = 1900, int month = 1, int day = 1)
        : _year(year), _month(month), _day(day)
        {}
private:
    int _year;
    int _month;
    int _day;
};
ostream& operator<<(ostream& _cout, const Date& d)
{
     _cout << d._year << "-" << d._month << "-" << d._day;
     return _cout;
}
istream& operator>>(istream& _cin, Date& d)
{
     _cin >> d._year;
     _cin >> d._month;
     _cin >> d._day;
     return _cin;
}
int main()
{
     Date d;
     cin >> d;
     cout << d << endl;
     return 0;
}
```

> **è¯´æ˜:** 
>
> 1. å‹å…ƒå‡½æ•°**å¯è®¿é—®ç±»çš„ç§æœ‰å’Œä¿æŠ¤æˆå‘˜**ï¼Œä½†**ä¸æ˜¯ç±»çš„æˆå‘˜å‡½æ•°**
> 2. å‹å…ƒå‡½æ•°**ä¸èƒ½ç”¨constä¿®é¥°**
> 3. å‹å…ƒå‡½æ•°å¯ä»¥**åœ¨ç±»å®šä¹‰çš„ä»»ä½•åœ°æ–¹å£°æ˜**ï¼Œ**ä¸å—ç±»è®¿é—®é™å®šç¬¦é™åˆ¶**
> 4. ä¸€ä¸ªå‡½æ•°å¯ä»¥æ˜¯å¤šä¸ªç±»çš„å‹å…ƒå‡½æ•°
> 5. å‹å…ƒå‡½æ•°çš„è°ƒç”¨ä¸æ™®é€šå‡½æ•°çš„è°ƒç”¨åŸç†ç›¸åŒ

### å‹å…ƒç±»

å‹å…ƒç±»çš„æ‰€æœ‰æˆå‘˜å‡½æ•°éƒ½å¯ä»¥æ˜¯å¦ä¸€ä¸ªç±»çš„å‹å…ƒå‡½æ•°ï¼Œéƒ½å¯ä»¥è®¿é—®å¦ä¸€ä¸ªç±»ä¸­çš„éå…¬æœ‰æˆå‘˜ã€‚

1. å‹å…ƒå…³ç³»æ˜¯å•å‘çš„ï¼Œä¸å…·æœ‰äº¤æ¢æ€§ã€‚
   æ¯”å¦‚Timeç±»å’ŒDateç±»ï¼Œåœ¨Timeç±»ä¸­å£°æ˜Dateç±»ä¸ºå…¶å‹å…ƒç±»ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨Dateç±»ä¸­ç›´æ¥è®¿é—®Time ç±»çš„ç§æœ‰æˆå‘˜å˜é‡ï¼Œä½†æƒ³åœ¨Timeç±»ä¸­è®¿é—®Dateç±»ä¸­ç§æœ‰çš„æˆå‘˜å˜é‡åˆ™ä¸è¡Œã€‚
2. å‹å…ƒå…³ç³»ä¸èƒ½ä¼ é€’
   å¦‚æœBæ˜¯Açš„å‹å…ƒï¼ŒCæ˜¯Bçš„å‹å…ƒï¼Œåˆ™ä¸èƒ½è¯´æ˜Cæ—¶Açš„å‹å…ƒã€‚
3. å‹å…ƒå…³ç³»ä¸èƒ½ç»§æ‰¿ï¼Œåœ¨ç»§æ‰¿ä½ç½®å†è¯¦ç»†ä»‹ç»ã€‚

```c++
class Time
{
	friend class Date; // å£°æ˜æ—¥æœŸç±»ä¸ºæ—¶é—´ç±»çš„å‹å…ƒç±»ï¼Œåˆ™åœ¨æ—¥æœŸç±»ä¸­å°±ç›´æ¥è®¿é—®Timeç±»ä¸­çš„ç§æœ‰æˆå‘˜å˜é‡
public:
	Time(int hour = 0, int minute = 0, int second = 0)
		: _hour(hour)
		, _minute(minute)
		, _second(second)
	{}
private:
	int _hour;
	int _minute;
	int _second;
};
class Date
{
public:
	Date(int year = 1900, int month = 1, int day = 1)
		: _year(year)
		, _month(month)
		, _day(day)
	{}
	void SetTimeOfDate(int hour, int minute, int second)
	{
		// ç›´æ¥è®¿é—®æ—¶é—´ç±»ç§æœ‰çš„æˆå‘˜å˜é‡
		_t._hour = hour;
		_t._minute = minute;
		_t._second = second;
	}
private:
	int _year;
	int _month;
	int _day;
	Time _t;
};
```

## å†…éƒ¨ç±»

æ¦‚å¿µï¼š**å¦‚æœä¸€ä¸ªç±»å®šä¹‰åœ¨å¦ä¸€ä¸ªç±»çš„å†…éƒ¨**ï¼Œè¿™ä¸ªå†…éƒ¨ç±»å°±å«åšå†…éƒ¨ç±»ã€‚å†…éƒ¨ç±»æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç±»ï¼Œå®ƒä¸å±äºå¤–éƒ¨ç±»ï¼Œæ›´ä¸èƒ½é€šè¿‡å¤–éƒ¨ç±»çš„å¯¹è±¡å»è®¿é—®å†…éƒ¨ç±»çš„æˆå‘˜ã€‚å¤–éƒ¨ç±»å¯¹å†…éƒ¨ç±»æ²¡æœ‰ä»»ä½•ä¼˜è¶Šçš„è®¿é—®æƒé™ã€‚

æ³¨æ„ï¼šå†…éƒ¨ç±»å°±æ˜¯å¤–éƒ¨ç±»çš„å‹å…ƒç±»ï¼Œå‚è§å‹å…ƒç±»çš„å®šä¹‰ï¼Œ**å†…éƒ¨ç±»å¯ä»¥é€šè¿‡å¤–éƒ¨ç±»çš„å¯¹è±¡å‚æ•°æ¥è®¿é—®å¤–éƒ¨ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜**ï¼Œ**ä½†æ˜¯å¤–éƒ¨ç±»ä¸æ˜¯å†…éƒ¨ç±»çš„å‹å…ƒ**ã€‚

> ç‰¹æ€§ï¼š
>
> 1. å†…éƒ¨ç±»å¯ä»¥å®šä¹‰åœ¨å¤–éƒ¨ç±»çš„publicã€protectedã€privateéƒ½æ˜¯å¯ä»¥çš„ã€‚å†…éƒ¨ç±»å—å¤–éƒ¨ç±»è®¿é—®é™å®šç¬¦çš„é™åˆ¶ã€‚
> 2. æ³¨æ„å†…éƒ¨ç±»å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»ä¸­çš„staticæˆå‘˜ï¼Œä¸éœ€è¦å¤–éƒ¨ç±»çš„å¯¹è±¡/ç±»åã€‚
> 3. sizeof(å¤–éƒ¨ç±») = å¤–éƒ¨ç±»ï¼Œå’Œå†…éƒ¨ç±»æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚

```c++
#include<iostream>
using namespace std;
class A
{
public:
    class B
    {
    public:
        void func(const A& a)
        {
            cout << _k << endl;//OK
            cout << a._h << endl;//OK
        }
    private:
        int _b;
    };
private:
    static int _k;
    int _h;
    class C
    {
    public:
        void func() 
        {}
    private:
        int _c;
    };
};
int A::_k = 1;
int main()
{
    cout << sizeof(A) << endl;  //4
    //å¤–éƒ¨ç±»çš„å¤§å°ä¸å†…éƒ¨ç±»å’Œé™æ€æˆå‘˜å˜é‡æ— å…³

    A::B b;
    A::C c; //æ— æ³•è®¿é—®ç§æœ‰Cç±»
    return 0;
}
```

## åŒ¿åå¯¹è±¡

```c++
class A
{
public:
	A(int a = 0) :_a(a)
	{
		cout << "construct" << endl;
	}
	~A()
	{
		cout << "destruct" << endl;
	}
private:
	int _a;
};
class B 
{
public:
	B(int x) :_x(x)
	{}
	static int Func(int n) {
		cout << "Func" << endl;
		return n;
	}
private:
	int _x;
};
int main()
{
	A aa(1);  // æœ‰åå¯¹è±¡ -- ç”Ÿå‘½å‘¨æœŸåœ¨å½“å‰å‡½æ•°å±€éƒ¨åŸŸ
	A(2);     // åŒ¿åå¯¹è±¡ -- ç”Ÿå‘½å‘¨æœŸåœ¨å½“å‰è¡Œ

	//A& ra = A(1);		// error:åŒ¿åå¯¹è±¡å…·æœ‰å¸¸æ€§ï¼Œè¿™æ ·å®šä¹‰æƒé™æ”¾å¤§
	const A& ra = A(1); // constå¼•ç”¨å»¶é•¿åŒ¿åå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç”Ÿå‘½å‘¨æœŸåœ¨å½“å‰å‡½æ•°å±€éƒ¨åŸŸ

	//è®¿é—®æˆå‘˜å‡½æ•°çš„æ–¹å¼
	B b1(1);
	b1.Func(10);
	B(1).Func(20);	//ä½¿ç”¨åŒ¿åå¯¹è±¡è°ƒç”¨æˆå‘˜å‡½æ•°
	B::Func(30);	//ä»…é™staticæˆå‘˜å‡½æ•°
	return 0;
}
```

## æ‹·è´å¯¹è±¡æ—¶ç¼–è¯‘å™¨çš„ä¸€äº›ä¼˜åŒ–

- **ç¼–è¯‘å™¨å¯¹è¿”å›å€¼çš„ä¼˜åŒ–**

```c++
A Func1() {
	A temp(1);
	return temp;
}
void Test1(){
    A a1 = Func1();
	// ä¼˜åŒ–å‰ï¼šæ„é€ temp + æ‹·è´æ„é€ ä¸´æ—¶å˜é‡ç”¨æ¥è¿”å› + æ‹·è´æ„é€ a1
	// ä¼˜åŒ–åï¼šæ„é€ a1
	A a2;
	a2 = Func1();
	// ä¼˜åŒ–å‰ï¼šæ„é€ a2 + æ„é€ temp + æ‹·è´æ„é€ ä¸´æ—¶å˜é‡ç”¨æ¥è¿”å› + èµ‹å€¼a2
	// ä¼˜åŒ–åï¼šæ„é€ a2 + æ„é€ temp + èµ‹å€¼a2
}
```

- **åŒ¿åå¯¹è±¡ä¼ å‚æ—¶çš„ä¼˜åŒ–å†™æ³•**

```c++
void Func2(A a) {

}
void Test2(){
    //æ™®é€šä¼ å‚ï¼šæ„é€ a3 + æ‹·è´æ„é€ å½¢å‚a
	A a3(10);
	Func2(a3);

	// ä½¿ç”¨åŒ¿åå¯¹è±¡ä¼ å‚
	Func2(A(10));
	Func2(10);
	// ä¼˜åŒ–å‰ï¼šæ„é€ åŒ¿åå¯¹è±¡ + æ‹·è´æ„é€ å½¢å‚a
	// ä¼˜åŒ–åï¼šæ„é€ å½¢å‚a
}
```

# C/C++å†…å­˜ç®¡ç†

## C/C++å†…å­˜åˆ†å¸ƒ

1. æ ˆåˆå«å †æ ˆï¼š**éé™æ€å±€éƒ¨å˜é‡/å‡½æ•°å‚æ•°/è¿”å›å€¼**ç­‰ç­‰ï¼Œæ ˆæ˜¯å‘ä¸‹å¢é•¿çš„ã€‚
2. å†…å­˜æ˜ å°„æ®µæ˜¯é«˜æ•ˆçš„I/Oæ˜ å°„æ–¹å¼ï¼Œç”¨äºè£…è½½ä¸€ä¸ªå…±äº«çš„åŠ¨æ€å†…å­˜åº“ã€‚ç”¨æˆ·å¯ä½¿ç”¨ç³»ç»Ÿæ¥å£åˆ›å»ºå…±äº«å…± äº«å†…å­˜ï¼Œåšè¿›ç¨‹é—´é€šä¿¡ã€‚
3. å †ç”¨äºç¨‹åºè¿è¡Œæ—¶**åŠ¨æ€å†…å­˜åˆ†é…**ï¼Œå †æ˜¯å¯ä»¥ä¸Šå¢é•¿çš„ã€‚
4. æ•°æ®æ®µï¼ˆé™æ€åŒºï¼‰ï¼šå­˜å‚¨**å…¨å±€æ•°æ®**å’Œ**é™æ€æ•°æ®**ã€‚
5. ä»£ç æ®µï¼ˆå¸¸é‡åŒºï¼‰ï¼šå­˜å‚¨**å¯æ‰§è¡Œä»£ç **å’Œ**åªè¯»å¸¸é‡**ã€‚

```c++
int globalVar = 1;					//å…¨å±€å˜é‡ï¼Œå­˜æ”¾åœ¨é™æ€åŒº
static int staticGlobalVar = 1;		//é™æ€å…¨å±€å˜é‡ï¼Œå­˜æ”¾åœ¨é™æ€åŒº
void Test()
{
	static int staticVar = 1;		//é™æ€å±€éƒ¨å˜é‡ï¼Œå­˜æ”¾åœ¨é™æ€åŒº
	int localVar = 1;				//éé™æ€å±€éƒ¨å˜é‡ï¼Œå­˜æ”¾åœ¨æ ˆåŒº
	int num1[10] = { 1, 2, 3, 4 };	//éé™æ€å±€éƒ¨å˜é‡ï¼Œå­˜æ”¾åœ¨æ ˆåŒº
	char char2[] = "abcd";
	//char2ä¸ºæ•°ç»„ï¼Œå­˜æ”¾åœ¨æ ˆåŒºï¼Œchar2ä¸­å­˜æ”¾çš„æ˜¯åªè¯»å¸¸é‡"abcd\0"çš„æ‹·è´
	//åªè¯»å¸¸é‡"abcd\0"å­˜æ”¾åœ¨ä»£ç æ®µ
	const char* pChar3 = "abcd";
	//pCharä¸ºæŒ‡é’ˆï¼Œå­˜æ”¾åœ¨æ ˆåŒºï¼ŒpCharä¸­å­˜æ”¾çš„æ˜¯åªè¯»å¸¸é‡"abcd\0"çš„åœ°å€
	//åªè¯»å¸¸é‡"abcd\0"å­˜æ”¾åœ¨ä»£ç æ®µ
	int* ptr1 = (int*)malloc(sizeof(int) * 4);
	//ptr1ä¸ºæŒ‡é’ˆï¼Œå­˜æ”¾åœ¨æ ˆåŒºï¼Œptr1ä¸­å­˜æ”¾çš„æ˜¯æ•°ç»„çš„åœ°å€
	//*ptr1æ˜¯æœ‰4ä¸ªintå‹çš„æ•°ç»„ï¼Œå†…å­˜ç©ºé—´åœ¨å †åŒº
	int* ptr2 = (int*)calloc(4, sizeof(int));
	//åŒptr1
	int* ptr3 = (int*)realloc(ptr2, sizeof(int) * 4);
	//ä¸ptr1ç±»ä¼¼
	free(ptr1);
	//æ²¡æœ‰free(ptr2)çš„åŸå› æ˜¯reallocå¼€è¾Ÿç©ºé—´çš„æ–¹å¼
	//	1. ä¼šåœ¨åŸç©ºé—´åè¿½åŠ æ–°ç©ºé—´
	//	2. å¼€è¾Ÿæ–°ç©ºé—´ï¼Œå¹¶å°†åŸç©ºé—´çš„æ•°æ®æ‹·è´åˆ°æ–°ç©ºé—´ï¼Œé”€æ¯æ‰åŸç©ºé—´
	free(ptr3);
}
sizeof(num1) = 40;
sizeof(char2) = 5; strlen(char2) = 4;
sizeof(pChar3) = 4/8; strlen(pChar3) = 5;
sizeof(ptr1) = 4/8;
sizeofä¸strlençš„åŒºåˆ«ï¼š
    sizeof()æ˜¯æ“ä½œç¬¦ï¼Œæ˜¯ç”¨æ¥è®¡ç®—å¯¹è±¡æˆ–ç±»å‹æ‰€å å†…å­˜ç©ºé—´çš„å¤§å°
    strlen()æ˜¯å‡½æ•°ï¼Œæ˜¯ç”¨æ¥è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦çš„
```

![image-20240531161526741](F:/cs/note/images/image-20240531161526741.png)

## C++å†…å­˜ç®¡ç†æ–¹å¼

Cè¯­è¨€å†…å­˜ç®¡ç†æ–¹å¼åœ¨C++ä¸­å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œä½†æœ‰äº›åœ°æ–¹å°±æ— èƒ½ä¸ºåŠ›ï¼Œè€Œä¸”ä½¿ç”¨èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œå› æ­¤C++åˆæå‡ºäº†è‡ªå·±çš„å†…å­˜ç®¡ç†æ–¹å¼ï¼šé€šè¿‡**new**å’Œ**delet**eæ“ä½œç¬¦è¿›è¡ŒåŠ¨æ€å†…å­˜ç®¡ç†ã€‚

### new/deleteæ“ä½œå†…ç½®ç±»å‹

```c++
int main() {
	// åŠ¨æ€ç”³è¯·ä¸€ä¸ªintå‹çš„ç©ºé—´
	int* ptr1 = new int;
	// åŠ¨æ€ç”³è¯·ä¸€ä¸ªintå‹çš„ç©ºé—´ï¼Œå¹¶åˆå§‹åŒ–ä¸º10
	int* ptr2 = new int(10);
	// åŠ¨æ€ç”³è¯·10ä¸ªintå‹çš„ç©ºé—´
	int* ptr3 = new int[10];
	// åŠ¨æ€ç”³è¯·10ä¸ªintå‹çš„ç©ºé—´ï¼Œå¹¶éå®Œå…¨åˆå§‹åŒ–
	int* ptr4 = new int[10] {1, 2, 3};
	
	delete ptr1;
	delete ptr2;
	delete[] ptr3;
	delete[] ptr4;
	return 0;
}
```

> æ³¨æ„ï¼šç”³è¯·å’Œé‡Šæ”¾å•ä¸ªå…ƒç´ çš„ç©ºé—´ï¼Œä½¿ç”¨newå’Œdeleteæ“ä½œç¬¦ï¼Œç”³è¯·å’Œé‡Šæ”¾è¿ç»­çš„ç©ºé—´ï¼Œä½¿ç”¨new[]å’Œ delete[]ï¼Œæ³¨æ„ï¼šåŒ¹é…èµ·æ¥ä½¿ç”¨ã€‚

### newå’Œdeleteæ“ä½œè‡ªå®šä¹‰ç±»å‹

å¯¹äºå†…ç½®ç±»å‹è€Œè¨€ï¼Œç”¨mallocå’Œnewï¼Œé™¤äº†ç”¨æ³•ä¸åŒï¼Œæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºè‡ªå®šä¹‰ç±»å‹ã€‚

```c++
class A
{
public:
	A(int a = 0, int b = 0)
		: _a(a), _b(b)
	{
		cout << "A():" << this << endl;
	}
	A(const A& aa)
		: _a(aa._a)
	{
		cout << "A(const A& aa):" << this << endl;
	}
	~A()
	{
		cout << "~A():" << this << endl;
	}
private:
	int _a;
	int _b;
};
int main()
{
	A* p1 = (A*)malloc(sizeof(A));
	A* p2 = new A(1, 1);
	free(p1);
	delete p2;

	A* p3 = (A*)malloc(sizeof(A) * 4);
	A* p4 = new A[4]{ A(1,1),A(2,2),A(3,3) };
	free(p3);
	delete[] p4;

	return 0;
}
```

**åœ¨ç”³è¯·è‡ªå®šä¹‰ç±»å‹çš„ç©ºé—´æ—¶ï¼Œnewä¼šå…ˆå¼€è¾Ÿè‡ªå®šä¹‰ç±»å‹ç©ºé—´ç„¶åè°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–å¯¹è±¡ï¼Œdeleteä¼šå…ˆè°ƒç”¨ææ„å‡½æ•°é‡Šæ”¾å¯¹è±¡ä¸­æˆå‘˜å˜é‡çš„ç©ºé—´ç„¶åé‡Šæ”¾è‡ªå®šä¹‰ç±»å‹ç©ºé—´ã€‚**

## operator newä¸operator deleteå‡½æ•°ï¼ˆé‡è¦ï¼‰

newå’Œdeleteæ˜¯ç”¨æˆ·è¿›è¡Œ**åŠ¨æ€å†…å­˜ç”³è¯·å’Œé‡Šæ”¾çš„æ“ä½œç¬¦**ï¼Œ**operator new** å’Œ**operator delete**æ˜¯ç³»ç»Ÿæä¾›çš„**å…¨å±€å‡½æ•°**ï¼Œ**newåœ¨åº•å±‚è°ƒç”¨operator newå…¨å±€å‡½æ•°æ¥ç”³è¯·ç©ºé—´**ï¼Œd**eleteåœ¨åº•å±‚é€šè¿‡operator deleteå…¨å±€ å‡½æ•°æ¥é‡Šæ”¾ç©ºé—´**ã€‚

operator newï¼šè¯¥å‡½æ•°å®é™…**é€šè¿‡mallocæ¥ç”³è¯·ç©ºé—´**ï¼Œå½“mallocç”³è¯·ç©ºé—´æˆåŠŸæ—¶ç›´æ¥è¿”å›ï¼›ç”³è¯·ç©ºé—´å¤±è´¥ï¼Œ å°è¯•æ‰§è¡Œç©ºé—´ä¸è¶³åº”å¯¹æªæ–½ï¼Œå¦‚æœåº”å¯¹æªæ–½ç”¨æˆ·è®¾ç½®äº†ï¼Œåˆ™ç»§ç»­ç”³è¯·ï¼Œå¦åˆ™æŠ›å¼‚å¸¸ã€‚
operator delete: è¯¥å‡½æ•°æœ€ç»ˆæ˜¯é€šè¿‡freeæ¥é‡Šæ”¾ç©ºé—´çš„ã€‚

operator newå’Œoperator deleteçš„æ„ä¹‰ä½“ç°åœ¨newå’Œdeleteçš„åº•å±‚åŸç†ï¼š
	**newçš„åº•å±‚åŸç†ï¼šè½¬æ¢æˆè°ƒç”¨operator newå¼€è¾Ÿç©ºé—´ï¼Œç„¶åæ„é€ å‡½æ•°åˆå§‹åŒ–å¯¹è±¡ã€‚**
	**deleteçš„åº•å±‚åŸç†ï¼šå…ˆé€šè¿‡ææ„å‡½æ•°é‡Šæ”¾å¯¹è±¡ä¸­çš„æˆå‘˜å˜é‡ï¼Œè½¬æ¢æˆè°ƒç”¨operator deleteé‡Šæ”¾å¯¹è±¡ç©ºé—´ã€‚**

## newå’Œdeleteçš„å®ç°åŸç†

### å†…ç½®ç±»å‹

å¦‚æœç”³è¯·çš„æ˜¯å†…ç½®ç±»å‹çš„ç©ºé—´ï¼Œnewå’Œmallocï¼Œdeleteå’ŒfreeåŸºæœ¬ç±»ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹æ˜¯ï¼šnew/deleteç”³è¯·å’Œé‡Šæ”¾çš„æ˜¯å•ä¸ªå…ƒç´ çš„ç©ºé—´ï¼Œnew[]å’Œdelete[]ç”³è¯·çš„æ˜¯è¿ç»­ç©ºé—´ï¼Œè€Œä¸”**newåœ¨ç”³è¯·ç©ºé—´å¤±è´¥æ—¶ä¼šæŠ›å¼‚å¸¸ï¼Œ mallocä¼šè¿”å›NULL**ã€‚

### è‡ªå®šä¹‰ç±»å‹

- newçš„åŸç†
  1. è°ƒç”¨operator newå‡½æ•°ç”³è¯·ç©ºé—´
  2. åœ¨ç”³è¯·çš„ç©ºé—´ä¸Šæ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå®Œæˆå¯¹è±¡çš„æ„é€ 
- deleteçš„åŸç†
  1. åœ¨ç©ºé—´ä¸Šæ‰§è¡Œææ„å‡½æ•°ï¼Œå®Œæˆå¯¹è±¡ä¸­èµ„æºçš„æ¸…ç†å·¥ä½œ
  2. è°ƒç”¨operator deleteå‡½æ•°é‡Šæ”¾å¯¹è±¡çš„ç©ºé—´
- new T[N]çš„åŸç†
  1. è°ƒç”¨operator new[]å‡½æ•°ï¼Œåœ¨operator new[]ä¸­å®é™…è°ƒç”¨operator newå‡½æ•°å®ŒæˆNä¸ªå¯¹è±¡ç©ºé—´çš„ç”³è¯·
  2. åœ¨ç”³è¯·çš„ç©ºé—´ä¸Šæ‰§è¡ŒNæ¬¡æ„é€ å‡½æ•°
- delete[ ]çš„åŸç†
  1. åœ¨é‡Šæ”¾çš„å¯¹è±¡ç©ºé—´ä¸Šæ‰§è¡ŒNæ¬¡ææ„å‡½æ•°ï¼Œå®ŒæˆNä¸ªå¯¹è±¡ä¸­èµ„æºçš„æ¸…ç†
  2. è°ƒç”¨operator delete[]é‡Šæ”¾ç©ºé—´ï¼Œå®é™…åœ¨operator delete[]ä¸­è°ƒç”¨operator deleteæ¥é‡Šæ”¾ç©ºé—´

ä¸¾ä¾‹ï¼š

```c++
class Stack
{
public:
	Stack(int capacity = 4) :_arr(new int[capacity] {0}), _top(0), _capacity(capacity)
	{}
	~Stack() {
		delete[] _arr;
		_top = _capacity = 0;
	}
private:
	int* _arr;
	int _top;
	int _capacity;
};
int main() {
	Stack* s = new Stack(8);

	delete s;
	return 0;
}
```

<img src="F:/cs/note/images/image-20240531221204597.png" alt="image-20240531221204597" style="zoom: 33%;" />

## å®šä½newè¡¨è¾¾å¼ï¼ˆreplacement newï¼‰ï¼ˆäº†è§£ï¼‰

å®šä½newè¡¨è¾¾å¼æ˜¯åœ¨**å·²åˆ†é…çš„åŸå§‹å†…å­˜ç©ºé—´ä¸­è°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ã€‚** 

ä½¿ç”¨æ ¼å¼ï¼š **new (place_address) type**æˆ–è€…**new (place_address) type(initializer-list)** 
place_addresså¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œinitializer-listæ˜¯ç±»å‹çš„åˆå§‹åŒ–åˆ—è¡¨

ä½¿ç”¨åœºæ™¯ï¼š å®šä½newè¡¨è¾¾å¼åœ¨å®é™…ä¸­ä¸€èˆ¬æ˜¯é…åˆ**å†…å­˜æ± **ä½¿ç”¨ã€‚å› ä¸ºå†…å­˜æ± åˆ†é…å‡ºçš„å†…å­˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥å¦‚æœæ˜¯è‡ªå®š ç±»å‹çš„å¯¹è±¡ï¼Œéœ€è¦ä½¿ç”¨newçš„å®šä¹‰è¡¨è¾¾å¼è¿›è¡Œæ˜¾ç¤ºè°ƒæ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ã€‚

```c++
class A
{
public:
	A(int a = 0)
		: _a(a)
	{
		cout << "A():" << this << endl;
	}
	~A()
	{
		cout << "~A():" << this << endl;
	}
private:
	int _a;
};
// å®šä½new/replacement new
int main()
{
	// p1ç°åœ¨æŒ‡å‘çš„åªä¸è¿‡æ˜¯ä¸Aå¯¹è±¡ç›¸åŒå¤§å°çš„ä¸€æ®µç©ºé—´ï¼Œè¿˜ä¸èƒ½ç®—æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› ä¸ºæ„é€ å‡½æ•°æ²¡æœ‰æ‰§è¡Œ
	A* p1 = (A*)malloc(sizeof(A));
	new(p1)A; // æ³¨æ„ï¼šå¦‚æœAç±»çš„æ„é€ å‡½æ•°æœ‰å‚æ•°æ—¶ï¼Œæ­¤å¤„éœ€è¦ä¼ å‚
	p1->~A();
	free(p1);

	A* p2 = (A*)operator new(sizeof(A));
	new(p2)A(10);
	p2->~A();
	operator delete(p2);
	return 0;
}
```

## å¸¸è§é¢è¯•é¢˜

### malloc/freeå’Œnew/deleteçš„åŒºåˆ«

å…±åŒç‚¹æ˜¯ï¼šéƒ½æ˜¯ä»å †ä¸Šç”³è¯·ç©ºé—´ï¼Œå¹¶ä¸”éœ€è¦ç”¨æˆ·æ‰‹åŠ¨é‡Šæ”¾ã€‚

ä¸åŒç‚¹æ˜¯ï¼š

1. mallocå’Œfreeæ˜¯å‡½æ•°ï¼Œnewå’Œdeleteæ˜¯æ“ä½œç¬¦
2. mallocç”³è¯·çš„ç©ºé—´ä¸ä¼šåˆå§‹åŒ–ï¼Œnewå¯ä»¥åˆå§‹åŒ–
3. mallocç”³è¯·ç©ºé—´æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨è®¡ç®—ç©ºé—´å¤§å°å¹¶ä¼ é€’ï¼Œnewåªéœ€åœ¨å…¶åè·Ÿä¸Šç©ºé—´çš„ç±»å‹å³å¯ï¼Œ å¦‚æœæ˜¯å¤šä¸ªå¯¹è±¡ï¼Œ[]ä¸­æŒ‡å®šå¯¹è±¡ä¸ªæ•°å³å¯
4. mallocçš„è¿”å›å€¼ä¸ºvoid*, åœ¨ä½¿ç”¨æ—¶å¿…é¡»å¼ºè½¬ï¼Œnewä¸éœ€è¦ï¼Œå› ä¸ºnewåè·Ÿçš„æ˜¯ç©ºé—´çš„ç±»å‹
5. mallocç”³è¯·ç©ºé—´å¤±è´¥æ—¶ï¼Œè¿”å›çš„æ˜¯NULLï¼Œå› æ­¤ä½¿ç”¨æ—¶å¿…é¡»åˆ¤ç©ºï¼Œnewä¸éœ€è¦ï¼Œä½†æ˜¯newéœ€è¦æ•è·å¼‚å¸¸
6. **ç”³è¯·è‡ªå®šä¹‰ç±»å‹å¯¹è±¡æ—¶ï¼Œmalloc/freeåªä¼šå¼€è¾Ÿç©ºé—´ï¼Œä¸ä¼šè°ƒç”¨æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°ï¼Œè€Œnewåœ¨ç”³è¯·ç©ºé—´åä¼šè°ƒç”¨æ„é€ å‡½æ•°å®Œæˆå¯¹è±¡çš„åˆå§‹åŒ–ï¼Œdeleteåœ¨é‡Šæ”¾ç©ºé—´å‰ä¼šè°ƒç”¨ææ„å‡½æ•°å®Œæˆç©ºé—´ä¸­èµ„æºçš„æ¸…ç†**

###  å†…å­˜æ³„æ¼

1.  ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ï¼Œå†…å­˜æ³„æ¼çš„å±å®³ï¼Ÿ
   ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ï¼šå†…å­˜æ³„æ¼æŒ‡å› ä¸ºç–å¿½æˆ–é”™è¯¯é€ æˆç¨‹åºæœªèƒ½é‡Šæ”¾å·²ç»ä¸å†ä½¿ç”¨çš„å†…å­˜çš„æƒ…å†µã€‚å†…å­˜æ³„æ¼å¹¶ä¸ æ˜¯æŒ‡å†…å­˜åœ¨ç‰©ç†ä¸Šçš„æ¶ˆå¤±ï¼Œè€Œæ˜¯åº”ç”¨ç¨‹åºåˆ†é…æŸæ®µå†…å­˜åï¼Œå› ä¸ºè®¾è®¡é”™è¯¯ï¼Œå¤±å»äº†å¯¹è¯¥æ®µå†…å­˜çš„æ§åˆ¶ï¼Œå› è€Œé€ æˆäº†å†…å­˜çš„æµªè´¹ã€‚ 
   å†…å­˜æ³„æ¼çš„å±å®³ï¼šé•¿æœŸè¿è¡Œçš„ç¨‹åºå‡ºç°å†…å­˜æ³„æ¼ï¼Œå½±å“å¾ˆå¤§ï¼Œå¦‚æ“ä½œç³»ç»Ÿã€åå°æœåŠ¡ç­‰ç­‰ï¼Œå‡ºç°å†…å­˜æ³„æ¼ä¼šå¯¼è‡´å“åº”è¶Šæ¥è¶Šæ…¢ï¼Œæœ€ç»ˆå¡æ­»ã€‚

   ```c++
   void MemoryLeaks()
   {
   	// 1.å†…å­˜ç”³è¯·äº†å¿˜è®°é‡Šæ”¾
   	int* p1 = (int*)malloc(sizeof(int));
   	int* p2 = new int;
   	// 2.å¼‚å¸¸å®‰å…¨é—®é¢˜
   	int* p3 = new int[10];
   	Func(); // è¿™é‡ŒFuncå‡½æ•°æŠ›å¼‚å¸¸å¯¼è‡´ delete[] p3æœªæ‰§è¡Œï¼Œp3æ²¡è¢«é‡Šæ”¾.
   	delete[] p3;
   }
   ```

2.  å†…å­˜æ³„æ¼åˆ†ç±»ï¼ˆäº†è§£ï¼‰

   - **å †å†…å­˜æ³„æ¼(Heap leak)**
     å †å†…å­˜æŒ‡çš„æ˜¯ç¨‹åºæ‰§è¡Œä¸­ä¾æ®é¡»è¦åˆ†é…é€šè¿‡malloc / calloc / realloc / newç­‰ä»å †ä¸­åˆ†é…çš„ä¸€å—å†…å­˜ï¼Œ ç”¨å®Œåå¿…é¡»é€šè¿‡è°ƒç”¨ç›¸åº”çš„ freeæˆ–è€…delete åˆ æ‰ã€‚å‡è®¾ç¨‹åºçš„è®¾è®¡é”™è¯¯å¯¼è‡´è¿™éƒ¨åˆ†å†…å­˜æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œé‚£ ä¹ˆä»¥åè¿™éƒ¨åˆ†ç©ºé—´å°†æ— æ³•å†è¢«ä½¿ç”¨ï¼Œå°±ä¼šäº§ç”ŸHeap Leakã€‚
   - **ç³»ç»Ÿèµ„æºæ³„æ¼**
     æŒ‡ç¨‹åºä½¿ç”¨ç³»ç»Ÿåˆ†é…çš„èµ„æºï¼Œæ¯”æ–¹å¥—æ¥å­—ã€æ–‡ä»¶æè¿°ç¬¦ã€ç®¡é“ç­‰æ²¡æœ‰ä½¿ç”¨å¯¹åº”çš„å‡½æ•°é‡Šæ”¾æ‰ï¼Œå¯¼è‡´ç³»ç»Ÿ èµ„æºçš„æµªè´¹ï¼Œä¸¥é‡å¯å¯¼è‡´ç³»ç»Ÿæ•ˆèƒ½å‡å°‘ï¼Œç³»ç»Ÿæ‰§è¡Œä¸ç¨³å®šã€‚

3.  å¦‚ä½•æ£€æµ‹å†…å­˜æ³„æ¼ï¼ˆäº†è§£ï¼‰
   åœ¨vsä¸‹ï¼Œå¯ä»¥ä½¿ç”¨windowsæ“ä½œç³»ç»Ÿæä¾›çš„**_CrtDumpMemoryLeaks()** å‡½æ•°è¿›è¡Œç®€å•æ£€æµ‹ï¼Œè¯¥å‡½æ•°åªæŠ¥å‡º äº†å¤§æ¦‚æ³„æ¼äº†å¤šå°‘ä¸ªå­—èŠ‚ï¼Œæ²¡æœ‰å…¶ä»–æ›´å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

   ```c++
   int main()
   {
       int* p = new int[10];
       // å°†è¯¥å‡½æ•°æ”¾åœ¨mainå‡½æ•°ä¹‹åï¼Œæ¯æ¬¡ç¨‹åºé€€å‡ºçš„æ—¶å€™å°±ä¼šæ£€æµ‹æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼
       _CrtDumpMemoryLeaks();
       return 0;
   }
   ////////////////////////////////////////////////////////
   // ç¨‹åºé€€å‡ºåï¼Œåœ¨è¾“å‡ºçª—å£ä¸­å¯ä»¥æ£€æµ‹åˆ°æ³„æ¼äº†å¤šå°‘å­—èŠ‚ï¼Œä½†æ˜¯æ²¡æœ‰å…·ä½“çš„ä½ç½®
   Detected memory leaks!
   Dumping objects ->
   {79} normal block at 0x00EC5FB8, 40 bytes long.
   Data: < > CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD
   Object dump complete.
   ```

4. å¦‚ä½•é¿å…å†…å­˜æ³„æ¼
   å†…å­˜æ³„æ¼éå¸¸å¸¸è§ï¼Œè§£å†³æ–¹æ¡ˆåˆ†ä¸ºä¸¤ç§ï¼š1ã€äº‹å‰é¢„é˜²å‹ã€‚å¦‚æ™ºèƒ½æŒ‡é’ˆç­‰ã€‚2ã€äº‹åæŸ¥é”™å‹ã€‚å¦‚æ³„æ¼æ£€æµ‹å·¥å…·ã€‚

# æ¨¡æ¿åˆé˜¶

## æ³›å‹ç¼–ç¨‹

```c++
void Swap(int& left, int& right)
{
 int temp = left;
 left = right;
 right = temp;
}
void Swap(double& left, double& right)
{
 double temp = left;
 left = right;
 right = temp;
}
void Swap(char& left, char& right)
{
 char temp = left;
 left = right;
 right = temp;
}
......
```

ä½¿ç”¨å‡½æ•°é‡è½½è™½ç„¶å¯ä»¥å®ç°ï¼Œä½†æ˜¯æœ‰ä¸€ä¸‹å‡ ä¸ªä¸å¥½çš„åœ°æ–¹ï¼š 

1. é‡è½½çš„å‡½æ•°ä»…ä»…æ˜¯ç±»å‹ä¸åŒï¼Œä»£ç å¤ç”¨ç‡æ¯”è¾ƒä½ï¼Œåªè¦æœ‰æ–°ç±»å‹å‡ºç°æ—¶ï¼Œå°±éœ€è¦ç”¨æˆ·è‡ªå·±å¢åŠ å¯¹åº”çš„å‡½ æ•°
2. ä»£ç çš„å¯ç»´æŠ¤æ€§æ¯”è¾ƒä½ï¼Œä¸€ä¸ªå‡ºé”™å¯èƒ½æ‰€æœ‰çš„é‡è½½å‡å‡ºé”™

é‚£èƒ½å¦å‘Šè¯‰ç¼–è¯‘å™¨ä¸€ä¸ªæ¨¡å­ï¼Œè®©ç¼–è¯‘å™¨æ ¹æ®ä¸åŒçš„ç±»å‹åˆ©ç”¨è¯¥æ¨¡å­æ¥ç”Ÿæˆä»£ç å‘¢ï¼Ÿ
è¿™å°±æ˜¯**æ³›å‹ç¼–ç¨‹**ï¼Œæ³›å‹ç¼–ç¨‹æ˜¯ç¼–å†™ä¸ç±»å‹æ— å…³çš„é€šç”¨ä»£ç ï¼Œæ˜¯ä»£ç å¤ç”¨çš„ä¸€ç§æ‰‹æ®µã€‚**æ¨¡æ¿æ˜¯æ³›å‹ç¼–ç¨‹çš„åŸºç¡€**ã€‚

## å‡½æ•°æ¨¡æ¿

### æ¦‚å¿µ

å‡½æ•°æ¨¡æ¿ä»£è¡¨äº†ä¸€ä¸ªå‡½æ•°å®¶æ—ï¼Œè¯¥å‡½æ•°æ¨¡æ¿ä¸ç±»å‹æ— å…³ï¼Œåœ¨ä½¿ç”¨æ—¶è¢«å‚æ•°åŒ–ï¼Œæ ¹æ®å®å‚ç±»å‹äº§ç”Ÿå‡½æ•°çš„ç‰¹å®š ç±»å‹ç‰ˆæœ¬ã€‚

### å‡½æ•°æ¨¡æ¿æ ¼å¼

```c++
template<typename T1, typename T2,......,typename Tn>
è¿”å›å€¼ç±»å‹ å‡½æ•°å(å‚æ•°åˆ—è¡¨){}
```

```c++
template<typename T>
void Swap(T& keft, T& right) {
	T temp = left;
	left = right;
	right = left;
}
```

> **æ³¨æ„ï¼štypenameæ˜¯ç”¨æ¥å®šä¹‰æ¨¡æ¿å‚æ•°å…³é”®å­—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨class(åˆ‡è®°ï¼šä¸èƒ½ä½¿ç”¨structä»£æ›¿class)**

### å‡½æ•°æ¨¡æ¿çš„åŸç†

å‡½æ•°æ¨¡æ¿æ˜¯ä¸€ä¸ªè“å›¾ï¼Œå®ƒæœ¬èº«å¹¶ä¸æ˜¯å‡½æ•°ï¼Œæ˜¯ç¼–è¯‘å™¨ç”¨ä½¿ç”¨æ–¹å¼äº§ç”Ÿç‰¹å®šå…·ä½“ç±»å‹å‡½æ•°çš„æ¨¡å…·ã€‚æ‰€ä»¥å…¶å®æ¨¡æ¿å°±æ˜¯å°†æœ¬æ¥åº”è¯¥æˆ‘ä»¬åšçš„é‡å¤çš„äº‹æƒ…äº¤ç»™äº†ç¼–è¯‘å™¨

![image-20240601203649306](F:/cs/note/images/image-20240601203649306.png)

åœ¨ç¼–è¯‘å™¨**ç¼–è¯‘é˜¶æ®µ**ï¼Œå¯¹äºæ¨¡æ¿å‡½æ•°çš„ä½¿ç”¨ï¼Œ**ç¼–è¯‘å™¨éœ€è¦æ ¹æ®ä¼ å…¥çš„å®å‚ç±»å‹æ¥æ¨æ¼”ç”Ÿæˆå¯¹åº”ç±»å‹çš„å‡½æ•°**ä»¥ä¾›è°ƒç”¨ã€‚æ¯”å¦‚ï¼š**å½“ç”¨doubleç±»å‹ä½¿ç”¨å‡½æ•°æ¨¡æ¿æ—¶ï¼Œç¼–è¯‘å™¨é€šè¿‡å¯¹å®å‚ç±»å‹çš„æ¨æ¼”ï¼Œå°†Tç¡®å®šä¸ºdoubleç±»å‹ï¼Œç„¶åäº§ç”Ÿä¸€ä»½ä¸“é—¨å¤„ç†doubleç±»å‹çš„ä»£ç **ï¼Œå¯¹äºå­—ç¬¦ç±»å‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

### å‡½æ•°æ¨¡æ¿çš„å®ä¾‹åŒ–

**ç”¨ä¸åŒç±»å‹çš„å‚æ•°ä½¿ç”¨å‡½æ•°æ¨¡æ¿æ—¶ï¼Œç§°ä¸ºå‡½æ•°æ¨¡æ¿çš„å®ä¾‹åŒ–**ã€‚æ¨¡æ¿å‚æ•°å®ä¾‹åŒ–åˆ†ä¸ºï¼š**éšå¼å®ä¾‹åŒ–**å’Œ**æ˜¾å¼å®ä¾‹åŒ–**ã€‚

1. **éšå¼å®ä¾‹åŒ–ï¼šè®©ç¼–è¯‘å™¨æ ¹æ®å®å‚æ¨æ¼”æ¨¡æ¿å‚æ•°çš„å®é™…ç±»å‹**

   ```c++
   template<class T>
   T Add(const T& left, const T& right) {
   	return left + right;
   }
   int main(){
   	int a = 1;
   	double b = 3.14;
   	Add(a, b);	//error:æ²¡æœ‰ä¸å‚æ•°åˆ—è¡¨åŒ¹é…çš„ å‡½æ•°æ¨¡æ¿"Add"å®ä¾‹
   	//è¯¥è¯­å¥ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºåœ¨ç¼–è¯‘æœŸé—´ï¼Œå½“ç¼–è¯‘å™¨çœ‹åˆ°è¯¥å®ä¾‹åŒ–æ—¶ï¼Œéœ€è¦æ¨æ¼”å…¶å®å‚ç±»å‹
   	//é€šè¿‡å®å‚a1å°†Tæ¨æ¼”ä¸ºintï¼Œé€šè¿‡å®å‚d1å°†Tæ¨æ¼”ä¸ºdoubleç±»å‹ï¼Œä½†æ¨¡æ¿å‚æ•°åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªTï¼Œ
   	//ç¼–è¯‘å™¨æ— æ³•ç¡®å®šæ­¤å¤„åˆ°åº•è¯¥å°†Tç¡®å®šä¸ºint æˆ–è€… doubleç±»å‹è€ŒæŠ¥é”™
   	//æ³¨æ„ï¼šåœ¨æ¨¡æ¿ä¸­ï¼Œç¼–è¯‘å™¨ä¸€èˆ¬ä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢æ“ä½œï¼Œå› ä¸ºä¸€æ—¦è½¬åŒ–å‡ºé—®é¢˜ï¼Œç¼–è¯‘å™¨å°±éœ€è¦èƒŒé»‘é”…
   
   	// æ­¤æ—¶æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š1. ç”¨æˆ·è‡ªå·±æ¥å¼ºåˆ¶è½¬åŒ– 2. ä½¿ç”¨æ˜¾å¼å®ä¾‹åŒ–
   	Add(a, (int)b);//ok
   	return 0;
   }
   ```

2. **æ˜¾å¼å®ä¾‹åŒ–ï¼šåœ¨å‡½æ•°ååçš„<>ä¸­æŒ‡å®šæ¨¡æ¿å‚æ•°çš„å®é™…ç±»å‹**

   ```c++
   int main()
   {
        int a = 10;
        double b = 20.0;
   
        // æ˜¾å¼å®ä¾‹åŒ–
        Add<int>(a, b);
        return 0;
   }
   ```

   å¦‚æœç±»å‹ä¸åŒ¹é…ï¼Œç¼–è¯‘å™¨ä¼šå°è¯•è¿›è¡Œéšå¼ç±»å‹è½¬æ¢ï¼Œå¦‚æœæ— æ³•è½¬æ¢æˆåŠŸç¼–è¯‘å™¨å°†ä¼šæŠ¥é”™ã€‚

### æ¨¡æ¿å‚æ•°çš„åŒ¹é…åŸåˆ™

1. **ä¸€ä¸ªéæ¨¡æ¿å‡½æ•°å¯ä»¥å’Œä¸€ä¸ªåŒåçš„å‡½æ•°æ¨¡æ¿åŒæ—¶å­˜åœ¨ï¼Œè€Œä¸”è¯¥å‡½æ•°æ¨¡æ¿è¿˜å¯ä»¥è¢«å®ä¾‹åŒ–ä¸ºè¿™ä¸ªéæ¨¡æ¿å‡½ æ•°**

   ```c++
   // ä¸“é—¨å¤„ç†intçš„åŠ æ³•å‡½æ•°
   int Add(int left, int right)
   {
   	 return left + right;
   }
   // é€šç”¨åŠ æ³•å‡½æ•°
   template<class T>
   T Add(T left, T right)
   {
   	return left + right;
   }
   void Test()
   {
       Add(1, 2); 	 // ä¸éæ¨¡æ¿å‡½æ•°åŒ¹é…ï¼Œç¼–è¯‘å™¨ä¸éœ€è¦ç‰¹åŒ–
       Add<int>(1, 2); // è°ƒç”¨ç¼–è¯‘å™¨ç‰¹åŒ–çš„Addç‰ˆæœ¬
   }
   ```

2. **å¯¹äºéæ¨¡æ¿å‡½æ•°å’ŒåŒåå‡½æ•°æ¨¡æ¿ï¼Œå¦‚æœå…¶ä»–æ¡ä»¶éƒ½ç›¸åŒï¼Œåœ¨è°ƒåŠ¨æ—¶ä¼šä¼˜å…ˆè°ƒç”¨éæ¨¡æ¿å‡½æ•°è€Œä¸ä¼šä»è¯¥æ¨¡æ¿äº§ç”Ÿå‡ºä¸€ä¸ªå®ä¾‹ã€‚å¦‚æœæ¨¡æ¿å¯ä»¥äº§ç”Ÿä¸€ä¸ªå…·æœ‰æ›´å¥½åŒ¹é…çš„å‡½æ•°ï¼Œ é‚£ä¹ˆå°†é€‰æ‹©æ¨¡æ¿**

   ```c++
   // ä¸“é—¨å¤„ç†intçš„åŠ æ³•å‡½æ•°
   int Add(int left, int right)
   {
   	return left + right;
   }
   // é€šç”¨åŠ æ³•å‡½æ•°
   template<class T1, class T2>
   T1 Add(T1 left, T2 right)
   {
   	return left + right;
   }
   void Test()
   {
       Add(1, 2); 	 // ä¸éå‡½æ•°æ¨¡æ¿ç±»å‹å®Œå…¨åŒ¹é…ï¼Œä¸éœ€è¦å‡½æ•°æ¨¡æ¿å®ä¾‹åŒ–
       Add(1, 2.0); // æ¨¡æ¿å‡½æ•°å¯ä»¥ç”Ÿæˆæ›´åŠ åŒ¹é…çš„ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨æ ¹æ®å®å‚ç”Ÿæˆæ›´åŠ åŒ¹é…çš„Addå‡½æ•°
   }
   ```

3. **æ¨¡æ¿å‡½æ•°ä¸å…è®¸è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼Œä½†æ™®é€šå‡½æ•°å¯ä»¥è¿›è¡Œè‡ªåŠ¨ç±»å‹è½¬æ¢**

## ç±»æ¨¡æ¿

### ç±»æ¨¡æ¿çš„å®šä¹‰æ ¼å¼

```c++
template<class T1, class T2, ..., class Tn>
class ç±»æ¨¡æ¿å
{
	// ç±»å†…æˆå‘˜å®šä¹‰
}; 
```

```c++
template<class T>
class Stack
{
public:
	Stack(size_t capacity = 4) 
		:_arr(new T[capacity])
		,_size(0)
		,_capacity(capacity)
	{}

	// ä½¿ç”¨å…¥æ ˆå’Œææ„æ¼”ç¤ºï¼šåœ¨ç±»ä¸­å£°æ˜ï¼Œåœ¨ç±»å¤–å®šä¹‰ã€‚
	void Push(const T& data);
	~Stack();
private:
	T* _arr;
	size_t _size;
	size_t _capacity;
};

// æ³¨æ„ï¼šç±»æ¨¡æ¿ä¸­å‡½æ•°æ”¾åœ¨ç±»å¤–è¿›è¡Œå®šä¹‰æ—¶ï¼Œéœ€è¦åŠ æ¨¡æ¿å‚æ•°åˆ—è¡¨
template<class T>
void Stack<T>::Push(const T& data) {
	_arr[_size++] = data;
}

template<class T>
Stack<T>::~Stack() {
	if (_arr) {
		free(_arr);
		_arr = nullptr;
		_size = 0;
		_capacity = 0;
	}
}


```

### ç±»æ¨¡æ¿çš„å®ä¾‹åŒ–

ç±»æ¨¡æ¿å®ä¾‹åŒ–ä¸å‡½æ•°æ¨¡æ¿å®ä¾‹åŒ–ä¸åŒï¼Œ**ç±»æ¨¡æ¿å®ä¾‹åŒ–éœ€è¦åœ¨ç±»æ¨¡æ¿åå­—åè·Ÿ<>ï¼Œç„¶åå°†å®ä¾‹åŒ–çš„ç±»å‹æ”¾åœ¨<> ä¸­å³å¯ï¼Œç±»æ¨¡æ¿åå­—ä¸æ˜¯çœŸæ­£çš„ç±»ï¼Œè€Œå®ä¾‹åŒ–çš„ç»“æœæ‰æ˜¯çœŸæ­£çš„ç±»**ã€‚

```c++
// Stackç±»åï¼ŒStack<int>æ‰æ˜¯ç±»å‹
int main() {
	Stack<int> s1;
	Stack<double> s2;
	Stack<char> s3;
	return 0;
}
```

# string

## æ ‡å‡†åº“ä¸­çš„stringç±»

### stringç±»ä»‹ç»

![image-20240604194500247](F:/cs/note/images/image-20240604194500247.png)

1. stringæ˜¯è¡¨ç¤ºå­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²ç±»ã€‚
2. è¯¥ç±»çš„æ¥å£ä¸å¸¸è§„å®¹å™¨çš„æ¥å£åŸºæœ¬ç›¸åŒï¼Œå†æ·»åŠ äº†ä¸€äº›ä¸“é—¨ç”¨æ¥æ“ä½œstringçš„å¸¸è§„æ“ä½œã€‚
3. stringåœ¨åº•å±‚å®é™…æ˜¯ï¼šbasic_stringç±»æ¨¡æ¿çš„å®ä¾‹åŒ–çš„åˆ«åï¼Œ`typedef basic_string<char> string;` ã€‚
4. ä¸èƒ½æ“ä½œå¤šå­—èŠ‚æˆ–è€…å˜é•¿å­—ç¬¦çš„åºåˆ—ã€‚
5. åœ¨ä½¿ç”¨stringç±»æ—¶ï¼Œå¿…é¡»åŒ…å«`#include<string>`ä»¥åŠè®¿é—®stdå‘½åç©ºé—´ã€‚

### stringç±»çš„å¸¸è§æ¥å£ä½¿ç”¨

1. **stringç±»çš„æ„é€ å‡½æ•°å’Œèµ‹å€¼é‡è½½**
   ![image-20240610140601999](F:/cs/note/images/image-20240610140601999.png)
   ![image-20240610140630850](F:/cs/note/images/image-20240610140630850.png)

   ```c++
   void test1() {
   	//æ„é€ å‡½æ•°	
   	string s1;					//æ„é€ ä¸€ä¸ªç©ºå­—ç¬¦ä¸²å¯¹è±¡
   	string s2("hello world");	//ç”¨"hello world"æ„é€ 
   	string s3("hello world", 5);//ç”¨"hello world"çš„å‰5ä¸ªå­—ç¬¦æ„é€ 
   	string s4(5, 'x');			//ç”¨5ä¸ª'x'å­—ç¬¦çš„å­—ç¬¦ä¸²æ„é€ 
   	string s5(s2);				//æ‹·è´æ„é€ 
   	string s6(s2, 6, 5);		//ç”¨s2çš„ç¬¬6ä¸ªå­—ç¬¦åçš„5ä¸ªå­—ç¬¦æ„é€ 
       string s7(s2, 6);			//ç”¨s2çš„ç¬¬6ä¸ªå­—ç¬¦åçš„å…¨éƒ¨å­—ç¬¦æ„é€ 
   	//èµ‹å€¼é‡è½½
   	s1 = s2;
   	s3 = "hello world";
   	s4 = 'c';
   
   	cout << s1 << endl;	//hello world
   	cout << s2 << endl;	//hello world
   	cout << s3 << endl;	//hello world
   	cout << s4 << endl;	//c
   	cout << s5 << endl;	//hello world
   	cout << s6 << endl;	//world
   	cout << s7 << endl;	//world
   }
   ```

2. stringç±»å¯¹è±¡çš„è®¿é—®åŠéå†æ“ä½œ

   | å‡½æ•°åç§°       | åŠŸèƒ½è¯´æ˜                                   |
   | -------------- | ------------------------------------------ |
   | **operator[]** | è¿”å›posä½ç½®çš„å­—ç¬¦ï¼Œconst stringç±»å¯¹è±¡è°ƒç”¨  |
   | at()           | è¿”å›posä½ç½®çš„å­—ç¬¦ï¼Œconst stringç±»å¯¹è±¡è°ƒç”¨  |
   | **è¿­ä»£å™¨**     | **begin() + end() æˆ–è€… rbegin() + rend()** |
   | èŒƒå›´for        | C++11æ”¯æŒæ›´ç®€æ´çš„èŒƒå›´forçš„æ–°éå†æ–¹å¼       |

   **operator[]å’Œat()çš„å¯¹æ¯”**

   > ```c++
   > void test2() {
   > 	string s("abcdef");
   > 	//operator[]
   > 	for (int i = 0; i < s.size(); i++) {
   > 		s[i]++;
   > 		cout << s[i] << " ";
   > 	}
   > 	cout << endl;
   > 	//at
   > 	for (int i = 0; i < s.size(); i++) {
   > 		s.at(i)++;
   > 		cout << s.at(i) << " ";
   > 	}
   > 	cout << endl;
   > }
   > ```
   >
   > ä¸è®ºæ˜¯operator[]è¿˜æ˜¯at()éƒ½ä¿®æ”¹å­—ç¬¦ä¸²çš„å†…å®¹ï¼ŒäºŒè€…çš„åŒºåˆ«åœ¨ä¸è¶Šç•Œè®¿é—®çš„è¡Œä¸ºï¼Œ**at()è¶Šç•Œè®¿é—®ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œoperator[]è¶Šç•Œè®¿é—®ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼Œåœ¨VS2022ä¸­ä¼šå¯¼è‡´æ–­è¨€**ã€‚

   **è¿­ä»£å™¨**

   > <img src="F:/cs/note/images/image-20240605145219160.png" alt="image-20240605145219160" style="zoom: 33%;" />
   >
   > ```c++
   > void test2() {
   > 	string s("abcdef");
   > 	//è¿­ä»£å™¨
   > 	string::iterator it = s.begin();
   > 	while (it != s.end()) {
   > 		(*it)++;
   > 		cout << *it << " ";
   > 		it++;
   > 	}
   > 	cout << endl;
   > 	auto rit = s.rbegin();
   > 	while (rit != s.rend()) {
   > 		(*rit)++;
   > 		cout << *rit << " ";
   > 		rit++;
   > 	}
   > 	cout << endl;
   > }
   > ```
   >
   > è¿­ä»£å™¨è·ŸæŒ‡é’ˆå¾ˆç±»ä¼¼ï¼Œæœ‰å¯èƒ½æ˜¯æŒ‡é’ˆä¹Ÿæœ‰å¯èƒ½ä¸æ˜¯æŒ‡é’ˆã€‚ä¸€äº›ç®—æ³•åº“å‡½æ•°å¯ä»¥é€šè¿‡è¿­ä»£å™¨æ¥æ“ä½œå®¹å™¨ä¸­çš„æ•°æ®ï¼Œå¦‚reverseå’Œsortå‡½æ•°ã€‚

   èŒƒå›´for

   > ```c++
   > void test2() {
   > 	string s("abcdef");
   > 	//èŒƒå›´for
   > 	for (auto& ch : s) {
   > 		ch++;
   > 	}
   > 	for (auto ch : s) {
   > 		cout << ch << " ";
   > 	}
   > 	cout << endl;
   > }
   > ```
   >
   > èŒƒå›´forçš„åº•å±‚å®ç°è¿˜æ˜¯ã€è¿­ä»£å™¨ã€‘ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯´åœ¨å®ƒåœ¨éå†çš„æ—¶å€™ç›¸å½“äºæ˜¯å°†*itçš„æ•°æ®æ‹·è´åˆ°å½“å‰çš„chï¼Œå’Œè¿­ä»£å™¨çš„æœ¬è´¨è¿˜æ˜¯ç±»ä¼¼çš„ã€‚å¦‚æœéœ€è¦ä¿®æ”¹æ•°æ®ï¼Œéœ€è¦ç”¨åˆ°å¼•ç”¨ã€‚

3. stringç±»å¯¹è±¡çš„å¸¸è§å®¹é‡æ“ä½œ

   | å‡½æ•°åç§°    | åŠŸèƒ½è¯´æ˜                                        |
   | ----------- | ----------------------------------------------- |
   | **size**    | è¿”å›å­—ç¬¦ä¸²æœ‰æ•ˆå­—ç¬¦é•¿åº¦                          |
   | length      | è¿”å›å­—ç¬¦ä¸²æœ‰æ•ˆå­—ç¬¦é•¿åº¦                          |
   | capacity    | è¿”å›ç©ºé—´æ€»å¤§å°                                  |
   | **clear**   | æ¸…ç©ºæœ‰æ•ˆå­—ç¬¦                                    |
   | **empty**   | æ£€æµ‹å­—ç¬¦ä¸²é‡Šæ”¾ä¸ºç©ºä¸²ï¼Œæ˜¯è¿”å›trueï¼Œå¦åˆ™è¿”å›false |
   | **reserve** | ä¸ºå­—ç¬¦ä¸²é¢„ç•™ç©ºé—´                                |
   | **resize**  | å°†æœ‰æ•ˆå­—ç¬¦çš„ä¸ªæ•°æ”¹æˆnä¸ªï¼Œå¤šå‡ºçš„ç©ºé—´ç”¨å­—ç¬¦å¡«å……   |

   ```c++
   void test3() {
   	string s1("hello world");
   	cout << s1.size() << endl;		//11
   	cout << s1.length() << endl;	//11
   	cout << s1.capacity() << endl;	//15ï¼ŒVS2022é»˜è®¤é¢„ç•™16ä¸ªå­—èŠ‚ç©ºé—´ï¼Œæœ€åä¸€ä¸ªå­—èŠ‚ä¸º'\0'ä¸è®¡å…¥
   	size_t oldcapacity = s1.capacity();
   	for (size_t i = 0; i < 100; i++) {
   		s1 += 'x';
   		if (oldcapacity != s1.capacity()) {
   			cout << "æ‰©å®¹ï¼š" << s1.capacity() << endl;
   			oldcapacity = s1.capacity();
   		}
   	}
   	//æ‰©å®¹ï¼š31
   	//æ‰©å®¹ï¼š47
   	//æ‰©å®¹ï¼š70
   	//æ‰©å®¹ï¼š105
   	//æ‰©å®¹ï¼š157
   	//VS2022ä»¥1.5å€çš„å¤§å°è‡ªåŠ¨æ‰©å®¹ï¼Œä¸åŒç¼–è¯‘å™¨æ‰©å®¹è§„åˆ™ä¸ä¸€æ ·ï¼Œg++ä¸‹ä½¿ç”¨çš„STLåŸºæœ¬æ˜¯æŒ‰ç…§2å€æ–¹å¼æ‰©å®¹
   	cout << "-----------------" << endl;
   	cout << s1.size() << endl;		//111
   	cout << s1.capacity() << endl;	//157
   	s1.clear();	//clearåªä¼šæ¸…é™¤å­—ç¬¦ä¸²ä¸­çš„å†…å®¹ï¼Œä¸ä¼šé”€æ¯ç©ºé—´
   	cout << s1.size() << endl;		//0
   	cout << s1.capacity() << endl;	//157
   	if (s1.empty())
   		cout << "empty" << endl;
   
   	cout << "-----------------" << endl;
   	string s2("hi world");
   	s2.reserve(100);
   	cout << s2.size() << endl;		//8ï¼Œreserveæ— æ³•ä¿®æ”¹å­—ç¬¦ä¸²é•¿åº¦å’Œå†…å®¹
   	cout << s2.capacity() << endl;	//111ï¼Œå¹¶æ²¡æœ‰æ‰©å®¹åˆ°200ï¼Œå› ä¸ºéœ€è¦è€ƒè™‘åˆ°å†…å­˜å¯¹é½
   	s2.reserve(20);
   	cout << s2.capacity() << endl;	//111ï¼Œreserveæ— æ³•æ”¶ç¼©ç©ºé—´
   
   	cout << "-----------------" << endl;
   	string s3("hello");
   	s3.resize(100);
   	cout << s3.size() << endl;		//100ï¼Œåœ¨æœ«å°¾æ’å…¥'\0'å­—ç¬¦ä»¥è¾¾åˆ°100çš„å¤§å°
   	cout << s3.capacity() << endl;	//111
   	s3.resize(200, 'x');
   	cout << s3.size() << endl;		//200ï¼Œåœ¨æœ«å°¾æ’å…¥'x'å­—ç¬¦ä»¥è¾¾åˆ°200çš„å¤§å°
   	cout << s3.capacity() << endl;	//207
   	s3.resize(20);
   	cout << s3.size() << endl;		//20ï¼Œåˆ é™¤ç¬¬20ä¸ªå­—ç¬¦ä¹‹åçš„å­—ç¬¦
   	cout << s3.capacity() << endl;	//207ï¼Œresizeæ— æ³•æ”¶ç¼©ç©ºé—´
   }
   ```

   > æ³¨æ„ï¼š
   >
   > 1. size()ä¸length()æ–¹æ³•åº•å±‚å®ç°åŸç†å®Œå…¨ç›¸åŒï¼Œå¼•å…¥size()çš„åŸå› æ˜¯ä¸ºäº†ä¸å…¶ä»–å®¹å™¨çš„æ¥å£ä¿æŒä¸€ è‡´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åŸºæœ¬éƒ½æ˜¯ç”¨size()ã€‚
   > 2. clear()åªæ˜¯å°†stringä¸­æœ‰æ•ˆå­—ç¬¦æ¸…ç©ºï¼Œä¸æ”¹å˜åº•å±‚ç©ºé—´å¤§å°ã€‚
   > 3. `resize(size_t n)` ä¸`resize(size_t n, char c)`éƒ½æ˜¯å°†å­—ç¬¦ä¸²ä¸­æœ‰æ•ˆå­—ç¬¦ä¸ªæ•°æ”¹å˜åˆ°nä¸ªï¼Œä¸åŒçš„æ˜¯å½“å­—ç¬¦ä¸ªæ•°å¢å¤šæ—¶ï¼šresize(n)ç”¨`â€˜\0â€™`æ¥å¡«å……å¤šå‡ºçš„å…ƒç´ ç©ºé—´ï¼Œresize(size_t n, char c)ç”¨å­—ç¬¦cæ¥å¡«å……å¤šå‡ºçš„å…ƒç´ ç©ºé—´ã€‚æ³¨æ„ï¼šresizeåœ¨æ”¹å˜å…ƒç´ ä¸ªæ•°æ—¶ï¼Œå¦‚æœæ˜¯å°†å…ƒç´ ä¸ªæ•°å¢å¤šï¼Œå¯èƒ½ä¼šæ”¹å˜åº•å±‚å®¹é‡çš„å¤§å°ï¼Œå¦‚æœæ˜¯å°†å…ƒç´ ä¸ªæ•°å‡å°‘ï¼Œåº•å±‚ç©ºé—´æ€»å¤§å°ä¸å˜ã€‚
   > 4. `reserve(size_t n = 0)`ï¼šä¸ºstringé¢„ç•™ç©ºé—´ï¼Œä¸æ”¹å˜æœ‰æ•ˆå…ƒç´ ä¸ªæ•°ï¼Œå½“reserveçš„å‚æ•°å°äº stringçš„åº•å±‚ç©ºé—´æ€»å¤§å°æ—¶ï¼Œreserverä¸ä¼šæ”¹å˜å®¹é‡å¤§å°ã€‚
   > 5. å¯¹stringæ“ä½œæ—¶ï¼Œå¦‚æœèƒ½å¤Ÿå¤§æ¦‚é¢„ä¼°åˆ°æ”¾å¤šå°‘å­—ç¬¦ï¼Œå¯ä»¥å…ˆé€šè¿‡reserve/reszieæŠŠç©ºé—´é¢„ç•™å¥½ã€‚

4. stringç±»å¯¹è±¡çš„ä¿®æ”¹æ“ä½œ

   | å‡½æ•°åç§°       | åŠŸèƒ½è¯´æ˜                     |
   | -------------- | ---------------------------- |
   | push_back      | åœ¨å­—ç¬¦ä¸²åå°¾æ’å­—ç¬¦           |
   | append         | åœ¨å­—ç¬¦ä¸²åé¢è¿½åŠ å­—ç¬¦ä¸²       |
   | **operator+=** | åœ¨å­—ç¬¦ä¸²åé¢è¿½åŠ å­—ç¬¦ä¸²       |
   | insert         | åœ¨æŒ‡å®šä½ç½®æ’å…¥å­—ç¬¦æˆ–å­—ç¬¦ä¸²   |
   | assign         | ä½¿ç”¨æŒ‡å®šçš„å­—ç¬¦ä¸²æ›¿æ¢åŸå­—ç¬¦ä¸² |
   | erase          | åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„ä¸€éƒ¨åˆ†         |
   | replace        | æ›¿æ¢æŒ‡å®šåŒºé—´çš„å­—ç¬¦ä¸²         |
   | pop_back       | åˆ é™¤æœ€åä¸€ä¸ªå­—ç¬¦             |
   | swap           | äº¤æ¢å­—ç¬¦ä¸²å€¼                 |

   > æ³¨æ„ï¼šåœ¨stringå°¾éƒ¨è¿½åŠ å­—ç¬¦æ—¶ï¼Œs.push_back(c) / s.append(1, c) / s += 'c'ä¸‰ç§çš„å®ç°æ–¹å¼å·®ä¸å¤šï¼Œä¸€èˆ¬æƒ…å†µä¸‹stringç±»çš„+=æ“ä½œç”¨çš„æ¯”è¾ƒå¤šï¼Œ+=æ“ä½œä¸ä»…å¯ä»¥è¿æ¥å•ä¸ªå­—ç¬¦ï¼Œè¿˜å¯ä»¥è¿æ¥å­—ç¬¦ä¸²ã€‚ 

5. stringç±»å¯¹è±¡çš„å…¶ä»–å­—ç¬¦ä¸²æ“ä½œ

   | å‡½æ•°åç§°          | åŠŸèƒ½è¯´æ˜                                                   |
   | ----------------- | ---------------------------------------------------------- |
   | c_str             | è¿”å› Cè¯­è¨€æ ¼å¼å­—ç¬¦ä¸²                                       |
   | **substr**        | åœ¨strä¸­ä»posä½ç½®å¼€å§‹å¾€ï¼Œæˆªå–nä¸ªå­—ç¬¦ï¼Œç„¶åå°†å…¶è¿”å›          |
   | **find+npos**     | ä»å­—ç¬¦ä¸²posä½ç½®å¼€å§‹å¾€åæ‰¾å­—ç¬¦cï¼Œè¿”å›è¯¥å­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½® |
   | rfind+npos        | ä»å­—ç¬¦ä¸²posä½ç½®å¼€å§‹å¾€å‰æ‰¾å­—ç¬¦cï¼Œè¿”å›è¯¥å­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½® |
   | find_first_of     | ä»å‰å¾€åæ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦                                 |
   | find_last_of      | ä»åå¾€å‰æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦                                 |
   | find_first_not_of | ä»å‰å¾€åæ‰¾ç¬¬ä¸€ä¸ªä¸åŒ¹é…çš„å­—ç¬¦                               |
   | find_last_not_of  | ä»åå¾€å‰æ‰¾ç¬¬ä¸€ä¸ªä¸åŒ¹é…çš„å­—ç¬¦                               |

   ```c++
   //åˆ†ç¦»ç½‘ç«™çš„åè®®ã€åŸŸåå’Œèµ„æºå
   void test4() {
   	string url("https://legacy.cplusplus.com/reference/string/string/?kw=string");
   	string protocol;
   	string domain;
   	string uri;
   	size_t pos1 = url.find("://");
   	if (pos1 != string::npos) {
   		protocol = url.substr(0, pos1);
   	}
   	size_t pos2 = url.find('/', pos1 + 3);
   	if (pos2 != string::npos) {
   		domain = url.substr(pos1 + 3, pos2 - (pos1 + 3));
   		uri = url.substr(pos2 + 1);
   	}
   	cout << protocol << endl;
   	cout << domain << endl;
   	cout << uri << endl;
   }
   ```

   ```c++
   //æµ‹è¯•find_first_of
   void test5() {
   	string str("Please, replace the vowels in this sentence by asterisks.");
   	size_t pos = str.find_first_of("aeiou");
   	while (pos != string::npos)
   	{
   		str[pos] = '*';
   		pos = str.find_first_of("aeiou", pos + 1);
   	}
   	std::cout << str << endl;
   	//Pl**s*, r*pl*c* th* v*w*ls *n th*s s*nt*nc* by *st*r*sks.
   }
   ```

6. stringç±»å¯¹è±¡çš„éæˆå‘˜å‡½æ•°é‡è½½

   | å‡½æ•°åç§°                 | åŠŸèƒ½è¯´æ˜                                 |
   | ------------------------ | ---------------------------------------- |
   | operator+                | å°½é‡å°‘ç”¨ï¼Œå› ä¸ºä¼ å€¼è¿”å›ï¼Œå¯¼è‡´æ·±æ‹·è´æ•ˆç‡ä½ |
   | **relational operators** | å¤§å°æ¯”è¾ƒ                                 |
   | **operator>>**           | è¾“å…¥è¿ç®—ç¬¦é‡è½½                           |
   | **operator<<**           | è¾“å‡ºè¿ç®—ç¬¦é‡è½½                           |
   | **getline**              | è·å–ä¸€è¡Œå­—ç¬¦ä¸²                           |

7. stringç±»ä¸å…¶ä»–å†…ç½®ç±»å‹çš„è½¬æ¢
   **stringè½¬æ¢ä¸ºå†…ç½®ç±»å‹ï¼šstoiã€stolã€stoulã€stollã€stoullã€stofã€stodã€stold**
   **å†…ç½®ç±»å‹è½¬æ¢ä¸ºstringï¼što_stringã€to_wstring**

8. vså’Œg++ä¸‹stringç»“æ„çš„è¯´æ˜
   æ³¨æ„ï¼šä¸‹è¿°ç»“æ„æ˜¯åœ¨32ä½å¹³å°ä¸‹è¿›è¡ŒéªŒè¯ï¼Œ32ä½å¹³å°ä¸‹æŒ‡é’ˆå 4ä¸ªå­—èŠ‚ã€‚

   - vsä¸‹stringçš„ç»“æ„
     **stringæ€»å…±å 28ä¸ªå­—èŠ‚**ï¼Œå†…éƒ¨ç»“æ„ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå…ˆæ˜¯æœ‰ä¸€ä¸ªè”åˆä½“ï¼Œè”åˆä½“ç”¨æ¥å®šä¹‰stringä¸­å­— ç¬¦ä¸²çš„å­˜å‚¨ç©ºé—´ï¼š
     ![å¾®ä¿¡å›¾ç‰‡_20240610134348](F:/cs/note/images/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240610134348.png)
     ![å¾®ä¿¡å›¾ç‰‡_20240610134929](F:/cs/note/images/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240610134929.png)
     **å½“å­—ç¬¦ä¸²é•¿åº¦å°äº16æ—¶ï¼Œä½¿ç”¨å†…éƒ¨å›ºå®šçš„å­—ç¬¦æ•°ç»„ _Buf æ¥å­˜æ”¾**
     **å½“å­—ç¬¦ä¸²é•¿åº¦å¤§äºç­‰äº16æ—¶ï¼Œä»å †ä¸Šå¼€è¾Ÿç©ºé—´ï¼Œç”¨ _Ptr æŒ‡å‘å †ä¸Šå¼€è¾Ÿçš„ç©ºé—´**
     **stringå¯¹è±¡å¤§å°ä¸º _Buf + _Ptr + _Mysize + _Myres = 16 + 4 + 4 + 4 = 28**
   - g++ä¸‹stringçš„ç»“æ„
     g++ä¸‹ï¼Œstringæ˜¯é€šè¿‡å†™æ—¶æ‹·è´å®ç°çš„ï¼Œstringå¯¹è±¡æ€»å…±å 4ä¸ªå­—èŠ‚ï¼Œå†…éƒ¨åªåŒ…å«äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡ é’ˆå°†æ¥æŒ‡å‘ä¸€å—å †ç©ºé—´ï¼Œå†…éƒ¨åŒ…å«äº†å¦‚ä¸‹å­—æ®µï¼šç©ºé—´æ€»å¤§å°ã€å­—ç¬¦ä¸²æœ‰æ•ˆé•¿åº¦ã€å¼•ç”¨è®¡æ•°å’ŒæŒ‡å‘å †ç©ºé—´çš„æŒ‡é’ˆï¼Œç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²ã€‚

### OJç»ƒä¹ 

```c++
// ä»…ä»…åè½¬å­—æ¯ï¼šæ‰€æœ‰éè‹±æ–‡å­—æ¯ä¿ç•™åœ¨åŸæœ‰ä½ç½®ï¼Œæ‰€æœ‰è‹±æ–‡å­—æ¯ï¼ˆå°å†™æˆ–å¤§å†™ï¼‰ä½ç½®åè½¬ã€‚
// åŒæŒ‡é’ˆå·¦å³äº¤æ¢
string reverseOnlyLetters(string s) {
	int left = 0, right = s.size() - 1;
	while (left < right) {
		while (left < right && !isalpha(s[left]))
			left++;
		while (left < right && !isalpha(s[right]))
			right--;
		swap(s[left], s[right]);
		left++;
		right--;
	}
	return s;
}
// æ‰¾å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œæ‰¾åˆ°å®ƒçš„ç¬¬ä¸€ä¸ªä¸é‡å¤çš„å­—ç¬¦ï¼Œå¹¶è¿”å›å®ƒçš„ç´¢å¼•ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1ã€‚
// åˆ©ç”¨è¾…åŠ©æ•°ç»„
int firstUniqChar(string s) {
	int count[27] = { 0 };
	for (size_t i = 0; i < s.size(); i++)
		count[s[i] - 'a']++;
	for (size_t i = 0; i < s.size(); i++)
		if (1 == count[s[i] - 'a'])
			return i;
	return -1;
}

// å­—ç¬¦ä¸²é‡Œé¢æœ€åä¸€ä¸ªå•è¯çš„é•¿åº¦
// åå‘æŸ¥æ‰¾â€˜ â€™
int LastWordLength(string& s) {
	if (s.empty())
		return 0;
	int pos = s.rfind(' ');
	return s.size() - (pos + 1);

}
// éªŒè¯ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡ï¼šå¦‚æœåœ¨å°†æ‰€æœ‰å¤§å†™å­—ç¬¦è½¬æ¢ä¸ºå°å†™å­—ç¬¦ã€å¹¶ç§»é™¤æ‰€æœ‰éå­—æ¯æ•°å­—å­—ç¬¦ä¹‹åï¼ŒçŸ­è¯­æ­£ç€è¯»å’Œåç€è¯»éƒ½ä¸€æ ·ã€‚åˆ™å¯ä»¥è®¤ä¸ºè¯¥çŸ­è¯­æ˜¯ä¸€ä¸ªå›æ–‡ä¸² ã€‚
// åŒæŒ‡é’ˆå·¦å³å¯¹æ¯”
bool isPalindrome(string s) {
	for (auto& ch : s) {
		if (isupper(ch))
			ch += 32;
	}
	int left = 0, right = s.size() - 1;
	while (left < right) {
		while (left < right && !isalnum(s[left]))
			left++;
		while (left < right && !isalnum(s[right]))
			right--;
		if (s[left] != s[right])
			return false;
		left++;
		right--;
	}
	return true;
}
// å­—ç¬¦ä¸²ç›¸åŠ 
string addStrings(string num1, string num2) {
	string ret;
	int end1 = num1.size() - 1;
	int end2 = num2.size() - 1;
	int flag = 0;
	int value1 = 0, value2 = 0, valueret = 0;
	while (end1 >= 0 || end2 >= 0) {
		if (end1 >= 0)
			value1 = (num1[end1--] - '0');
		else
			value1 = 0;
		if (end2 >= 0)
			value2 = (num2[end2--] - '0');
		else
			value2 = 0;
		valueret = value1 + value2 + flag;
		if (valueret > 9) {
			flag = 1;
			valueret -= 10;
		}
		else
			flag = 0;
		ret += (valueret + '0');
	}
	if (flag == 1)
		ret += '1';
	reverse(ret.begin(), ret.end());
	return ret;
}
// ç¿»è½¬å­—ç¬¦ä¸²2: åŒºé—´éƒ¨åˆ†ç¿»è½¬ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²så’Œä¸€ä¸ªæ•´æ•°kï¼Œä»å­—ç¬¦ä¸²å¼€å¤´ç®—èµ·ï¼Œæ¯è®¡æ•°è‡³2kä¸ªå­—ç¬¦ï¼Œå°±åè½¬è¿™2kå­—ç¬¦ä¸­çš„å‰kä¸ªå­—ç¬¦ã€‚å¦‚æœå‰©ä½™å­—ç¬¦å°‘äº k ä¸ªï¼Œåˆ™å°†å‰©ä½™å­—ç¬¦å…¨éƒ¨åè½¬ã€‚å¦‚æœå‰©ä½™å­—ç¬¦å°äº 2k ä½†å¤§äºæˆ–ç­‰äº k ä¸ªï¼Œåˆ™åè½¬å‰ k ä¸ªå­—ç¬¦ï¼Œå…¶ä½™å­—ç¬¦ä¿æŒåŸæ ·ã€‚
string reverseStr(string s, int k) {
	int pos = 0, end = 0;
	while (end != s.size()) {
		if (end - pos == 2 * k) {
			reverse(s.begin() + pos, s.begin() + pos + k);
			pos = end;
		}
		end++;
	}
	if (end - pos == 2 * k || end - pos >= k) {
		reverse(s.begin() + pos, s.begin() + pos + k);
	}
	else if (end - pos < k)
		reverse(s.begin() + pos, s.end());
	return s;
}
// ç¿»è½¬å­—ç¬¦ä¸²2: ç¿»è½¬å­—ç¬¦ä¸²ä¸­çš„å•è¯
string reverseWords(string s) {
	int start = 0, pos = s.find(' ');
	while (pos != string::npos) {
		reverse(s.begin() + start, s.begin() + pos);
		start = pos + 1;
		pos = s.find(' ', start);
	}
	reverse(s.begin() + start, s.end());
	return s;
}
// å­—ç¬¦ä¸²ç›¸ä¹˜
// ä»å³å¾€å·¦éå†ä¹˜æ•°ï¼Œå°†ä¹˜æ•°çš„æ¯ä¸€ä½ä¸è¢«ä¹˜æ•°ç›¸ä¹˜å¾—åˆ°å¯¹åº”çš„ç»“æœï¼Œç»“æœå­˜å…¥æ•°ç»„ï¼Œå†å°†æ¯æ¬¡å¾—åˆ°çš„ç»“æœç´¯åŠ ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°è¾ƒå¤šå­—ç¬¦ä¸²ç›¸åŠ çš„æ“ä½œã€‚ç„¶åä»åå¾€å‰å¤„ç†è¿›ä½ã€‚
string multiply(string num1, string num2) {
	if (num1 == "0" || num2 == "0")
		return "0";
	int len1 = num1.size(), len2 = num2.size();
	vector<int> ret(len1 + len2);
	int value1, value2;
	for (int i = len2 - 1; i >= 0; i--) {
		value2 = num2[i] - '0';
		for (int j = len1 - 1; j >= 0; j--) {
			value1 = num1[j] - '0';
			ret[i + j + 1] += value1 * value2;
		}
	}
	string ans;
	for (int i = len1 + len2 - 1; i > 0; i--) {
		ret[i - 1] += ret[i] / 10;
		ret[i] %= 10;
		ans += (ret[i] + '0');
	}
	if (ret[0] != 0) {
		ans += (ret[0] + '0');
	}
	reverse(ans.begin(), ans.end());
	return ans;
}
```

## stringç±»çš„æ¨¡æ‹Ÿå®ç°

**æµ…æ‹·è´**ï¼šä¹Ÿç§°ä½æ‹·è´ï¼Œç¼–è¯‘å™¨åªæ˜¯å°†å¯¹è±¡ä¸­çš„å€¼æ‹·è´è¿‡æ¥ã€‚å¦‚æœå¯¹è±¡ä¸­ç®¡ç†èµ„æºï¼Œæœ€åå°±ä¼šå¯¼è‡´**å¤šä¸ªå¯¹è±¡å…±äº«åŒä¸€ä»½èµ„æº**ï¼Œå½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶å°±ä¼šå°†è¯¥èµ„æºé‡Šæ”¾æ‰ï¼Œè€Œæ­¤æ—¶å¦ä¸€äº›å¯¹è±¡ä¸çŸ¥é“è¯¥èµ„æºå·²ç»è¢«é‡Šæ”¾ï¼Œä»¥ä¸ºè¿˜æœ‰æ•ˆï¼Œæ‰€ä»¥å½“ç»§ç»­å¯¹èµ„æºè¿›é¡¹æ“ä½œæ—¶ï¼Œå°±ä¼šå‘ç”Ÿå‘ç”Ÿäº†è®¿é—®è¿è§„ã€‚

**æ·±æ‹·è´**ï¼šå¦‚æœä¸€ä¸ªç±»ä¸­æ¶‰åŠåˆ°èµ„æºçš„ç®¡ç†ï¼Œå…¶æ‹·è´æ„é€ å‡½æ•°ã€èµ‹å€¼è¿ç®—ç¬¦é‡è½½ä»¥åŠææ„å‡½æ•°å¿…é¡»è¦æ˜¾å¼ç»™å‡ºã€‚ä¸€èˆ¬æƒ…å†µéƒ½æ˜¯æŒ‰ç…§æ·±æ‹·è´æ–¹å¼æä¾›ã€‚

Stringç±»æ²¡æœ‰æ˜¾å¼å®šä¹‰å…¶æ‹·è´æ„é€ å‡½æ•°ä¸èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨ä¼šåˆæˆé»˜è®¤çš„ï¼Œå½“ç”¨s1æ„é€ s2æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè°ƒç”¨é»˜è®¤çš„æ‹·è´æ„é€ ã€‚**æœ€ç»ˆå¯¼è‡´çš„é—®é¢˜æ˜¯ï¼Œs1ã€s2å…±ç”¨åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œåœ¨é‡Šæ”¾æ—¶åŒä¸€å—ç©ºé—´è¢«é‡Šæ”¾å¤šæ¬¡è€Œå¼•èµ·ç¨‹åºå´©æºƒ**ï¼Œæ•…stringç±»å¿…é¡»æ˜¾å¼å®šä¹‰æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦é‡è½½ã€‚

å¯¹äºè§£å†³æµ…æ‹·è´é—®é¢˜çš„æ–¹å¼ä¸æ­¢æœ‰æ·±æ‹·è´è¿˜æœ‰**å†™æ—¶æ‹·è´**ï¼Œæµ…æ‹·è´çš„ä¸¤ä¸ªä¸»è¦é—®é¢˜æ˜¯**åŒä¸€ç©ºé—´ææ„ä¸¤æ¬¡**å’Œ**ä¸€ä¸ªå¯¹è±¡çš„ä¿®æ”¹ä¼šå½±å“å¦ä¸€ä¸ªå¯¹è±¡**ã€‚
**å†™æ—¶æ‹·è´**å°±æ˜¯åœ¨æµ…æ‹·è´çš„åŸºç¡€ä¸Šå¢åŠ äº†**å¼•ç”¨è®¡æ•°**ã€‚åœ¨æ„é€ æ—¶ï¼Œå°†èµ„æºçš„è®¡æ•°ç»™æˆ1ï¼Œæ¯å¢åŠ ä¸€ä¸ªå¯¹è±¡ä½¿ç”¨è¯¥èµ„æºï¼Œå°±ç»™è®¡æ•°å¢åŠ 1ï¼Œå½“æŸä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œå…ˆç»™è¯¥è®¡æ•°å‡1ï¼Œç„¶åå†æ£€æŸ¥æ˜¯å¦éœ€è¦é‡Šæ”¾èµ„æºï¼Œå¦‚æœè®¡æ•°ä¸º1ï¼Œè¯´æ˜è¯¥ å¯¹è±¡æ—¶èµ„æºçš„æœ€åä¸€ä¸ªä½¿ç”¨è€…ï¼Œå°†è¯¥èµ„æºé‡Šæ”¾ï¼›å¦åˆ™å°±ä¸èƒ½é‡Šæ”¾ï¼Œå› ä¸ºè¿˜æœ‰å…¶ä»–å¯¹è±¡åœ¨ä½¿ç”¨è¯¥èµ„æºã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡è¦å¯¹èµ„æºè¿›è¡Œä¿®æ”¹ï¼Œè‹¥è®¡æ•°ä¸æ˜¯1ï¼Œåˆ™è¿›è¡Œæ·±æ‹·è´å†ä¿®æ”¹ï¼Œè‹¥è®¡æ•°æ˜¯1ï¼Œåˆ™ç›´æ¥ä¿®æ”¹ã€‚g++ç¼–è¯‘å™¨é‡‡ç”¨çš„å°±æ˜¯å†™æ—¶æ‹·è´ã€‚

`string.h`

```c++
#pragma once
#include<string.h>
#include<assert.h>
#include<iostream>
using std::cout;
using std::cin;
using std::endl;
using std::ostream;
using std::istream;

namespace mystring {
	class string {
	public:
		// é»˜è®¤æˆå‘˜å‡½æ•°
		// string(const char* str = '\0') é”™è¯¯ï¼Œç±»å‹ä¸åŒ¹é…ï¼Œå­—ç¬¦ä¸èƒ½èµ‹å€¼ç»™æŒ‡é’ˆ
		// string(const char* str = "\0") é”™è¯¯ï¼Œ"\0"å­—ç¬¦ä¸²æ˜¯\0\0ï¼Œä¸æ˜¯ä¸€ä¸ª\0
		// string(const char* str = nullptr) é”™è¯¯ï¼Œnullptråœ¨strlené‡Œä¼šæŠ¥é”™
		string(const char* str = "");			// æ„é€ å‡½æ•°
		string(const string& s);				// æ‹·è´å‡½æ•°ï¼ˆä¼ ç»Ÿå†™æ³•ï¼‰
		string(const string& s);				// æ‹·è´å‡½æ•°ï¼ˆç°ä»£å†™æ³•ï¼‰
		~string();								// ææ„å‡½æ•°
		string& operator=(const string& s);		// èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼ˆä¼ ç»Ÿå†™æ³•ï¼‰
		string& operator=(string tmp);		// èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼ˆç°ä»£å†™æ³•ï¼‰

		// è¿­ä»£å™¨
		typedef char* iterator;
		typedef const char* const_iterator;
		iterator begin();
		iterator end();
		const_iterator begin()const;
		const_iterator end()const;

		// å®¹é‡æ“ä½œå‡½æ•°
		size_t size()const;						// å­—ç¬¦ä¸²é•¿åº¦			
		void reserve(size_t n);					// æ‰©å®¹
		void resize(size_t n, char c = '\0');	// æ‰©å®¹å¹¶åˆå§‹åŒ–ç©ºé—´
		void clear();							// æ¸…ç©º

		// ä¿®æ”¹å­—ç¬¦ä¸²å‡½æ•°
		void push_back(char c);					// å°¾æ’å­—ç¬¦
		void append(const char* str);			// å°¾æ’å­—ç¬¦ä¸²
		string& operator+=(char ch);			// +=è¿ç®—ç¬¦é‡è½½
		string& operator+=(const char* str);	// +=è¿ç®—ç¬¦é‡è½½
		void insert(size_t pos, size_t n, char c);// æ’å…¥å¤šä¸ªå­—ç¬¦
		void insert(size_t pos, const char* str); // æ’å…¥å­—ç¬¦ä¸²
		void erase(size_t pos, size_t len = npos);// æ¸…é™¤éƒ¨åˆ†ç©ºé—´
		void swap(string& s);					// äº¤æ¢å­—ç¬¦ä¸²

		// è®¿é—®å­—ç¬¦ä¸²å‡½æ•°
		const char* c_str()const;				// è¾“å‡ºCè¯­è¨€å­—ç¬¦ä¸²
		char& operator[](size_t pos);			// []æ“ä½œç¬¦é‡è½½
		const char& operator[](size_t pos)const;// []æ“ä½œç¬¦é‡è½½
		size_t find(char ch, size_t pos = 0);	// æ‰¾åˆ°å­—ç¬¦
		size_t find(const char* str, size_t pos = 0);// æ‰¾åˆ°å­—ç¬¦ä¸²
		string substr(size_t pos = 0, size_t len = npos);// æˆªå–å­ä¸²

		// å…³ç³»æ“ä½œç¬¦é‡è½½
		bool operator<(const string& s) const;
		bool operator==(const string& s) const;
		bool operator<=(const string& s) const;
		bool operator>(const string& s) const;
		bool operator>=(const string& s) const;
		bool operator!=(const string& s) const;

		// npos
		static const size_t npos;
	private:
		size_t _size;
		size_t _capacity;
		char* _str;
	};
	// æµæ’å…¥å’Œæµæå–
	ostream& operator<<(ostream& out, const string& s);
	istream& operator>>(istream& in, string& s);
}
```

`string.cpp`

```c++
#include"string.h"
// é»˜è®¤æˆå‘˜å‡½æ•°
mystring::string::string(const char* str) {
	_size = strlen(str);
	_capacity = _size;
	_str = new char[_capacity + 1];
	memcpy(_str, str, _size + 1);
}
mystring::string::string(const string& s) {
	_size = s._size;
	_capacity = s._capacity;
	_str = new char[_capacity + 1];
	memcpy(_str, s._str, _size + 1);
}
// è¿™é‡Œ_strä¸€å®šè¦åˆå§‹åŒ–ä¸ºnullptrï¼Œå› ä¸ºä¸åˆå§‹åŒ–å†…ç½®ç±»å‹ï¼Œå†…ç½®ç±»å‹ä¼šèµ‹éšæœºå€¼ï¼Œæœ‰äº›ç¼–è¯‘å™¨ä¼šç½®ç©ºæ˜¯ç¼–è¯‘å™¨çš„è‡ªå®šä¹‰è¡Œä¸ºï¼Œ
// å¦‚æœæ˜¯_stræ˜¯éšæœºå€¼ï¼Œäº¤æ¢ç»™tempåï¼Œtempå‡ºä½œç”¨åŸŸè°ƒç”¨ææ„å‡½æ•°ï¼Œä¼šé‡Šæ”¾éšæœºç©ºé—´ï¼Œæ•…æŠ¥é”™ã€‚
mystring::string::string(const string& s)
	:_str(nullptr)
	, _size(0)
	, _capacity(0)
{
	string tmp(s._str);
	swap(tmp);
}
mystring::string::~string() {
	if (_str) {
		delete[] _str;
		_str = nullptr;
		_size = _capacity = 0;
	}
}
mystring::string& mystring::string::operator=(const string& s) {
	if (this != &s) {
		_size = s._size;
		_capacity = s._capacity;
		char* temp = new char[_capacity + 1];
		memcpy(temp, s._str, _size + 1);
		delete[] _str;
		_str = temp;
	}
	return *this;
}
mystring::string& mystring::string::operator=(mystring::string tmp)
{
	swap(tmp);
	return *this;
}

// è¿­ä»£å™¨
mystring::string::iterator mystring::string::begin() {
	return _str;
}
mystring::string::iterator mystring::string::end() {
	return _str + _size;
}
mystring::string::const_iterator mystring::string::begin()const {
	return _str;
}
mystring::string::const_iterator mystring::string::end()const {
	return _str + _size;
}

// å®¹é‡æ“ä½œå‡½æ•°
size_t mystring::string::size()const {
	return _size;
}
void mystring::string::reserve(size_t n) {
	if (n > _capacity) {
		char* temp = new char[n + 1];
		memcpy(temp, _str, _size + 1);
		delete[] _str;
		_str = temp;
		_capacity = n;
	}
}
void mystring::string::resize(size_t n, char c) {
	if (n <= _size) {
		_size = n;
		_str[_size] = '\0';
	}
	else {
		reserve(n);
		for (size_t i = _size; i < n; i++)
			_str[i] = c;
		_size = n;
		_str[_size] = '\0';
	}
}
void mystring::string::clear() {
	_str[0] = '\0';
	_size = 0;
}

// ä¿®æ”¹å­—ç¬¦ä¸²å‡½æ•°
void mystring::string::push_back(char c) {
	if (_size == _capacity) {
		reserve(_capacity == 0 ? 4 : 2 * _capacity);
	}
	_str[_size] = c;
	++_size;
	_str[_size] = '\0';
}
void mystring::string::append(const char* str) {
	size_t len = strlen(str);
	if (_size + len > _capacity) {
		reserve(_size + len);
	}
	memcpy(_str + _size, str, len + 1);
	_size += len;
}
mystring::string& mystring::string::operator+=(char ch) {
	push_back(ch);
	return *this;
}
mystring::string& mystring::string::operator+=(const char* str) {
	append(str);
	return *this;
}
void mystring::string::insert(size_t pos, size_t n, char c) {
	assert(pos <= _size);
	if (_size + n > _capacity) {
		reserve(_size + n);
	}
	size_t end = _size;
	while (end != npos && end >= pos) {
		_str[end + n] = _str[end];
		end--;
	}
	for (size_t i = pos; i < pos + n; i++)
		_str[i] = c;
	_size += n;
}
void mystring::string::insert(size_t pos, const char* str) {
	assert(pos <= _size);
	size_t len = strlen(str);
	if (_size + len > _capacity) {
		reserve(_size + len);
	}
	size_t end = _size;
	while (end != npos && end >= pos) {
		_str[end + len] = _str[end];
		end--;
	}
	for (size_t i = pos; i < pos + len; i++)
		_str[i] = str[i - pos];
	_size += len;
}
void mystring::string::erase(size_t pos, size_t len) {
	assert(pos < _size);
	if (len == npos || pos + len >= _size) {
		_size = pos;
		_str[_size] = '\0';
	}
	else {
		for (size_t i = pos; i < len + pos; i++) {
			_str[i] = _str[i + len];
		}
		_size -= len;
		_str[_size] = '\0';
	}
}
void mystring::string::swap(mystring::string& s)
{
	std::swap(_str, s._str);
	std::swap(_size, s._size);
	std::swap(_capacity, s._capacity);
}

// è®¿é—®å­—ç¬¦ä¸²å‡½æ•°
const char* mystring::string::c_str()const {
	return _str;
}
char& mystring::string::operator[](size_t pos) {
	assert(pos < _size);
	return _str[pos];
}
const char& mystring::string::operator[](size_t pos)const {
	assert(pos < _size);
	return _str[pos];
}
size_t mystring::string::find(char ch, size_t pos) {
	assert(pos < _size);
	for (size_t i = pos; i < _size; i++)
		if (_str[i] == ch)
			return i;
	return npos;
}
size_t mystring::string::find(const char* str, size_t pos) {
	assert(pos < _size);
	const char* ptr = strstr(_str + pos, str);
	if (ptr == NULL)
		return npos;
	else
		return ptr - _str;
}
mystring::string mystring::string::substr(size_t pos, size_t len) {
	assert(pos < _size);
	size_t n = len;
	string temp;
	if (len == npos || len + pos > _size)
		n = _size - pos;
	temp.reserve(n);
	for (size_t i = pos; i < pos + n; i++)
		temp += _str[i];
	return temp;
}

// å…³ç³»æ“ä½œç¬¦é‡è½½
bool mystring::string::operator<(const string& s) const {
	int ret = memcmp(_str, s._str, _size < s._size ? _size : s._size);
	return ret == 0 ? _size < s._size : ret < 0;
}
bool mystring::string::operator==(const string& s) const {
	return _size == s._size && memcmp(_str, s._str, _size) == 0;
}
bool mystring::string::operator<=(const string& s) const {
	return *this < s || *this == s;
}
bool mystring::string::operator>(const string& s) const {
	return !(*this <= s);
}
bool mystring::string::operator>=(const string& s) const {
	return !(*this < s);
}
bool mystring::string::operator!=(const string& s) const {
	return !(*this == s);
}

// npos
const size_t mystring::string::npos = -1;
// ä¸èƒ½åœ¨å¤´æ–‡ä»¶å®šä¹‰ï¼Œå› ä¸ºå¦‚æœåœ¨å¤´æ–‡ä»¶å®šä¹‰ï¼Œstring.cppå’Œmain.cppéƒ½å±•å¼€string.hçš„è¯ä¼šé€ æˆé‡å®šä¹‰

// æµæ’å…¥å’Œæµæå–
ostream& mystring::operator<<(ostream& out, const mystring::string& s) {
	for (auto ch : s)
		cout << ch;
	return out;
}
istream& mystring::operator>>(istream& in, mystring::string& s) {
	s.clear();
	char ch = in.get();
	while (ch == ' ' || ch == '\n')
		ch = in.get();
	char buf[128];
	int i = 0;
	while (ch != ' ' && ch != '\n') {
		buf[i++] = ch;
		if (i == 127) {
			buf[i] = '\0';
			s += buf;
			i = 0;
		}
		ch = in.get();
	}
	if (i != 0) {
		buf[i] = '\0';
		s += buf;
	}
	return in;
}
```

# vector

## æ ‡å‡†åº“ä¸­çš„vectorç±»

### vectorç±»ä»‹ç»

![image-20240610141123555](F:/cs/note/images/image-20240610141123555.png)

1. vectoræ˜¯è¡¨ç¤ºå¯å˜å¤§å°æ•°ç»„çš„åºåˆ—å®¹å™¨ã€‚
2. å°±åƒæ•°ç»„ä¸€æ ·ï¼Œvectorä¹Ÿé‡‡ç”¨çš„è¿ç»­å­˜å‚¨ç©ºé—´æ¥å­˜å‚¨å…ƒç´ ã€‚ä¹Ÿå°±æ˜¯æ„å‘³ç€å¯ä»¥é‡‡ç”¨ä¸‹æ ‡å¯¹vectorçš„å…ƒç´  è¿›è¡Œè®¿é—®ï¼Œå’Œæ•°ç»„ä¸€æ ·é«˜æ•ˆã€‚ä½†æ˜¯åˆä¸åƒæ•°ç»„ï¼Œå®ƒçš„å¤§å°æ˜¯å¯ä»¥åŠ¨æ€æ”¹å˜çš„ï¼Œè€Œä¸”å®ƒçš„å¤§å°ä¼šè¢«å®¹å™¨è‡ªåŠ¨å¤„ç†ã€‚
3. æœ¬è´¨è®²ï¼Œvectorä½¿ç”¨åŠ¨æ€åˆ†é…æ•°ç»„æ¥å­˜å‚¨å®ƒçš„å…ƒç´ ã€‚å½“æ–°å…ƒç´ æ’å…¥æ—¶å€™ï¼Œè¿™ä¸ªæ•°ç»„éœ€è¦è¢«é‡æ–°åˆ†é…å¤§å°ä¸ºäº†å¢åŠ å­˜å‚¨ç©ºé—´ã€‚å…¶åšæ³•æ˜¯ï¼Œåˆ†é…ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œç„¶åå°†å…¨éƒ¨å…ƒç´ ç§»åˆ°è¿™ä¸ªæ•°ç»„ã€‚å°±æ—¶é—´è€Œè¨€ï¼Œè¿™æ˜¯ ä¸€ä¸ªç›¸å¯¹ä»£ä»·é«˜çš„ä»»åŠ¡ï¼Œå› ä¸ºæ¯å½“ä¸€ä¸ªæ–°çš„å…ƒç´ åŠ å…¥åˆ°å®¹å™¨çš„æ—¶å€™ï¼Œvectorå¹¶ä¸ä¼šæ¯æ¬¡éƒ½é‡æ–°åˆ†é…å¤§ å°ã€‚
4. vectoråˆ†é…ç©ºé—´ç­–ç•¥ï¼švectorä¼šåˆ†é…ä¸€äº›é¢å¤–çš„ç©ºé—´ä»¥é€‚åº”å¯èƒ½çš„å¢é•¿ï¼Œå› ä¸ºå­˜å‚¨ç©ºé—´æ¯”å®é™…éœ€è¦çš„å­˜å‚¨ç©ºé—´æ›´å¤§ã€‚ä¸åŒçš„åº“é‡‡ç”¨ä¸åŒçš„ç­–ç•¥æƒè¡¡ç©ºé—´çš„ä½¿ç”¨å’Œé‡æ–°åˆ†é…ã€‚ä½†æ˜¯æ— è®ºå¦‚ä½•ï¼Œé‡æ–°åˆ†é…éƒ½åº”è¯¥æ˜¯å¯¹æ•°å¢é•¿çš„é—´éš”å¤§å°ï¼Œä»¥è‡³äºåœ¨æœ«å°¾æ’å…¥ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™æ˜¯åœ¨å¸¸æ•°æ—¶é—´çš„å¤æ‚åº¦å®Œæˆçš„ã€‚
5. å› æ­¤ï¼Œvectorå ç”¨äº†æ›´å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œä¸ºäº†è·å¾—ç®¡ç†å­˜å‚¨ç©ºé—´çš„èƒ½åŠ›ï¼Œå¹¶ä¸”ä»¥ä¸€ç§æœ‰æ•ˆçš„æ–¹å¼åŠ¨æ€å¢é•¿ã€‚
6. ä¸å…¶å®ƒåŠ¨æ€åºåˆ—å®¹å™¨ç›¸æ¯”ï¼ˆdeque, list and forward_listï¼‰ï¼Œvectoråœ¨è®¿é—®å…ƒç´ çš„æ—¶å€™æ›´åŠ é«˜æ•ˆï¼Œåœ¨æœ«å°¾æ·»åŠ å’Œåˆ é™¤å…ƒç´ ç›¸å¯¹é«˜æ•ˆã€‚å¯¹äºå…¶å®ƒä¸åœ¨æœ«å°¾çš„åˆ é™¤å’Œæ’å…¥æ“ä½œï¼Œæ•ˆç‡æ›´ä½ã€‚æ¯”èµ·listå’Œforward_list ç»Ÿä¸€çš„è¿­ä»£å™¨å’Œå¼•ç”¨æ›´å¥½ã€‚

### vectorç±»çš„å¸¸è§æ¥å£ä½¿ç”¨

1. æ„é€ å‡½æ•°
   ![image-20240610142230246](F:/cs/note/images/image-20240610142230246.png)

   ```c++
   void test_vector1() {
   	vector<int> v1;
   	vector<int> v2(10, 1);
   	vector<int> v3(v2);
   	//è¿­ä»£å™¨æ„é€ çš„å¤šç§ç”¨æ³•
   	vector<int> v4(v2.begin(), v2.end());
   	string s("abcdef");
   	vector<int> v5(s.begin(), s.end());
   	int arr[10] = { 1,2,3,4,5,6,7,8,9,0 };
   	vector<int> v6(arr, arr + sizeof(arr) / sizeof(arr[0]));
   }
   ```

2. è®¿é—®åŠéå†æ“ä½œ

   | å‡½æ•°åç§°       | åŠŸèƒ½è¯´æ˜                                   |
   | -------------- | ------------------------------------------ |
   | **operator[]** | è¿”å›posä½ç½®çš„å­—ç¬¦ï¼Œconst stringç±»å¯¹è±¡è°ƒç”¨  |
   | at()           | è¿”å›posä½ç½®çš„å­—ç¬¦ï¼Œconst stringç±»å¯¹è±¡è°ƒç”¨  |
   | **è¿­ä»£å™¨**     | **begin() + end() æˆ–è€… rbegin() + rend()** |
   | èŒƒå›´for        | C++11æ”¯æŒæ›´ç®€æ´çš„èŒƒå›´forçš„æ–°éå†æ–¹å¼       |

3. å®¹é‡æ“ä½œ

   | å‡½æ•°åç§°    | æ¥å£è¯´æ˜               |
   | ----------- | ---------------------- |
   | size        | è·å–æ•°æ®ä¸ªæ•°           |
   | capacity    | è·å–å®¹é‡å¤§å°           |
   | **resize**  | è°ƒæ•´å®¹å™¨çš„æœ‰æ•ˆå…ƒç´ å¤§å° |
   | **reserve** | è°ƒæ•´å®¹å™¨çš„å®¹é‡å¤§å°     |
   | empty       | åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º       |

   ```c++
   void test_vector2() {
   	// reserveæ‰©å®¹æ˜“é”™ç‚¹ï¼šreserveåªæ‰©å®¹ä¸ä¿®æ”¹å†…å®¹ï¼Œæ‰©å®¹å_sizeä¾ç„¶ä¸º0ï¼Œæ­¤æ—¶é€šè¿‡[]è®¿é—®ä¼šæ–­è¨€
   	vector<int> v1;
   	v1.reserve(10);
   	for (size_t i = 0; i < 10; i++) {
   		v1[i] = i + 1;
   	}
   
   	//æ­£ç¡®çš„å†™æ³•
   	vector<int> v2;
   	v2.resize(10);
   	for (size_t i = 0; i < 10; i++) {
   		v2[i] = i + 1;
   	}
   	vector<int> v3;
   	v3.reserve(10);
   	for (size_t i = 0; i < 10; i++) {
   		v3.push_back(i + 1);
   	}
   }
   ```

4. ä¿®æ”¹æ“ä½œ

   | å‡½æ•°åç§°      | æ¥å£è¯´æ˜                                             |
   | ------------- | ---------------------------------------------------- |
   | **push_back** | å°¾æ’                                                 |
   | **pop_back**  | å°¾åˆ                                                  |
   | find          | æŸ¥æ‰¾ï¼ˆæ³¨æ„è¿™ä¸ªæ˜¯ç®—æ³•æ¨¡å—å®ç°ï¼Œä¸æ˜¯vectorçš„æˆå‘˜æ¥å£ï¼‰ |
   | insert        | åœ¨posä¹‹å‰æ’å…¥val                                     |
   | erase         | åˆ é™¤positionä½ç½®çš„æ•°æ®                               |
   | swap          | äº¤æ¢ä¸¤ä¸ªvectorçš„æ•°æ®ç©ºé—´                             |

   ```c++
   void test_vector3() {
   	vector<int> v;
   	v.reserve(10);
   	for (size_t i = 0; i < 10; i++) {
   		v.push_back(i + 1);
   	}
   	vector<int>::iterator pos = find(v.begin(), v.end(), 5);
   	v.insert(pos, -1);
   	for (auto p : v)
   		cout << p << " ";
   	cout << endl;
   	pos = find(v.begin(), v.end(), 8);
   	v.erase(pos);
   	for (auto p : v)
   		cout << p << " ";
   	cout << endl;
   }
   ```

5. **è¿­ä»£å™¨å¤±æ•ˆé—®é¢˜ï¼ˆé‡ç‚¹ï¼‰**
   è¿­ä»£å™¨çš„ä¸»è¦ä½œç”¨å°±æ˜¯è®©ç®—æ³•èƒ½å¤Ÿä¸ç”¨å…³å¿ƒåº•å±‚æ•°æ®ç»“æ„ï¼Œå…¶åº•å±‚å®é™…å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæˆ–è€…æ˜¯å¯¹æŒ‡é’ˆè¿›è¡Œäº† å°è£…ï¼Œæ¯”å¦‚ï¼š**vectorçš„è¿­ä»£å™¨å°±æ˜¯åŸç”Ÿæ€æŒ‡é’ˆT*** ã€‚å› æ­¤**è¿­ä»£å™¨å¤±æ•ˆï¼Œå®é™…å°±æ˜¯è¿­ä»£å™¨åº•å±‚å¯¹åº”æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç©ºé—´è¢«é”€æ¯äº†ï¼Œè€Œä½¿ç”¨ä¸€å—å·²ç»è¢«é‡Šæ”¾çš„ç©ºé—´**ï¼Œé€ æˆçš„åæœæ˜¯ç¨‹åºå´©æºƒ(å³å¦‚æœç»§ç»­ä½¿ç”¨å·²ç»å¤±æ•ˆçš„è¿­ä»£å™¨ï¼Œ ç¨‹åºå¯èƒ½ä¼šå´©æºƒ)ã€‚
   å¯¹äºvectorå¯èƒ½ä¼šå¯¼è‡´å…¶è¿­ä»£å™¨å¤±æ•ˆçš„æ“ä½œæœ‰ï¼š

   1. **ä¼šå¼•èµ·å…¶åº•å±‚ç©ºé—´æ”¹å˜çš„æ“ä½œï¼Œéƒ½æœ‰å¯èƒ½æ˜¯è¿­ä»£å™¨å¤±æ•ˆ**ï¼Œæ¯”å¦‚ï¼šresizeã€reserveã€insertã€assignã€ push_backç­‰ã€‚

      ```c++
      void test1()
      {
      	// å°†æœ‰æ•ˆå…ƒç´ ä¸ªæ•°å¢åŠ åˆ°100ä¸ªï¼Œå¤šå‡ºçš„ä½ç½®ä½¿ç”¨8å¡«å……ï¼Œæ“ä½œæœŸé—´åº•å±‚ä¼šæ‰©å®¹
      	vector<int> v1{ 1,2,3,4,5,6 };
      	auto it1 = v1.begin();
      	v1.resize(100);
      
      	// reserveçš„ä½œç”¨å°±æ˜¯æ”¹å˜æ‰©å®¹å¤§å°ä½†ä¸æ”¹å˜æœ‰æ•ˆå…ƒç´ ä¸ªæ•°ï¼Œæ“ä½œæœŸé—´å¯èƒ½ä¼šå¼•èµ·åº•å±‚å®¹é‡æ”¹å˜
      	vector<int> v2{ 1,2,3,4,5,6 };
      	auto it2 = v2.begin();
      	v2.reserve(100);
      
      	// æ’å…¥å…ƒç´ æœŸé—´ï¼Œå¯èƒ½ä¼šå¼•èµ·æ‰©å®¹ï¼Œè€Œå¯¼è‡´åŸç©ºé—´è¢«é‡Šæ”¾
      	vector<int> v3{ 1,2,3,4 };
      	auto it3 = v3.begin();
      	v3.insert(v3.begin(), 0);
      	v3.push_back(8);
      
      	// ç»™vectoré‡æ–°èµ‹å€¼ï¼Œå¯èƒ½ä¼šå¼•èµ·åº•å±‚å®¹é‡æ”¹å˜
      	vector<int> v4{ 1,2,3,4 };
      	auto it4 = v4.begin();
      	v4.assign(100, 8);
      }
      ```

      å‡ºé”™åŸå› ï¼š**ä»¥ä¸Šæ“ä½œï¼Œéƒ½æœ‰å¯èƒ½ä¼šå¯¼è‡´vectoræ‰©å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´vectoråº•å±‚åŸç†æ—§ç©ºé—´è¢«é‡Šæ”¾æ‰ï¼Œè€Œåœ¨æ‰“å°æ—¶ï¼Œitè¿˜ä½¿ç”¨çš„æ˜¯é‡Šæ”¾ä¹‹é—´çš„æ—§ç©ºé—´ï¼Œåœ¨å¯¹itè¿­ä»£å™¨æ“ä½œæ—¶ï¼Œå®é™…æ“ä½œçš„æ˜¯ä¸€å—å·²ç»è¢«é‡Šæ”¾çš„ç©ºé—´ï¼Œè€Œå¼•èµ·ä»£ç è¿è¡Œæ—¶å´©æºƒã€‚**
      è§£å†³æ–¹å¼ï¼šåœ¨ä»¥ä¸Šæ“ä½œå®Œæˆä¹‹åï¼Œå¦‚æœæƒ³è¦ç»§ç»­é€šè¿‡è¿­ä»£å™¨æ“ä½œvectorä¸­çš„å…ƒç´ ï¼Œåªéœ€ç»™ité‡æ–°èµ‹å€¼å³å¯ã€‚

   2. **æŒ‡å®šä½ç½®å…ƒç´ çš„åˆ é™¤æ“ä½œ**ï¼Œerase

      ```c++
      void test2()
      {
      	vector<int> v{ 1,2,3,4 };
      	// ä½¿ç”¨findæŸ¥æ‰¾3æ‰€åœ¨ä½ç½®çš„iterator
      	vector<int>::iterator pos = find(v.begin(), v.end(), 3);
      	// åˆ é™¤posä½ç½®çš„æ•°æ®ï¼Œå¯¼è‡´posè¿­ä»£å™¨å¤±æ•ˆã€‚
      	v.erase(pos);
      	cout << *pos << endl; // æ­¤å¤„ä¼šå¯¼è‡´éæ³•è®¿é—®
      }
      ```

      eraseåˆ é™¤posä½ç½®å…ƒç´ åï¼Œposä½ç½®ä¹‹åçš„å…ƒç´ ä¼šå¾€å‰æ¬ç§»ï¼Œæ²¡æœ‰å¯¼è‡´åº•å±‚ç©ºé—´çš„æ”¹å˜ï¼Œç†è®ºä¸Šè®²è¿­ä»£ å™¨ä¸åº”è¯¥ä¼šå¤±æ•ˆï¼Œä½†æ˜¯ï¼š**å¦‚æœposåˆšå¥½æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œåˆ å®Œä¹‹åposåˆšå¥½æ˜¯endçš„ä½ç½®ï¼Œè€Œendä½ç½®æ˜¯æ²¡æœ‰å…ƒç´ çš„ï¼Œé‚£ä¹ˆposå°±å¤±æ•ˆäº†ã€‚**å› æ­¤åˆ é™¤vectorä¸­ä»»æ„ä½ç½®ä¸Šå…ƒç´ æ—¶ï¼Œvså°±è®¤ä¸ºè¯¥ä½ç½®è¿­ä»£å™¨å¤±æ•ˆäº†ã€‚

      ```c++
      void test_erase1()
      {
      	vector<int> v{ 1, 2, 2, 3, 4 };
      	auto it = v.begin();
      	while (it != v.end())
      	{
      		if (*it % 2 == 0)
      			v.erase(it);
      		++it;
      	}
      }
      //æ— æ³•åˆ é™¤ç›¸è¿çš„å¶æ•°
      
      void test_erase2()
      {
      	vector<int> v{ 1, 2, 2, 3, 4 };
      	auto it = v.begin();
      	while (it != v.end())
      	{
      		if (*it % 2 == 0)
      			v.erase(it);
      		else
      			++it;
      	}
      }
      // ä»£ç åœ¨g++å¹³å°èƒ½è·‘ï¼Œåœ¨VSå¹³å°ä¸èƒ½è·‘ï¼Œåœ¨VSç¼–è¯‘å™¨ä¸‹ï¼Œeraseåè¿­ä»£å™¨å¤±æ•ˆä¸èƒ½å†è®¿é—®
      
      void test_erase3()
      {
      	vector<int> v{ 1, 2, 3, 4 };
      	auto it = v.begin();
      	while (it != v.end())
      	{
      		if (*it % 2 == 0)
      			it = v.erase(it);
      		else
      			++it;
      	}
      }
      // é‡æ–°ç»™è¿­ä»£å™¨èµ‹å€¼eraseè°ƒç”¨åçš„è¿”å›å€¼ï¼Œå¯é¿å…eraseè¿­ä»£å™¨å¤±æ•ˆé—®é¢˜
      ```

   3. æ³¨æ„ï¼šLinuxä¸‹ï¼Œg++ç¼–è¯‘å™¨å¯¹è¿­ä»£å™¨å¤±æ•ˆçš„æ£€æµ‹å¹¶ä¸æ˜¯éå¸¸ä¸¥æ ¼ï¼Œå¤„ç†ä¹Ÿæ²¡æœ‰vsä¸‹æç«¯ã€‚

      ```c++
      // 1. æ‰©å®¹ä¹‹åï¼Œè¿­ä»£å™¨å·²ç»å¤±æ•ˆäº†ï¼Œç¨‹åºè™½ç„¶å¯ä»¥è¿è¡Œï¼Œä½†æ˜¯è¿è¡Œç»“æœå·²ç»ä¸å¯¹äº†
      int main()
      {
           vector<int> v{1,2,3,4,5};
           for(size_t i = 0; i < v.size(); ++i)
           	cout << v[i] << " ";
           cout << endl;
           auto it = v.begin();
           cout << "æ‰©å®¹ä¹‹å‰ï¼Œvectorçš„å®¹é‡ä¸º: " << v.capacity() << endl;
           // é€šè¿‡reserveå°†åº•å±‚ç©ºé—´è®¾ç½®ä¸º100ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©vectorçš„è¿­ä»£å™¨å¤±æ•ˆ 
           v.reserve(100);
           cout << "æ‰©å®¹ä¹‹åï¼Œvectorçš„å®¹é‡ä¸º: " << v.capacity() << endl;
      
           // ç»è¿‡ä¸Šè¿°reserveä¹‹åï¼Œitè¿­ä»£å™¨è‚¯å®šä¼šå¤±æ•ˆï¼Œåœ¨vsä¸‹ç¨‹åºå°±ç›´æ¥å´©æºƒäº†ï¼Œä½†æ˜¯linuxä¸‹ä¸ä¼š
           // è™½ç„¶å¯èƒ½è¿è¡Œï¼Œä½†æ˜¯è¾“å‡ºçš„ç»“æœæ˜¯ä¸å¯¹çš„
           while(it != v.end())
           {
               cout << *it << " ";
               ++it;
           }
           cout << endl;
           return 0;
      }
      ç¨‹åºè¾“å‡ºï¼š
      1 2 3 4 5
      æ‰©å®¹ä¹‹å‰ï¼Œvectorçš„å®¹é‡ä¸º: 5
      æ‰©å®¹ä¹‹åï¼Œvectorçš„å®¹é‡ä¸º: 100
      0 2 3 4 5 409 1 2 3 4 5
      
      // 2. eraseåˆ é™¤ä»»æ„ä½ç½®ä»£ç åï¼Œlinuxä¸‹è¿­ä»£å™¨å¹¶æ²¡æœ‰å¤±æ•ˆ
      // å› ä¸ºç©ºé—´è¿˜æ˜¯åŸæ¥çš„ç©ºé—´ï¼Œååºå…ƒç´ å¾€å‰æ¬ç§»äº†ï¼Œitçš„ä½ç½®è¿˜æ˜¯æœ‰æ•ˆçš„
      #include <vector>
      #include <algorithm>
      int main()
      {
           vector<int> v{1,2,3,4,5};
           vector<int>::iterator it = find(v.begin(), v.end(), 3);
           v.erase(it);
          cout << *it << endl;
           while(it != v.end())
           {
           	cout << *it << " ";
               ++it;
           }
           cout << endl;
           return 0;
      }
      ç¨‹åºå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå¹¶æ‰“å°ï¼š
      4
      4 5
      
      // 3: eraseåˆ é™¤çš„è¿­ä»£å™¨å¦‚æœæ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œåˆ é™¤ä¹‹åitå·²ç»è¶…è¿‡end
      // æ­¤æ—¶è¿­ä»£å™¨æ˜¯æ— æ•ˆçš„ï¼Œ++itå¯¼è‡´ç¨‹åºå´©æºƒ
      int main()
      {
           vector<int> v{1,2,3,4,5};
           // vector<int> v{1,2,3,4,5,6};
           auto it = v.begin();
           while(it != v.end())
           {
               if(*it % 2 == 0)
               v.erase(it);
               ++it;
           }
           for(auto e : v)
           	cout << e << " ";
           cout << endl;
           return 0;
      }
      ========================================================
      // ä½¿ç”¨ç¬¬ä¸€ç»„æ•°æ®æ—¶ï¼Œç¨‹åºå¯ä»¥è¿è¡Œ
      [sly@VM-0-3-centos 20220114]$ g++ testVector.cpp -std=c++11
      [sly@VM-0-3-centos 20220114]$ ./a.out
      1 3 5
      =========================================================
      // ä½¿ç”¨ç¬¬äºŒç»„æ•°æ®æ—¶ï¼Œç¨‹åºæœ€ç»ˆä¼šå´©æºƒ
      [sly@VM-0-3-centos 20220114]$ vim testVector.cpp
      [sly@VM-0-3-centos 20220114]$ g++ testVector.cpp -std=c++11
      [sly@VM-0-3-centos 20220114]$ ./a.out
      Segmentation fault
      ```

      ä»ä¸Šè¿°ä¸‰ä¸ªä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°ï¼šSGI STLä¸­ï¼Œè¿­ä»£å™¨å¤±æ•ˆåï¼Œä»£ç å¹¶ä¸ä¸€å®šä¼šå´©æºƒï¼Œä½†æ˜¯è¿è¡Œç»“æœè‚¯å®šä¸å¯¹ï¼Œå¦‚æœitä¸åœ¨beginå’ŒendèŒƒå›´å†…ï¼Œè‚¯å®šä¼šå´©æºƒçš„ã€‚

   4. ä¸vectorç±»ä¼¼ï¼Œstringåœ¨æ’å…¥+æ‰©å®¹æ“ä½œ+eraseä¹‹åï¼Œè¿­ä»£å™¨ä¹Ÿä¼šå¤±æ•ˆ

      ```c++
      #include <string>
      void TestString()
      {
           string s("hello");
           auto it = s.begin();
           // æ”¾å¼€ä¹‹åä»£ç ä¼šå´©æºƒï¼Œå› ä¸ºresizeåˆ°20ä¼šstringä¼šè¿›è¡Œæ‰©å®¹
           // æ‰©å®¹ä¹‹åï¼ŒitæŒ‡å‘ä¹‹å‰æ—§ç©ºé—´å·²ç»è¢«é‡Šæ”¾äº†ï¼Œè¯¥è¿­ä»£å™¨å°±å¤±æ•ˆäº†
           // ååºæ‰“å°æ—¶ï¼Œå†è®¿é—®itæŒ‡å‘çš„ç©ºé—´ç¨‹åºå°±ä¼šå´©æºƒ
           s.resize(20, '!');
           while (it != s.end())
           {
               cout << *it;
               ++it;
           }
           cout << endl;
           it = s.begin();
           while (it != s.end())
           {
               it = s.erase(it);
               // æŒ‰ç…§ä¸‹é¢æ–¹å¼å†™ï¼Œè¿è¡Œæ—¶ç¨‹åºä¼šå´©æºƒï¼Œå› ä¸ºerase(it)ä¹‹å
               // itä½ç½®çš„è¿­ä»£å™¨å°±å¤±æ•ˆäº†
               // s.erase(it); 
               ++it;
           }
      }
      ```

### OJç»ƒä¹ 



## æ¨¡æ‹Ÿå®ç°vector

ç±»æ¨¡æ¿å£°æ˜ä¸å®šä¹‰ä¸èƒ½åˆ†ç¦»ï¼Œè¯¦è§æ¨¡æ¿è¿›é˜¶ã€‚

```c++
#pragma once
#include<vector>
#include<string>
#include<iostream>
#include<algorithm>
#include<assert.h>
using namespace std;
namespace myvector
{
	template<class T>
	class vector 
	{
	public:
		// é»˜è®¤æˆå‘˜å‡½æ•°
		vector() {}
		vector(size_t n, const T& val) {
			resize(n, val);
		}
		template<class InputIterator>
		vector(InputIterator first, InputIterator last) {
			while (first != last) {
				push_back(*first);
				++first;
			}
		}
		vector(const vector<T>& x) {
			vector<T> _start = new T[x.capacity()];
			for (size_t i = 0; i < x.size(); i++)
				_start[i] = x._start[i];
			_finish = _start + x.size();
			_endofstorage = _start + x.capacity();
		}
		vector<T>& operator= (vector<T> x) {
			swap(x);
			return *this;
		}
		~vector() {
			if (_start) {
				delete[] _start;
				_start = _finish = _endofstorage = nullptr;
			}
		}

		// è¿­ä»£å™¨
		typedef T* iterator;
		typedef const T* const_iterator;
		iterator begin() {
			return _start;
		}
		iterator end() {
			return _finish;
		}
		const_iterator begin() const {
			return _start;
		}
		const_iterator end() const {
			return _finish;
		}

		//å®¹é‡å’Œå¤§å°å‡½æ•°
		size_t size() const {
			return _finish - _start;
		}
		size_t capacity() const {
			return _endofstorage - _start;
		}
		void reserve(size_t n) {
			if (n > capacity()) {
				size_t sz = size();
				T* temp = new T[n];
				if (_start) {
					//memcpy(temp, _start, sz); //å¦‚æœè¿™é‡Œç”¨memcpyé‚£é‡åˆ°stringç±»å°±æ˜¯æµ…æ‹·è´
					for (size_t i = 0; i < sz; i++) {
						temp[i] = *(_start + i);
					}
					delete[] _start;
				}
				_start = temp;
				_finish = temp + sz;
				_endofstorage = _start + n;
			}
		}
		void resize(size_t n, const T& val) {
			if (n < size()) {
				_finish = _start + n;
			}
			else {
				reserve(n);
				while (_finish != _endofstorage) {
					*_finish = val;
					++_finish;
				}
			}
		}
		// å¯¹T()çš„è§£é‡Šï¼š
		// T å¦‚æœæ˜¯stringç±»ï¼Œå°±å¯èƒ½è°ƒç”¨stringç±»çš„é»˜è®¤æ„é€ 
		// T å¦‚æœæ˜¯å†…ç½®ç±»å‹ä¹Ÿæ˜¯æœ‰é»˜è®¤æ„é€ çš„ï¼ŒC++å¯¹å…¶è¿›è¡Œäº†å‡çº§

		//ä¿®æ”¹å‡½æ•°
		void push_back(const T& x) {
			if (_finish == _endofstorage) {
				size_t newcapacity = capacity() == 0 ? 4 : capacity() * 2;
				reserve(newcapacity);
			}
			*_finish = x;
			++_finish;
		}
		void pop_back() {
			if (_finish != _start)
				--_finish;
		}
		typename iterator insert(iterator pos, const T& x) {
			assert(pos >= _start && pos <= _finish);
			if (_finish == _endofstorage) {
				size_t len = pos - _start;// è§£å†³posè¿­ä»£å™¨å¤±æ•ˆé—®é¢˜
				size_t newcapacity = capacity() == 0 ? 4 : capacity() * 2;
				reserve(newcapacity);
				pos = _start + len;
			}
			iterator temp = _finish;
			while (temp != pos) {
				*(temp + 1) = *temp;
				temp--;
			}
			*pos = x;
			++_finish;
			return pos;
		}
		iterator erase(iterator pos) {
			assert(pos >= _start && pos < _finish);
			iterator temp = pos + 1;
			while (temp != _finish) {
				*(temp - 1) = *temp;
				temp++;
			}
			--_finish;
			return pos;
		}
		void swap(vector<T>& v) {
			std::swap(_start, v._start);
			std::swap(_finish, v._finish);
			std::swap(_endofstorage, v._endofstorage);
		}

		//è®¿é—®å‡½æ•°
		T& operator[](size_t pos) {
			assert(pos < size());
			return _start[pos];
		}
		const T& operator[](size_t pos)const {
			assert(pos < size());
			return _start[pos];
		}
	private:
		iterator _start = nullptr;
		iterator _finish = nullptr;
		iterator _endofstorage = nullptr;
	};
}
```

å‡è®¾æ¨¡æ‹Ÿå®ç°çš„vectorä¸­çš„reserveæ¥å£ä¸­ï¼Œä½¿ç”¨memcpyè¿›è¡Œçš„æ‹·è´ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ

1. memcpyæ˜¯å†…å­˜çš„äºŒè¿›åˆ¶æ ¼å¼æ‹·è´ï¼Œå°†ä¸€æ®µå†…å­˜ç©ºé—´ä¸­å†…å®¹åŸå°ä¸åŠ¨çš„æ‹·è´åˆ°å¦å¤–ä¸€æ®µå†…å­˜ç©ºé—´ä¸­
2. å¦‚æœæ‹·è´çš„æ˜¯å†…ç½®ç±»å‹çš„å…ƒç´ ï¼Œmemcpyæ—¢é«˜æ•ˆåˆä¸ä¼šå‡ºé”™ï¼Œä½†**å¦‚æœæ‹·è´çš„æ˜¯è‡ªå®šä¹‰ç±»å‹å…ƒç´ ï¼Œå¹¶ä¸”è‡ªå®šä¹‰ç±»å‹å…ƒç´ ä¸­æ¶‰åŠåˆ°èµ„æºç®¡ç†æ—¶ï¼Œå°±ä¼šå‡ºé”™ï¼Œå› ä¸ºmemcpyçš„æ‹·è´å®é™…æ˜¯æµ…æ‹·è´**ã€‚

<img src="F:/cs/note/images/image-20240611210615664.png" alt="image-20240611210615664" style="zoom: 40%;" />

<img src="F:/cs/note/images/image-20240611210643555.png" alt="image-20240611210643555" style="zoom: 33%;" />

<img src="F:/cs/note/images/image-20240611210708512.png" alt="image-20240611210708512" style="zoom: 33%;" />

# list

